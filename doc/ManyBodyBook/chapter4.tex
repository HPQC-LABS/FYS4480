\chapter{Second quantization}

\section{Introduction}

The aim of this chapter is to give you the basic equations and
theorems for handling many-particle states and computing expectation
values of operator in an efficient way, using what is loosely dubbed
as second quantization.  In second quantization, the spatial degrees
of freedom are included in various integrals and we deal only with
many-particle states represented by which quantum states are filled
with one or more particles. This leads to the definition of what is
called Fock space.  Fock space allows us to encode systems of $A$
nucleons by considering only the occupancy of various single-particle
states. In quantum mechanics, all particles are indistinguishable, and
in the same Fock space all particles are identical. To describe
quantum mechanical states of many particles, we take the tensor
product of as many different Fock spaces as there are species of
particles under consideration.  It is one of the most powerful
features of the Fock space formalism that states are intrinsically
properly symmetrized.

A useful and convenient basis for this space is the occupancy number basis. 
If $|\Phi_{\lambda}\rangle$ forms a  basis of our Hamiltonian, 
then we can construct a representation of a Slater determinant (we limit ourselves to fermions) as
\be
|\Phi_{\lambda}\rangle=\ket{\alpha_1\alpha_2 \hdots \alpha_{A}},\ee
where the various quantum numbers of a given single-particle state are $\alpha_1\alpha_2 \hdots \alpha_{A}$.
Note well that this is no longer a Slater determinant in the form we encountered in the previous chapter, although it is often, and wrongly, called a Slater determinant. Rather, with the introduction
of creation and annihilation operators and their pertinent anti-commutation relations, the anti-symmetry of the total state function will be
 taken
care of. 
Such a state is called a Fock state. 
If there is no particle in the single-particle state $\alpha_i$, the occupancy is zero, else since we  deal with fermions it is one. 
Since $|\Phi_{\lambda}\rangle$ is understood as the steady state of 
the free field with a definite number of particles, a Fock state describes an assembly of 
non-interacting particles in definite numbers. The most general pure state is the linear superposition of Fock states.

Two operators of paramount importance are the creation and annihilation operators, which upon 
acting on a Fock state add or remove a particle in the ascribed quantum state. 
They are denoted $a^{\dagger}_{\alpha}$ and $a_{\alpha}$, respectively, with $\psi_{\alpha}$, 
referring to the quantum state $|\psi_{lapha}\rangle$ in which the particle is removed or added. 
It is often convenient to work with states of the basis of the Hamiltonian so that these operators 
remove and add exactly one particle in the given state. These operators also serve as a basis for 
more general operators acting on the Fock space, for instance the number operator giving the number of particles 
in a specific state or the kinetic energy of  a many-body state. These operators are discussed in the next subsections.
We will often  refer to the basis used to define these operators and their pertinent rules to compute 
expectation values as the occupation number basis. We may also use second quantization when we get bored
of writing the longer phrase occupation number basis. 


Working in Fock space allows us to introduce a compact notation and physically intuitive 
approach to many-body physics.
With particular representations such as the particle-hole formalism discussed below, one can translate the Schr\"odinger many-body equation 
into selected excitations such as different types of particle-hole excitations.  
This allows again for the resummation to infinite order
of important correlations. It means in turn that we can single out specific correlations we believe are crucial to a specific many-body 
system.  
For the electron gas, due to the long-range behavior
of the Coulomb force, one needs to sum up to infinite order particle-hole correlations. Short-range correlations, normally small
in electronic systems, can be treated perturbatively or by selecting specific two-particle-two-hole correlations which can be summed
to infinite order. 
In nuclear physics it is important to renormalize the strongly repulsive short-range part of the nucleon-nucleon interaction.  
The latter can be done by summing to infinite order two-particle excitations.  However, nuclear physics is a particularly nasty many-body case,
not only due to the lack of knowledge of an analytic expression for the  force, but also due to the fact that short-range correlations
and long-range correlations span the same order of dimensionality in inter-particle distances. Stated differently, the range of the short-range 
part of the interaction (up to $0.5$ femtometer) is not that different from the range of long-range correlations (some few femtometers).  Finally,  this chapter picks up again Hartree-Fock theory, now rephrased in the language of
second quantization. Here we present also formal criteria for the stability of the Hartree-Fock equations, together with our first diagrammatic representation.



There is an additional bonus with the occupation number basis. The Slater determinant of Eq.~(\ref{eq:secondSD}) and operations upon it 
can easily be encoded useing Boolean algebra!  An unoccupied state is represented by the binary number zero and an occupied state by binary number one.  Section \ref{sec:bitopreations} discusses this, as well several of the exercises at the end of this chapter, where we explore several of these possibilities. 




\section{Creation and annihilation operators}



We introduce the time-independent  operators
$a_\alpha^\dagger$ and $a_\alpha$   which create and annihilate, respectively, a particle 
in the single-particle state 
$\varphi_\alpha$. 
We define the fermion creation operator
$a_\alpha^\dagger$ 
\begin{equation}
	a_\alpha^\dagger\ket{0} \equiv  \ket{\alpha}  \label{eq:2-1a},
\ee
and
\begin{equation}
	a_\alpha^\dagger\ket{\alpha_1\hdots \alpha_n}_as \equiv  \ket{\alpha\alpha_1\hdots \alpha_n}_{as}. \label{eq:2-1b}
\ee
In Eq.~(\ref{eq:2-1a}) 
the operator  $a_\alpha^\dagger$  acts on the vacuum state 
$\ket{0}$, which does not contain any particles. Alternatively, we could define  a closed-shell nucleus as our new vacuum,but then
we need to introduce the particle-hole  formalism, see next section. 

In Eq.~(\ref{eq:2-1b}) $a_\alpha^\dagger$ acts on an antisymmetric $n$-particle state and 
creates an antisymmetric $(n+1)$-particle state, where the one-body state 
$\varphi_\alpha$ is occupied, under the condition that
$\alpha \ne \alpha_1, \alpha_2, \hdots, \alpha_n$. 
From Eq.~(\ref{eq:1-2}) it follows that we can express an antisymmetric state as the product of the creation
operators acting on the vacuum state.  
\begin{equation}
	\ket{\alpha_1\hdots \alpha_n}_as = a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \hdots a_{\alpha_n}^\dagger \ket{0} \label{eq:2-2}
\end{equation}

It is easy to derive the commutation and anticommutation rules  for the fermion creation operators 
$a_\alpha^\dagger$. Using the antisymmetry of the states 
(\ref{eq:2-2})
\begin{equation}
	\ket{\alpha_1\hdots \alpha_i\hdots \alpha_k\hdots \alpha_n}_{as} = 
		- \ket{\alpha_1\hdots \alpha_k\hdots \alpha_i\hdots \alpha_n}_{as} \label{eq:2-3a}
\end{equation}
we obtain
\begin{equation}
	 a_{\alpha_i}^\dagger  a_{\alpha_k}^\dagger = - a_{\alpha_k}^\dagger a_{\alpha_i}^\dagger. \label{eq:2-3b}
\end{equation}
Using the Pauli principle
\begin{equation}
	\ket{\alpha_1\hdots \alpha_i\hdots \alpha_i\hdots \alpha_n}_{as} = 0, \label{eq:2-4a}
\end{equation}
it follows that
\begin{equation}
	a_{\alpha_i}^\dagger  a_{\alpha_i}^\dagger = 0. \label{eq:2-4b}
\end{equation}
If we combine Eqs.~(\ref{eq:2-3b}) and (\ref{eq:2-4b}), we obtain the well-known anti-commutation rule
\begin{equation}
	a_{\alpha}^\dagger  a_{\beta}^\dagger + a_{\beta}^\dagger  a_{\alpha}^\dagger \equiv 
		\{a_{\alpha}^\dagger,a_{\beta}^\dagger\} = 0. \label{eq:2-5}
\end{equation}
The hermitian conjugate  of $a_\alpha^\dagger$ is
\begin{equation}
	a_{\alpha} = ( a_{\alpha}^\dagger )^\dagger. \label{eq:2-6}
\end{equation}
Taking the hermitian conjugate of Eq.~(\ref{eq:2-5}), we arrive at 
\begin{equation}
	\{a_{\alpha},a_{\beta}\} = 0. \label{eq:2-7}
\end{equation}
Having defined these operators, we can always ask about the
the physical interpretation of the operator $a_\alpha$ and the effect of 
$a_\alpha$ on a given state $\ket{\alpha_1\alpha_2\hdots\alpha_n}_{as}$. If we
consider the following matrix element
\begin{equation}
	\element{\alpha_1\alpha_2 \hdots \alpha_n}{a_\alpha}{\alpha_1'\alpha_2' \hdots \alpha_m'}, \label{eq:2-8}
\end{equation}
where both sides are antisymmetric, we  can distinguish between two cases
\begin{enumerate}
\item $\alpha \in \{\alpha_i\}$. Using the Pauli principle of Eq.~(\ref{eq:2-4a}) it follows
	\begin{equation}
		\bra{\alpha_1\alpha_2 \hdots \alpha_n}a_\alpha = 0, \label{eq:2-9a}
	\end{equation}
\item  $\alpha \notin \{\alpha_i\}$. From Eq.~(\ref{eq:2-1}) it follows that the  hermitian conjugation  gives
	\begin{equation}
		\bra{\alpha_1\alpha_2 \hdots \alpha_n}a_\alpha = \bra{\alpha\alpha_1\alpha_2 \hdots \alpha_n}.  \label{eq:2-9b}
	\end{equation}
\end{enumerate}
Eq.~(\ref{eq:2-9b}) holds for case (1) since the left hand side is zero due to the Pauli principle. We write
Eq.~(\ref{eq:2-8}) as
\begin{equation}
	\element{\alpha_1\alpha_2 \hdots \alpha_n}{a_\alpha}{\alpha_1'\alpha_2' \hdots \alpha_m'} = 
	\braket{\alpha_1\alpha_2 \hdots \alpha_n}{\alpha\alpha_1'\alpha_2' \hdots \alpha_m'}. \label{eq:2-10}
\end{equation}
Here we must have $m = n+1$ if Eq.~(\ref{eq:2-10}) has to be trivially different from zero.
Using Eqs.~(\ref{eq:2-9a}) and 
(\ref{eq:2-9a}) we arrive at 
\begin{equation}
	\element{\alpha_1\alpha_2 \hdots \alpha_n}{a_\alpha}{\alpha_1'\alpha_2' \hdots \alpha_{n+1}'} =
	\left\{ \begin{array}{cc}
		0 & \alpha \in \{\alpha_i\} \lor \{\alpha\alpha_i\} \neq \{\alpha_i'\} \\
		\pm 1 & \alpha \notin \{\alpha_i\} \cup \{\alpha\alpha_i\} = \{\alpha_i'\} \\
	\end{array} \right\} \label{eq:2-11}
\end{equation}	
For the last case, the minus and plus signs apply when the sequence 
$\alpha ,\alpha_1, \alpha_2, \hdots, \alpha_n$ and 
$\alpha_1', \alpha_2', \hdots, \alpha_{n+1}'$ are related to each other via even and odd permutations.
If we assume that  $\alpha \notin \{\alpha_i\}$ we have from Eq.~(\ref{eq:2-11}) 
\begin{equation}
	\element{\alpha_1\alpha_2 \hdots \alpha_n}{a_\alpha}{\alpha_1'\alpha_2' \hdots \alpha_{n+1}'} = 0, \label{eq:2-12}
\end{equation}
when $\alpha \in \{\alpha_i'\}$. If $\alpha \notin \{\alpha_i'\}$, we obtain
\begin{equation}
	a_\alpha\underbrace{\ket{\alpha_1'\alpha_2' \hdots \alpha_{n+1}'}}_{\neq \alpha} = 0, \label{eq:2-13a}
\end{equation}
and in particular
\begin{equation}
	a_\alpha \ket{0} = 0. \label{eq:2-13b}
\end{equation}
If $\{\alpha\alpha_i\} = \{\alpha_i'\}$, performing the right permutations, the sequence
$\alpha ,\alpha_1, \alpha_2, \hdots, \alpha_n$ is identical with the sequence
$\alpha_1', \alpha_2', \hdots, \alpha_{n+1}'$. This results in
\begin{equation}
	\element{\alpha_1\alpha_2 \hdots \alpha_n}{a_\alpha}{\alpha\alpha_1\alpha_2 \hdots \alpha_{n}} = 1, \label{eq:2-14}
\end{equation}
and thus
\begin{equation}
	a_\alpha \ket{\alpha\alpha_1\alpha_2 \hdots \alpha_{n}} = \ket{\alpha_1\alpha_2 \hdots \alpha_{n}}. \label{eq:2-15}
\end{equation}
The action of the operator 
$a_\alpha$ from the left on a state vector  is to remove  one particle in the state
$\alpha$. 
If the state vector does not contain the single-particle state $\alpha$, the outcome of the operation is zero.
The operator  $a_\alpha$ is normally called for a destruction or annihilation operator.

The next step is to establish the  commutator algebra of $a_\alpha^\dagger$ and
$a_\beta$. 
The action of the anti-commutator 
$\{a_\alpha^\dagger$,$a_\alpha\}$ on a given $n$-particle state is
\begin{eqnarray}
	a_\alpha^\dagger a_\alpha \underbrace{\ket{\alpha_1\alpha_2 \hdots \alpha_{n}}}_{\neq \alpha} &=& 0 \nonumber \\
	a_\alpha a_\alpha^\dagger \underbrace{\ket{\alpha_1\alpha_2 \hdots \alpha_{n}}}_{\neq \alpha} &=&
	a_\alpha \underbrace{\ket{\alpha \alpha_1\alpha_2 \hdots \alpha_{n}}}_{\neq \alpha} = 
	\underbrace{\ket{\alpha_1\alpha_2 \hdots \alpha_{n}}}_{\neq \alpha}, \label{eq:2-16a}
\end{eqnarray}
if the single-particle state $\alpha$ is not contained in the state. If it is present
we arrive at
\begin{eqnarray}
	a_\alpha^\dagger a_\alpha \ket{\alpha_1\alpha_2 \hdots \alpha_{k}\alpha \alpha_{k+1} \hdots \alpha_{n-1}} &=&
	a_\alpha^\dagger a_\alpha (-1)^k \ket{\alpha \alpha_1\alpha_2 \hdots \alpha_{n-1}} \nonumber \\
	= (-1)^k \ket{\alpha \alpha_1\alpha_2 \hdots \alpha_{n-1}} &=& 
	\ket{\alpha_1\alpha_2 \hdots \alpha_{k}\alpha \alpha_{k+1} \hdots \alpha_{n-1}} \nonumber \\
	a_\alpha a_\alpha^\dagger\ket{\alpha_1\alpha_2 \hdots \alpha_{k}\alpha \alpha_{k+1} \hdots \alpha_{n-1}} &=& 0. \label{eq:2-16b}
\end{eqnarray}
From Eqs.~(\ref{eq:2-16a}) and  (\ref{eq:2-16b}) we find 
\begin{equation}
	\{a_\alpha^\dagger , a_\alpha \} = a_\alpha^\dagger a_\alpha + a_\alpha a_\alpha^\dagger = 1. \label{eq:2-17}
\end{equation}

The action of ${a_\alpha^\dagger, a_\beta}$, with 
$\alpha \ne \beta$ on a given state yields three possibilities. 
The first case is a state vector which contains both $\alpha$ and $\beta$, then either 
$\alpha$ or $\beta$ and finally none of them.
The first case results in
\begin{eqnarray}
	a_\alpha^\dagger a_\beta \ket{\alpha\beta\alpha_1\alpha_2 \hdots \alpha_{n-2}} = 0, \nonumber \\
	a_\beta a_\alpha^\dagger \ket{\alpha\beta\alpha_1\alpha_2 \hdots \alpha_{n-2}} = 0, \label{eq:2-18a}
\end{eqnarray}
while the second case gives
\begin{eqnarray}
	 a_\alpha^\dagger a_\beta \ket{\beta \underbrace{\alpha_1\alpha_2 \hdots \alpha_{n-1}}_{\neq \alpha}} &=& 
	 	\ket{\alpha \underbrace{\alpha_1\alpha_2 \hdots \alpha_{n-1}}_{\neq  \alpha}} \nonumber \\
	a_\beta a_\alpha^\dagger \ket{\beta \underbrace{\alpha_1\alpha_2 \hdots \alpha_{n-1}}_{\neq \alpha}} &=&
		a_\beta \ket{\alpha\beta\underbrace{\beta \alpha_1\alpha_2 \hdots \alpha_{n-1}}_{\neq \alpha}} \nonumber \\
	&=& - \ket{\alpha\underbrace{\alpha_1\alpha_2 \hdots \alpha_{n-1}}_{\neq \alpha}}, \label{eq:2-18b}
\end{eqnarray}
and finally if the state vector does not contain $\alpha$ and $\beta$
\begin{eqnarray}
	a_\alpha^\dagger a_\beta \ket{\underbrace{\alpha_1\alpha_2 \hdots \alpha_{n}}_{\neq \alpha,\beta}} &=& 0 \nonumber \\
	a_\beta a_\alpha^\dagger \ket{\underbrace{\alpha_1\alpha_2 \hdots \alpha_{n}}_{\neq \alpha,\beta}} &=& 
		a_\beta \ket{\alpha \underbrace{\alpha_1\alpha_2 \hdots \alpha_{n}}_{\neq \alpha,\beta}} = 0. \label{eq:2-18c}
\end{eqnarray}
For all three cases we have
\begin{equation}
	\{a_\alpha^\dagger,a_\beta \} = a_\alpha^\dagger a_\beta + a_\beta a_\alpha^\dagger = 0, \quad \alpha \neq \beta. \label{eq:2-19}
\end{equation}
We can summarize  our findings in Eqs.~(\ref{eq:2-17}) and (\ref{eq:2-19}) as 
\begin{equation}
	\{a_\alpha^\dagger,a_\beta \} = \delta_{\alpha\beta}, \label{eq:2-20}
\end{equation}
where  $\delta_{\alpha\beta}$ is the Kroenecker $\delta$-symbol.

The properties of the fermion creation and annihilation operators can be summarized as
\[
	a_\alpha^\dagger\ket{0} \equiv  \ket{\alpha},
\]
and 
\[
	a_\alpha^\dagger\ket{\alpha_1\hdots \alpha_n} \equiv  \ket{\alpha\alpha_1\hdots \alpha_n}. 
\]
from which follows
\[
        \ket{\alpha_1\hdots \alpha_n} = a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \hdots a_{\alpha_n}^\dagger \ket{0}.
\]
The hermitian conjugate has the folowing properties
\[
        a_{\alpha} = ( a_{\alpha}^\dagger )^\dagger.
\]
Finally we found 
\[
	a_\alpha\underbrace{\ket{\alpha_1'\alpha_2' \hdots \alpha_{n+1}'}}_{\neq \alpha} = 0, \quad
		\textrm{spesielt } a_\alpha \ket{0} = 0,
\]
and 
\[
 a_\alpha \ket{\alpha\alpha_1\alpha_2 \hdots \alpha_{n}} = \ket{\alpha_1\alpha_2 \hdots \alpha_{n}},
\]
and the corresponding commutator algebra
\[
	\{a_{\alpha}^\dagger,a_{\beta}^\dagger\} = \{a_{\alpha},a_{\beta}\} = 0 \hspace{0.5cm} 
\mathrm{and} \hspace{0.1cm}\{a_\alpha^\dagger,a_\beta \} = \delta_{\alpha\beta}.
\]

\section{Operators in the occupation number representation}

With the above definitions, 
we will now represent our many-particle operators $H_0$ and $H_I$, or any operator of the one-body, two-body or many-body type, 
in terms of the creation and annihilation operators.  
Combined with Wick's theorem and the above anti-commutation relation, this yields a very powerful way to
compute quantum-mechanical expectation values. 


\subsection{Number operator}

A very useful operator is the so.called number-operator.  Many of the  physical processes  we will
study in this text conserve the total number of particles (typically either the total number of baryons or leptons).  
The number operator is therefore
a useful quantity which allows us to test that our many-body formalism  conserves the number of particles. Furthermore, it provides
the connection to quantities like onebody densities and spectroscopic factors to be discussed later. 
As an example, for $(d,p)$ or $(p,d)$ reactions it is important to be able to describe quantum mechanical states
where particles get added or removed.
A creation operator $a_\alpha^\dagger$ adds one particle to the single-particle state
$\alpha$ of a give many-body state vector, while an annihilation operator $a_\alpha$ 
removes a particle from a single-particle
state $\alpha$. 

Let us consider an operator proportional with $a_\alpha^\dagger a_\beta$ and 
$\alpha=\beta$. It acts on an $A$-nucleon state 
resulting in
\begin{equation}
	a_\alpha^\dagger a_\alpha \ket{\alpha_1\alpha_2 \hdots \alpha_{A}} = 
	\begin{cases}
		0  &\alpha \notin \{\alpha_i\} \\
		\\
		\ket{\alpha_1\alpha_2 \hdots \alpha_{A}} & \alpha \in \{\alpha_i\}. \tag{2-16}
	\end{cases}
\end{equation}
Summing over all possible one-particle states we arrive at
\begin{equation}
	\left( \sum_\alpha a_\alpha^\dagger a_\alpha \right) \ket{\alpha_1\alpha_2 \hdots \alpha_{n}} = 
	n \ket{\alpha_1\alpha_2 \hdots \alpha_{n}}. \label{eq:2-21}
\end{equation}
The operator 
\begin{equation}
	N = \sum_\alpha a_\alpha^\dagger a_\alpha, \label{eq:2-22}
\end{equation}
is called the number operator since it counts the number of particles in a given state vector when it acts 
on the different single-particle states.  It acts on one single-particle state at the time and falls 
therefore under category one-body operators.
Next we look at another important one-body operator, namely $\hat{H}_0$ and study its operator form in the 
occupation number representation.


\subsection{One-body operators}

We want to obtain an expression for a one-body operator which conserves the number of particles.
Here we study the one-body operator for the kinetic energy plus an eventual external one-body potential.
The action of this operator on a particular $A$-body state with its pertinent expectation value has already
been studied in coordinate  space in the previous two chapters.
In coordinate space the operator reads
\begin{equation}
	\hat{H}_0 = \sum_i h(x_i), \label{eq:2-23}
\end{equation}
and the anti-symmetric $A$-nucleon Slater determinant is defined as 
\begin{equation}
\Phi(x_1, x_2,\dots ,x_A,\alpha_1,\alpha_2,\dots, \alpha_A)= \frac{1}{\sqrt{A!}} \sum_p (-1)^p\hat{P}
		\psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2) \hdots \psi_{\alpha_n}(x_A).\label{eq:2-24}
\end{equation}
Using the spectral decomposition of a state function, we can write the action of the one-body
operator on a single-particle state  $\psi_{\alpha_i}(x_i)$ as 
\begin{equation}
	h(x_i) \psi_{\alpha_i}(x_i) = \sum_{\alpha_k'} \psi_{\alpha_k'}(x_i) \element{\alpha_k'}{\hat{h}}{\alpha_k} \label{eq:2-25}
\end{equation}
we can easily  evaluate the action of $\hat{H}_0$ on each product of one-particle functions in Slater determinant.
%$\ket{\alpha_1\alpha_2\hdots\alpha_n}$.
From Eqs.~(\ref{eq:2-24}) 
(\ref{eq:2-25})  we obtain the following result without  permuting any particle pair 
\begin{eqnarray}
	&& \left( \sum_i h(x_i) \right) \psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2) \hdots \psi_{\alpha_n}(x_n) \nonumber \\
	& =&\sum_{\alpha_1'} \element{\alpha_1'}{h}{\alpha_1} 
		\psi_{\alpha_1'}(x_1)\psi_{\alpha_2}(x_2) \hdots \psi_{\alpha_n}(x_n) \nonumber \\
	&+&\sum_{\alpha_2'} \element{\alpha_2'}{h}{\alpha_2} 
		\psi_{\alpha_1}(x_1)\psi_{\alpha_2'}(x_2) \hdots \psi_{\alpha_n}(x_n) \nonumber \\
	&+& \hdots \nonumber \\
	&+&\sum_{\alpha_n'} \element{\alpha_n'}{h}{\alpha_n} 
		\psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2) \hdots \psi_{\alpha_n'}(x_n) \label{eq:2-26}
\end{eqnarray}
If we interchange the positions of particle $1$ and $2$  we obtain
\begin{eqnarray}
	&& \left( \sum_i h(x_i) \right) \psi_{\alpha_1}(x_2)\psi_{\alpha_1}(x_1) \hdots \psi_{\alpha_n}(x_n) \nonumber \\
	& =&\sum_{\alpha_2'} \element{\alpha_2'}{h}{\alpha_2} 
		\psi_{\alpha_1}(x_2)\psi_{\alpha_2'}(x_1) \hdots \psi_{\alpha_n}(x_n) \nonumber \\
	&+&\sum_{\alpha_1'} \element{\alpha_1'}{h}{\alpha_1} 
		\psi_{\alpha_1'}(x_2)\psi_{\alpha_2}(x_1) \hdots \psi_{\alpha_n}(x_n) \nonumber \\
	&+& \hdots \nonumber \\
	&+&\sum_{\alpha_n'} \element{\alpha_n'}{h}{\alpha_n} 
		\psi_{\alpha_1}(x_2)\psi_{\alpha_2}(x_1) \hdots \psi_{\alpha_n'}(x_n) \label{eq:2-27}
\end{eqnarray}
We can continue by computing all possible permutations. 
We rewrite also our Slater determinant in its second quantized representation and skip the dependence on the quantum numbers $x_i$.
Summing up all contributions and taking care of all phases
$(-1)^p$ we arrive at 
\begin{eqnarray}
	\hat{H}_0|\alpha_1,\alpha_2,\dots, \alpha_n\rangle &=& \sum_{\alpha_1'}\element{\alpha_1'}{h}{\alpha_1}
		\ket{\alpha_1'\alpha_2 \hdots \alpha_{n}} \nonumber \\
	&+& \sum_{\alpha_2'} \element{\alpha_2'}{h}{\alpha_2}
		\ket{\alpha_1\alpha_2' \hdots \alpha_{n}} \nonumber \\
	&+& \hdots \nonumber \\
	&+& \sum_{\alpha_n'} \element{\alpha_n'}{h}{\alpha_n}
		\ket{\alpha_1\alpha_2 \hdots \alpha_{n}'} \label{eq:2-28}
\end{eqnarray}
In Eq.~(\ref{eq:2-28}) 
we have expressed the action of the one-body operator
of Eq.~(\ref{eq:2-23}) on the  $n$-body state of Eq.~(\ref{eq:2-24}) in its second quantized form.
This equation can be further manipulated if we use the properties of the creation and annihilation operator
on each primed quantum number, that is
\begin{equation}
	\ket{\alpha_1\alpha_2 \hdots \alpha_k' \hdots \alpha_{n}} = 
		a_{\alpha_k'}^\dagger  a_{\alpha_k} \ket{\alpha_1\alpha_2 \hdots \alpha_k \hdots \alpha_{n}} \label{eq:2-29}
\end{equation}
Inserting this in the right-hand side of Eq.~(\ref{eq:2-28}) results in
\begin{eqnarray}
	\hat{H}_0\ket{\alpha_1\alpha_2 \hdots \alpha_{n}} &=& \sum_{\alpha_1'}\element{\alpha_1'}{h}{\alpha_1}
		a_{\alpha_1'}^\dagger  a_{\alpha_1} \ket{\alpha_1\alpha_2 \hdots \alpha_{n}} \nonumber \\
	&+& \sum_{\alpha_2'} \element{\alpha_2'}{h}{\alpha_2}
		a_{\alpha_2'}^\dagger  a_{\alpha_2} \ket{\alpha_1\alpha_2 \hdots \alpha_{n}} \nonumber \\
	&+& \hdots \nonumber \\
	&+& \sum_{\alpha_n'} \element{\alpha_n'}{h}{\alpha_n}
		a_{\alpha_n'}^\dagger  a_{\alpha_n} \ket{\alpha_1\alpha_2 \hdots \alpha_{n}} \nonumber \\
	&=& \sum_{\alpha\beta} \element{\alpha}{h}{\beta} a_\alpha^\dagger a_\beta 
		\ket{\alpha_1\alpha_2 \hdots \alpha_{n}} \label{eq:2-30a}
\end{eqnarray}
In the number occupation representation or second quantization we get the following expression for a one-body 
operator which conserves the number of particles
\begin{equation}
	\hat{H}_0 = \sum_{\alpha\beta} \element{\alpha}{h}{\beta} a_\alpha^\dagger a_\beta. \label{eq:2-30b}
\end{equation}
Obviously, $\hat{H}_0$ can be replaced by any other one-body  operator which preserves the number
of particles. The stucture of the operator is therefore not limited to say the kinetic or single-particle energy only.

The operator $\hat{H}_0$ takes a particle from the single-particle state $\beta$  to the single-particle state $\alpha$ 
with a probability for the transition given by the expectation value $\element{\alpha}{h}{\beta}$.

It is instructive to verify Eq.~(\ref{eq:2-30b}) by computing the expectation value of $\hat{H}_0$ 
between two single-particle states $|\alpha_1 \rangle$ and $|\alpha_2 \rangle$
\begin{equation}
	\element{\alpha_1}{\hat{H}_0}{\alpha_2} = \sum_{\alpha\beta} \element{\alpha}{h}{\beta} 
		\element{0}{a_{\alpha_1}a_\alpha^\dagger a_\beta a_{\alpha_2}^\dagger}{0}. \label{eq:2-30c}
\end{equation}
Using the commutation relations for the creation and annihilation operators we have 
\begin{equation}
	a_{\alpha_1}a_\alpha^\dagger a_\beta a_{\alpha_2}^\dagger = (\delta_{\alpha \alpha_1} - a_\alpha^\dagger a_{\alpha_1} )
		(\delta_{\beta \alpha_2} - a_{\alpha_2}^\dagger a_{\beta} ), \label{eq:2-30d}
\end{equation}
which results in
\begin{equation}
	\element{0}{a_{\alpha_1}a_\alpha^\dagger a_\beta a_{\alpha_2}^\dagger}{0} = 
		\delta_{\alpha \alpha_1} \delta_{\beta \alpha_2}, \label{eq:2-30e}
\end{equation}
and
\begin{equation}
	\element{\alpha_1}{\hat{H}_0}{\alpha_2} = \sum_{\alpha\beta} \element{\alpha}{h}{\beta} 
		\delta_{\alpha \alpha_1} \delta_{\beta \alpha_2} = \element{\alpha_1}{h}{\alpha_2}, \label{eq:2-30f}
\end{equation}
as we would expect.

\subsection{Two-body operators}

Let us now derive the expression for our two-body interaction part, which also conserves the number of particles.
We can proceed in exactly the same way as we did for the one-body operator. In the coordinate representation our
two-body interaction part takes the following expression using the spectral decomposition 
\begin{equation}
	\hat{H}_1 = \sum_{i<j} \hat{V}(x_i,x_j), \label{eq:2-31}
\end{equation}
where the summation runs over distinct pairs. The term $V$ can be an interaction model for the nucleon-nucleon 
interaction. It can also include additional two-body interaction terms or we replace the two-body potential energy with say the operator
for double-$\beta$ decay to be discussed later or two-body operators for electromagnetic transitions etc. 
The action of this operator on a product of 
two single-particle functions is defined as 
\begin{equation}
	\hat{V}(x_i,x_j) \psi_{\alpha_k}(x_i) \psi_{\alpha_l}(x_j) = \sum_{\alpha_k'\alpha_l'} 
		\psi_{\alpha_k}'(x_i)\psi_{\alpha_l}'(x_j) 
		\element{\alpha_k'\alpha_l'}{V}{\alpha_k\alpha_l}, \label{eq:2-32}
\end{equation}
We can now let $\hat{H}_1$ act on all terms in the linear combination of Eq.~(\ref{eq:2-34})
for $\ket{\alpha_1\alpha_2\hdots\alpha_n}$. Without any permutations we have
\begin{eqnarray}
	&& \left( \sum_{i<j} V(x_i,x_j) \right) \psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2)\hdots \psi_{\alpha_n}(x_n) \nonumber \\
	&=& \sum_{\alpha_1'\alpha_2'} \element{\alpha_1'\alpha_2'}{V}{\alpha_1\alpha_2}
		\psi_{\alpha_1}'(x_1)\psi_{\alpha_2}'(x_2)\hdots \psi_{\alpha_n}(x_n) \nonumber \\
	& +& \hdots \nonumber \\
	&+& \sum_{\alpha_1'\alpha_n'} \element{\alpha_1'\alpha_n'}{V}{\alpha_1\alpha_n}
		\psi_{\alpha_1}'(x_1)\psi_{\alpha_2}(x_2)\hdots \psi_{\alpha_n}'(x_n) \nonumber \\
	& +& \hdots \nonumber \\
	&+& \sum_{\alpha_2'\alpha_n'} \element{\alpha_2'\alpha_n'}{V}{\alpha_2\alpha_n}
		\psi_{\alpha_1}(x_1)\psi_{\alpha_2}'(x_2)\hdots \psi_{\alpha_n}'(x_n) \nonumber \\
	 & +& \hdots \label{eq:2-33}
\end{eqnarray}
where on the right hand side we have one term for every distinct pair of single-particle states.
If we now include all possible permutations of pairs of fermions, summing over all terms and using the second quantized form of the Slater determinant, we arrive at
\begin{eqnarray}
	\hat{V} \ket{\alpha_1\alpha_2\hdots\alpha_n} &=& \sum_{\alpha_1', \alpha_2'} \element{\alpha_1'\alpha_2'}{V}{\alpha_1\alpha_2}
		\ket{\alpha_1'\alpha_2'\hdots\alpha_n} \nonumber \\
	&+& \hdots \nonumber \\
	&+& \sum_{\alpha_1', \alpha_n'} \element{\alpha_1'\alpha_n'}{V}{\alpha_1\alpha_n}
		\ket{\alpha_1'\alpha_2\hdots\alpha_n'} \nonumber \\
	&+& \hdots \nonumber \\
	&+& \sum_{\alpha_2', \alpha_n'} \element{\alpha_2'\alpha_n'}{V}{\alpha_2\alpha_n}
		\ket{\alpha_1\alpha_2'\hdots\alpha_n'}. \nonumber \\
	 &+& \hdots \label{eq:2-34}
\end{eqnarray}
We repeat our rewriting of the Slater determinant representation as
\begin{eqnarray}
	&& a_{\alpha_k'}^\dagger a_{\alpha_l'}^\dagger a_{\alpha_l} a_{\alpha_k} 
		\ket{\alpha_1\alpha_2\hdots\alpha_k\hdots\alpha_l\hdots\alpha_n} \nonumber \\
	&=& (-1)^{k-1} (-1)^{l-2} a_{\alpha_k'}^\dagger a_{\alpha_l'}^\dagger a_{\alpha_l} a_{\alpha_k}
		\ket{\alpha_k\alpha_l \underbrace{\alpha_1\alpha_2\hdots\alpha_n}_{\neq \alpha_k,\alpha_l}} \nonumber \\
	&=& (-1)^{k-1} (-1)^{l-2} 
	\ket{\alpha_k'\alpha_l' \underbrace{\alpha_1\alpha_2\hdots\alpha_n}_{\neq \alpha_k',\alpha_l'}} \nonumber \\
	&=& \ket{\alpha_1\alpha_2\hdots\alpha_k'\hdots\alpha_l'\hdots\alpha_n}, \label{eq:2-35}
\end{eqnarray}
where we now have introduced two creation and annihilation operators.
Inserting this experssion in Eq.~(\ref{eq:2-34}) results in
\begin{eqnarray}
	\hat{V} \ket{\alpha_1\alpha_2\hdots\alpha_n}
	&=& \sum_{\alpha_1', \alpha_2'} \element{\alpha_1'\alpha_2'}{V}{\alpha_1\alpha_2}
		a_{\alpha_1'}^\dagger a_{\alpha_2'}^\dagger a_{\alpha_2} a_{\alpha_1}
		\ket{\alpha_1\alpha_2\hdots\alpha_n} \nonumber \\
	&+& \hdots \nonumber \\
	&=& \sum_{\alpha_1', \alpha_n'} \element{\alpha_1'\alpha_n'}{V}{\alpha_1\alpha_n}
		a_{\alpha_1'}^\dagger a_{\alpha_n'}^\dagger a_{\alpha_n} a_{\alpha_1}
		\ket{\alpha_1\alpha_2\hdots\alpha_n} \nonumber \\
	&+& \hdots \nonumber \\
	&=& \sum_{\alpha_2', \alpha_n'} \element{\alpha_2'\alpha_n'}{V}{\alpha_2\alpha_n}
		a_{\alpha_2'}^\dagger a_{\alpha_n'}^\dagger a_{\alpha_n} a_{\alpha_2}
		\ket{\alpha_1\alpha_2\hdots\alpha_n} \nonumber \\
	&+& \hdots \nonumber \\
	&=& \sum_{\alpha, \beta, \gamma, \delta} ' \element{\alpha\beta}{V}{\gamma\delta}
		a^\dagger_\alpha a^\dagger_\beta a_\delta a_\gamma
		\ket{\alpha_1\alpha_2\hdots\alpha_n}. \label{eq:2-36}
\end{eqnarray}
The symbol $\sum'$ indicates that the sum over
$\alpha$ and $\beta$ runs over all single-particle states, while the summation 
over $\gamma$ and $\delta$  runs over distinct pairs of single-particle states. To remove this restriction, we recall first that
our two-body interaction obeys permutation symmetry, that is 
\begin{equation}
	\element{\alpha\beta}{V}{\gamma\delta} = \element{\beta\alpha}{V}{\delta\gamma}. \label{eq:2-37}
\end{equation}
This allows us to rewrite 
\begin{subequations} \label{eq:2-38}
\begin{eqnarray}
	\sum_{\alpha, \beta} \element{\alpha\beta}{V}{\gamma\delta} a^\dagger_\alpha a^\dagger_\beta a_\delta a_\gamma &=& 
		\sum_{\alpha, \beta} \element{\beta\alpha}{V}{\delta\gamma} 
		a^\dagger_\alpha a^\dagger_\beta a_\delta a_\gamma \label{eq:2-38a} \\
	&=& \sum_{\alpha, \beta}\element{\beta\alpha}{V}{\delta\gamma} 
		a^\dagger_\beta a^\dagger_\alpha a_\gamma a_\delta, \label{eq:2-38b}
\end{eqnarray}
where we in  (\ref{eq:2-38b}) have used the anti-communication relations of Eqs.~(\ref{eq:2-5}) and (\ref{eq:2-7}).
Since the summation indices $\alpha$ and $\beta$ in Eq.~(\ref{eq:2-38b}) are just mere dummy indices, 
we can interchange them and obtain
\begin{equation}
	\sum_{\alpha, \beta} \element{\alpha\beta}{V}{\gamma\delta} a^\dagger_\alpha a^\dagger_\beta a_\delta a_\gamma =
		 \sum_{\alpha, \beta} \element{\alpha\beta}{V}{\delta\gamma} 
		  a^\dagger_\alpha a^\dagger_\beta  a_\gamma a_\delta. \label{eq:2-38c}
\end{equation}
\end{subequations}
We can thereafter remove the restrict  on the sum over the pairs $\gamma$ and $\delta$  by summing freely and dividing 
by a factor $1/2$, resulting in 
\begin{equation}
	\hat{V} = \frac{1}{2} \sum_{\alpha\beta\gamma\delta} \element{\alpha\beta}{V}{\gamma\delta}
		a^\dagger_\alpha a^\dagger_\beta a_\delta a_\gamma, \label{eq:2-39}
\end{equation}
where we sum freely over the indices $\alpha$, $\beta$, $\gamma$ and $\delta$.


We can now verify that the second quantized representation of the interaction from Eq.~(\ref{eq:2-39})
results in the same matrix elements for an anti-symmetrized two-body state, as we obtained in the previous chapter.
The expectation value we wish to calculate is 
\begin{equation}
	\element{\alpha_1 \alpha_2}{V}{\beta_1 \beta_2} =
		\frac{1}{2} \sum_{\alpha, \beta, \gamma, \delta}
			\element{\alpha\beta}{V}{\gamma\delta} \element{0}{a_{\alpha_2} a_{\alpha_1} 
			 a^\dagger_\alpha a^\dagger_\beta a_\delta a_\gamma 
			 a_{\beta_1}^\dagger a_{\beta_2}^\dagger}{0}. \label{eq:2-40}
\end{equation}
where the states $a_{\beta_1}^\dagger a_{\beta_2}^\dagger|0\rangle = |\beta_1\beta_2\rangle$ and 
$a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger|0\rangle = |\alpha_1\alpha_2\rangle$ are anti-symmetrized via the anti-commutation properties of
the creation and annihilation operators. 
Using the fact that an annihilation operator acting on the vacuum state $|0\rangle$ gives zero, we can use the anti-commutation relations
to bring the above chain of creation and annihilation operators in order to bring at least one annihilation operator to the right.
Using the anti-commutation relations we can rewrite the expectation value $\element{0}{a_{\alpha_2} a_{\alpha_1} a^\dagger_\alpha a^\dagger_\beta a_\delta a_\gamma a_{\beta_1}^\dagger a_{\beta_2}^\dagger}{0}$ (skipping the vacuum states) as
\begin{eqnarray}
	&& a_{\alpha_2} a_{\alpha_1}a^\dagger_\alpha a^\dagger_\beta 
		a_\delta a_\gamma a_{\beta_1}^\dagger a_{\beta_2}^\dagger \nonumber \\
	&=& a_{\alpha_2} a_{\alpha_1}a^\dagger_\alpha a^\dagger_\beta 
		( a_\delta \delta_{\gamma \beta_1} a_{\beta_2}^\dagger - 
		a_\delta  a_{\beta_1}^\dagger a_\gamma a_{\beta_2}^\dagger ) \nonumber \\
	&=& a_{\alpha_2} a_{\alpha_1}a^\dagger_\alpha a^\dagger_\beta 
		(\delta_{\gamma \beta_1} \delta_{\delta \beta_2} - \delta_{\gamma \beta_1} a_{\beta_2}^\dagger a_\delta -
		a_\delta a_{\beta_1}^\dagger\delta_{\gamma \beta_2} +
		a_\delta a_{\beta_1}^\dagger a_{\beta_2}^\dagger a_\gamma ) \nonumber \\
	&=& a_{\alpha_2} a_{\alpha_1}a^\dagger_\alpha a^\dagger_\beta 
		(\delta_{\gamma \beta_1} \delta_{\delta \beta_2} - \delta_{\gamma \beta_1} a_{\beta_2}^\dagger a_\delta \nonumber \\
		&& \qquad - \delta_{\delta \beta_1} \delta_{\gamma \beta_2} + \delta_{\gamma \beta_2} a_{\beta_1}^\dagger a_\delta
		+ a_\delta a_{\beta_1}^\dagger a_{\beta_2}^\dagger a_\gamma ). \label{eq:2-41}
\end{eqnarray}
We obtain 
\begin{subequations} \label{eq:2-42}
\begin{eqnarray}
	&& \element{0}{a_{\alpha_2} a_{\alpha_1} a^\dagger_\alpha a^\dagger_\beta a_\delta a_\gamma 
		a_{\beta_1}^\dagger a_{\beta_2}^\dagger}{0} \nonumber \\
	&=& (\delta_{\gamma \beta_1} \delta_{\delta \beta_2} -
		\delta_{\delta \beta_1} \delta_{\gamma \beta_2} ) 
		\element{0}{a_{\alpha_2} a_{\alpha_1}a^\dagger_\alpha a^\dagger_\beta}{0} \label{eq:2-42a} \\
	&=& (\delta_{\gamma \beta_1} \delta_{\delta \beta_2} -\delta_{\delta \beta_1} \delta_{\gamma \beta_2} )
	(\delta_{\alpha \alpha_1} \delta_{\beta \alpha_2} -\delta_{\beta \alpha_1} \delta_{\alpha \alpha_2} ), \label{eq:2-42b}
\end{eqnarray}
\end{subequations}
and we obtain finally
\begin{subequations} \label{eq:2-43}
\begin{eqnarray}
	\element{\alpha_1\alpha_2}{V}{\beta_1\beta_2}_{as} &=& \frac{1}{2} \big[ 
		\element{\alpha_1\alpha_2}{V}{\beta_1\beta_2} - \element{\alpha_1\alpha_2}{V}{\beta_2\beta_1} \nonumber \\
		&& - \element{\alpha_2\alpha_1}{V}{\beta_1\beta_2} + \element{\alpha_2\alpha_1}{V}{\beta_2\beta_1} \big] \nonumber \\
	&=& \element{\alpha_1\alpha_2}{V}{\beta_1\beta_2} - \element{\alpha_1\alpha_2}{V}{\beta_2\beta_1} \label{eq:2-43a} \\
	&=& \element{\alpha_1\alpha_2}{V}{\beta_1\beta_2}_{as}, \label{eq:2-43b}
\end{eqnarray}
\end{subequations}
which is the same result we obtained in the previous chapter.
\begin{eqnarray}
	&& \sum_{\gamma, \delta} \element{\alpha \beta}{V}{\gamma \delta} a_\alpha^\dagger a_\beta^\dagger a_\delta a_\gamma \nonumber \\
	&& \quad = \sum_{\gamma, \delta} \element{\alpha \beta}{V}{\delta\gamma }
		a_\alpha^\dagger a_\beta^\dagger a_\gamma a_\delta \nonumber \\
	&& \quad = - \sum_{\gamma, \delta} \element{\alpha \beta}{V}{\delta\gamma } 
		a_\alpha^\dagger a_\beta^\dagger a_\delta a_\gamma \label{eq:2-44}
\end{eqnarray}
We can also rewrite the two-body operator in terms of the anti-symmetrized matrix elements by interchanging the 
indices $\gamma$ and $\delta$ in the second term of the second line and using the anti-commutation relations
of Eq.~(\ref{eq:2-7})

\begin{eqnarray}
	\hat{V} &=& \frac{1}{2} \sum_{\alpha, \beta, \gamma, \delta}  \element{\alpha \beta}{V}{\gamma \delta}
		a_\alpha^\dagger a_\beta^\dagger a_\delta a_\gamma \nonumber \\
	&=& \frac{1}{4} \sum_{\alpha, \beta, \gamma, \delta} \left[ \element{\alpha \beta}{V}{\gamma \delta} -
		\element{\alpha \beta}{V}{\delta\gamma } \right] 
		a_\alpha^\dagger a_\beta^\dagger a_\delta a_\gamma \nonumber \\
	&=& \frac{1}{4} \sum_{\alpha, \beta, \gamma, \delta} \element{\alpha \beta}{V}{\gamma \delta}_{as}
		a_\alpha^\dagger a_\beta^\dagger a_\delta a_\gamma, \label{eq:2-45}
\end{eqnarray}
result

\begin{equation}
	\hat{H}_1 = \frac{1}{2} \sum_{\alpha\beta\gamma\delta} \element{\alpha\beta}{V}{\gamma\delta}
		a^\dagger_\alpha a^\dagger_\beta a_\delta a_\gamma \label{eq:2-39}
\end{equation}
where we sum freely over all single-particle states $\alpha$, 
$\beta$, $\gamma$ og $\delta$. 
(plug in remark about pauli principle and computation of diagrams add more text here to make it flow better)

With this expression we can now verify that the second quantization form of $\hat{H}_I$ in 
Eq.~(\ref{eq:2-39}) 
results in the same matrix elements between two anti-symmetrized two-particle states as its corresponding coordinate
space representation. We have  
\begin{equation}
	\element{\alpha_1 \alpha_2}{\hat{H}_1}{\beta_1 \beta_2} =
		\frac{1}{2} \sum_{\alpha\beta\gamma, \delta}
			\element{\alpha\beta}{V}{\gamma\delta} \element{0}{a_{\alpha_2} a_{\alpha_1} 
			 a^\dagger_\alpha a^\dagger_\beta a_\delta a_\gamma 
			 a_{\beta_1}^\dagger a_{\beta_2}^\dagger}{0}. \label{eq:2-40}
\end{equation}
Using the commutation relations we get 
\begin{eqnarray}
	&& a_{\alpha_2} a_{\alpha_1}a^\dagger_\alpha a^\dagger_\beta 
		a_\delta a_\gamma a_{\beta_1}^\dagger a_{\beta_2}^\dagger \nonumber \\
	&=& a_{\alpha_2} a_{\alpha_1}a^\dagger_\alpha a^\dagger_\beta 
		( a_\delta \delta_{\gamma \beta_1} a_{\beta_2}^\dagger - 
		a_\delta  a_{\beta_1}^\dagger a_\gamma a_{\beta_2}^\dagger ) \nonumber \\
	&=& a_{\alpha_2} a_{\alpha_1}a^\dagger_\alpha a^\dagger_\beta 
		(\delta_{\gamma \beta_1} \delta_{\delta \beta_2} - \delta_{\gamma \beta_1} a_{\beta_2}^\dagger a_\delta -
		a_\delta a_{\beta_1}^\dagger\delta_{\gamma \beta_2} +
		a_\delta a_{\beta_1}^\dagger a_{\beta_2}^\dagger a_\gamma ) \nonumber \\
	&=& a_{\alpha_2} a_{\alpha_1}a^\dagger_\alpha a^\dagger_\beta 
		(\delta_{\gamma \beta_1} \delta_{\delta \beta_2} - \delta_{\gamma \beta_1} a_{\beta_2}^\dagger a_\delta \nonumber \\
		&& \qquad - \delta_{\delta \beta_1} \delta_{\gamma \beta_2} + \delta_{\gamma \beta_2} a_{\beta_1}^\dagger a_\delta
		+ a_\delta a_{\beta_1}^\dagger a_{\beta_2}^\dagger a_\gamma ) \label{eq:2-41}
\end{eqnarray}
The vacuum expectation value of this product of operators becomes
\begin{eqnarray}
	&& \element{0}{a_{\alpha_2} a_{\alpha_1} a^\dagger_\alpha a^\dagger_\beta a_\delta a_\gamma 
		a_{\beta_1}^\dagger a_{\beta_2}^\dagger}{0} \nonumber \\
	&=& (\delta_{\gamma \beta_1} \delta_{\delta \beta_2} -
		\delta_{\delta \beta_1} \delta_{\gamma \beta_2} ) 
		\element{0}{a_{\alpha_2} a_{\alpha_1}a^\dagger_\alpha a^\dagger_\beta}{0} \nonumber \\
	&=& (\delta_{\gamma \beta_1} \delta_{\delta \beta_2} -\delta_{\delta \beta_1} \delta_{\gamma \beta_2} )
	(\delta_{\alpha \alpha_1} \delta_{\beta \alpha_2} -\delta_{\beta \alpha_1} \delta_{\alpha \alpha_2} ) \label{eq:2-42b}
\end{eqnarray}
Insertion of 
Eq.~(\ref{eq:2-42b}) in Eq.~(\ref{eq:2-40}) results in
\begin{eqnarray}
	\element{\alpha_1\alpha_2}{\hat{H}_1}{\beta_1\beta_2} &=& \frac{1}{2} \big[ 
		\element{\alpha_1\alpha_2}{V}{\beta_1\beta_2} - \element{\alpha_1\alpha_2}{V}{\beta_2\beta_1} \nonumber \\
		&& - \element{\alpha_2\alpha_1}{V}{\beta_1\beta_2} + \element{\alpha_2\alpha_1}{V}{\beta_2\beta_1} \big] \nonumber \\
	&=& \element{\alpha_1\alpha_2}{V}{\beta_1\beta_2} - \element{\alpha_1\alpha_2}{V}{\beta_2\beta_1} \nonumber \\
	&=& \element{\alpha_1\alpha_2}{V}{\beta_1\beta_2}. \label{eq:2-43b}
\end{eqnarray}
The two-body operator can also be expressed in terms of the anti-symmetrized matrix elements we discussed previously as
\begin{eqnarray}
	\hat{H}_1 &=& \frac{1}{2} \sum_{\alpha\beta\gamma\delta}  \element{\alpha \beta}{V}{\gamma \delta}
		a_\alpha^\dagger a_\beta^\dagger a_\delta a_\gamma \nonumber \\
	&=& \frac{1}{4} \sum_{\alpha\beta\gamma\delta} \left[ \element{\alpha \beta}{V}{\gamma \delta} -
		\element{\alpha \beta}{V}{\delta\gamma } \right] 
		a_\alpha^\dagger a_\beta^\dagger a_\delta a_\gamma \nonumber \\
	&=& \frac{1}{4} \sum_{\alpha\beta\gamma\delta} \element{\alpha \beta}{V}{\gamma \delta}_{AS}
		a_\alpha^\dagger a_\beta^\dagger a_\delta a_\gamma \label{eq:2-45}
\end{eqnarray}

In this text we will assume that our matrix elements are anti-symmetric and 
will therefore skip the subscript $AS$.
The factors in front of the operator, either  $\frac{1}{4}$ or 
$\frac{1}{2}$ tells whether we use antisymmetrized matrix elements or not. 

We can now express the Hamiltonian operator for a many-fermion system  in the occupation basis representation
of Eq.~(\ref{eq:1-2}) as  
\begin{equation}
	\hat{H} = \sum_{\alpha, \beta} \element{\alpha}{t+u}{\beta} a_\alpha^\dagger a_\beta + \frac{1}{4} \sum_{\alpha, \beta, \gamma, \delta}
		\element{\alpha \beta}{V}{\gamma \delta} a_\alpha^\dagger a_\beta^\dagger a_\delta a_\gamma. \label{eq:2-46b}
\end{equation}
This is form we will use in the rest of this text, assuming that we work with anti-symmetrized two-body matrix elements.

\subsection{Transforming operators to specific many-body forms and algorithmic issues}
In the previous equation, we saw how to express one-body and two-body operators in a second quantized form. The Hamiltonian 
of Eq.~(\ref{eq:2-46b}) is used routinely in various many-body methods. In for example configuration interaction approaches, the action of $\hat{H}$ on a given basis of Slater determinants is performed repeatedly. To handle efficiently operations like
\[
\left(\sum_{\alpha, \beta} \element{\alpha}{t+u}{\beta} a_\alpha^\dagger a_\beta + \frac{1}{4} \sum_{\alpha, \beta, \gamma, \delta}
		\element{\alpha \beta}{V}{\gamma \delta} a_\alpha^\dagger a_\beta^\dagger a_\delta a_\gamma\right)\prod_{i=1}^{F}a_i^{\dagger}|0\rangle,
\]
is crucial for an implementation of a given many-body
method. In the above equation we have one-body and two-body operators
acting on a many-particle state. The two-body operator constitutes the
time-consuming part of these operations since it involves a sum over
four indices. We could then lump together the one-body and two-body
operators and reorder the free sums over the various indices. To
achieve let us however start with a constant and turn this into a
one-body operator.
We have already encountered the number operator $\hat{N}=\sum_pa_p^{\dagger} a_p$ whose action on a many-particle Slater determinant has as eigenvalue the number of particles $A$. 
A constant $c_0$ can then written as a one-body operator in a general form as 
\begin{equation}
\hat{V}^{(0\rightarrow 1)}=\sum_{pq}\langle p |\hat{v}^{(0)}|q\rangle  a_p^{\dagger} a_q.
\label{eq:zerobody}
\end{equation}
We know that the expectation value of this operator for a given Slater determinant $\Phi_{\alpha}$ is 
\[
\langle \Phi_{\alpha} |\hat{V}^{(0)}|\Phi_{\alpha}\rangle = c_o.
\] 
To obtain this value, it is easy to see that  we need to have 
\[
\langle p |\hat{v}^{(0)}|q\rangle = \frac{1}{A}c_0\delta_{pq}, 
\]
in Eq.~({eq:{eq:zerobody}), meaning that we can rewrite  Eq.~({eq:{eq:zerobody}) as
\[
\hat{V}^{(0)}=\frac{1}{A}c_0 \sum_{pq}  a_p^{\dagger} a_q \delta_{pq}= \frac{c_0}{A}\sum_pa_p^{\dagger} a_p.
\]
We can now transform a one-body operator to a two-body operator 
\[
\hat{V}^{(1\rightarrow 2)}=\frac{1}{4} \sum_{pqrs} \langle pq |{V}^{(1\rightarrow 2)}|rs\rangle   a_p^{\dagger}a_q^{\dagger} a_sa_r,
\]
noting that the matrix element $\langle pq |{V}^{(1)}|rs\rangle$ is anti-symmetrized and consists of a sum of one-body 
terms. We know that the expectation value of a one-body operator is
\[
\langle \Phi_{\alpha} |\hat{V}^{(1)}|\Phi_{\alpha}\rangle = \sum_p\langle p | \hat{v}^{(1)}|p\rangle,
\] 
while the expectation value of the two-body operator 
\[
\hat{V}^{(1\rightarrow 2)}=\frac{1}{4} \sum_{pqrs} \langle pq |{v}^{(1\rightarrow 2)}|rs\rangle   a_p^{\dagger}a_q^{\dagger} a_sa_r,
\]
is 
\[
\langle \Phi_{\alpha} |\hat{V}^{(1\rightarrow 2)}|\Phi_{\alpha}\rangle = \frac{1}{2}\sum_{pq}\langle pq | \hat{v}^{(1\rightarrow 2)}|pq\rangle.
\] 
This means that we need to have 
\[
\langle p | \hat{v}^{(1)}|p\rangle=\sum_{q\ne p}\langle pq | \hat{v}^{(1\rightarrow 2)}|pq\rangle.
\]
implying that the matrix elements are related via 
\[
\langle pq |{V}^{(1\rightarrow 2)}|rs\rangle= \frac{1}{A-1}\left(\delta_{qs}\langle p | \hat{v}^{(1)}|r\rangle+ \delta_{pr}\langle q | \hat{v}^{(1)}|s\rangle.
\]
This expression is important in case of shell-model studies where single-particle energies from experiment are used or optimal single-particle energies from mean-field calculations (add ref to for example paper with Angelo and Alex). 
It is also rather easy to see that if we convert the constant we discussed above into a two-body operator, the matrix
elements are
\[
\langle pq |{V}^{(0\rightarrow 2)}|rs\rangle= \frac{2c_0}{A(A-1)}\delta_{pr}\delta_{qs}.
\]
Before we proceed with similar conversions of constants, one-body operators and two-body operators into a three-body form, let us study some computational aspects first. 

Our Hamiltonian, including the one-body and the two-body operators can now be written in terms of a general two-body operator only, that is
\[
\hat{H}=\frac{1}{4} \sum_{pqrs} \langle pq |\hat{h}|rs\rangle   a_p^{\dagger}a_q^{\dagger} a_sa_r,
\]
with 
\[
\langle pq |\hat{h}|rs\rangle= \frac{1}{A-1}\left(\delta_{qs}\langle p | \hat{h}_0|r\rangle+ \delta_{pr}\langle q | \hat{h}_0|s\rangle+\langle pq |\hat{v}|rs\rangle.
\]
These two-particle matrix elements are fully anti-symmetrized, meaning that in an uncoupled basis we have the following
symmetries
\[
\langle pq |\hat{h}|rs\rangle=-\langle qp |\hat{h}|rs\rangle=-\langle pq |\hat{h}|sr\rangle=\langle qp |\hat{h}|sr\rangle.
\]
\subsection{Three-body operators}

{\bf work out three-body operators and transition from two-body to three-body, give exercises also}

\section{Wick's theorem}

Every treatment of the non-relativistic quantum mechanical many-body problem 
entails calculating matrix elements of operators between state vectors. 
In second quantization this implies the computation of vacuum expectation values of 
creation and annihilation operators. 
The basic method is to use the anticommutation relations to rearrange the product of operators 
into an operator string where the annihilation operators stand to the right 
of the creation operators. All terms with an annihilation operator in the rightmost position results in zero, since they 
by construction act on the reference vacuum state. The final result is that 
every vacuum expectation value of creation and annihilation operators 
can be written as a sum of Kronecker $\delta$-functions. Even though the procedure is straightforward in itself, 
it becomes tedious and time consuming even for expectation values involving only few particles 
and at most a simple two-body operator. In addition, such a procedure can easily be error prone. We 
are therefore seeking a method to calculate vacuum expectation values of products of creation 
and annihilation operators in a simple and systematic way without 
explicitely using the anticommutation relations. Wick's theorem allows us to achieve this.

Wick's theorem is based on two fundamental concepts, 
namely $\textit{normal ordering}$ and $\textit{contraction}$. 
The normal-ordered form of a string of operators $\OP{A}\OP{B}..\OP{X}\OP{Y}$, where the individual terms 
are either a creation or annihilation operator, is defined as
\begin{align}
\label{def: Normal ordering}
\kpr{\OP{A}\OP{B}..\OP{X}\OP{Y}} \equiv (-1)^p\fpr{\text{creation operators}}\cdot\fpr{\text{annihilation operators}},
\end{align}
where $p$ denotes the number of permutations that are needed in order 
to transform the original string into a normal-ordered form. 

A contraction between two arbitrary operators $\OP{A}$ and $\OP{B}$ is defined as  
\begin{align}
\contraction[0.5ex]{}{\OP{A}}{}{\OP{B}}{} 
\OP{A}\OP{B}  \equiv \for{0}{\OP{A}\OP{B}}{0}.
\end{align}

As an example,  the contraction between an annihilation operator and a creation operator is defined as  
\begin{equation}
\contraction{}{\an{\alpha}}{}{\cre{\beta}}
\an{\alpha}\cre{\beta} = \langle 0 |\an{\alpha}\cre{\beta}|0\rangle=\langle 0 |\left(\delta_{\alpha \beta}-\cre{\beta}\an{\alpha}\right)|0\rangle=\delta_{\alpha \beta},
\end{equation}
where the last term on the righthand side  represents the normal-ordered product 
\[
\kpr{\cre{\beta}\an{\alpha}}.
\] 
Thus, we have the contraction
\begin{equation}
\contraction{}{\an{\alpha}}{}{\cre{\beta}}
\an{\alpha}\cre{\beta} = \delta_{\alpha \beta}.
\end{equation}

From the above definition of the contraction, defined using the anti-commutation rules for fermions, it is easy to deduce the 
other contractions between creation and annihilation operators. 
the terms that contribute are reduced even more.  It follows that 
\begin{equation}
\contraction{}{\an{\alpha}}{}{\an{\beta}}
\an{\alpha}\an{\beta} =\contraction{}{\cre{\alpha}}{}{\cre{\beta}}
\cre{\alpha}\cre{\beta}=\contraction{}{\cre{\alpha}}{}{\an{\beta}}
\cre{\alpha}\an{\beta} = 0. 
\end{equation}

\begin{equation}
\contraction{}{A}{B}{C}
\contraction[2ex]{A}{B}{C}{D}ABCD
\end{equation}
It is also possible to contract operators inside a normal ordered products. We define the  
original relative position between two operators in a normal ordered product as $p$, 
the so-called permutation number. This is the number of permutations needed to bring one 
of the two operators next to the other one. A contraction between two operators 
with $p \neq 0$ inside a normal ordered is defined as
\begin{align}
\kpr{\contraction[0.5ex]{}{\OP{A}}{\OP{B}..}{\OP{X}}\OP{A}\OP{B}..\OP{X}\OP{Y}} = \pr{-1}^p \kpr{\contraction[0.5ex]{}{\OP{A}}{}{\OP{X}}\OP{A}\OP{X}..\OP{B}\OP{Y}}.
\end{align}
In the general case with $m$ contractions, the procedure is similar, and the prefactor changes to 
\begin{align}
\pr{-1}^{p_1 + p_2 + .. + p_m}.
\end{align} 

As an example, the normal-ordered product of the following operator is
\[
\kpr{a_1^{\dagger}a_2a_3a_4^{\dagger}a_5a_6^{\dagger}}=(-1)^5a_1^{\dagger}a_4^{\dagger}a_6^{\dagger}a_2a_3a_5.
\]
 Interchanging $a_4^{\dagger}$ and $a_6^{\dagger}$ results in a change of sign, which will 
change the above phase
to $+1$.
Wick's theorem states that every string of creation and annihilation operators 
can be written as a sum of normal-ordered products with all possible ways of contractions,
\begin{align}
\label{def: Wick's theorem}
\OP{A}\OP{B}\OP{C}\OP{D}..\OP{R}\OP{X}\OP{Y}\OP{Z} &= \kpr{\OP{A}\OP{B}\OP{C}\OP{D}..\OP{R}\OP{X}\OP{Y}\OP{Z}}\\
&+ \sum_{\pr{1}} \kpr{ 
\contraction[0.5ex]{}{\OP{A}}{}{\OP{B}} \OP{A}\OP{B}\OP{C}\OP{D}..\OP{R}\OP{X}\OP{Y}\OP{Z}}\\
&+ \sum_{\pr{2}} \kpr{\contraction[0.5ex]{}{\OP{A}}{\OP{B}}{\OP{C}}\contraction[1.0ex]{\OP{A}}{\OP{B}}{\OP{C}}{\OP{D}}\OP{A}\OP{B}\OP{C}\OP{D}..\OP{R}\OP{X}\OP{Y}\OP{Z}}\\
&+ ...\\
&+ \sum_{\fpr{\frac{n}{2}}}\kpr{\contraction[0.5ex]{}{\OP{A}}{\OP{B}}{\OP{C}}\contraction[1.0ex]{\OP{A}}{\OP{B}}{\OP{C}}{\OP{D}} \OP{A}\OP{B}\OP{C}\OP{D}..\contraction[0.5ex]{}{\OP{R}}{\OP{X}}{\OP{Y}}\contraction[1.0ex]{\OP{R}}{\OP{X}}{\OP{Y}}{\OP{Z}}\ \OP{R}\OP{X}\OP{Y}\OP{Z}}.
\end{align}
The symbol $\sum_{\pr{m}}$ represents the sum over all terms with $m$ contractions, while $\fpr{\frac{n}{2}}$ 
means the largest integer that does not exceed $\frac{n}{2}$ where $n$ is the number of creation and annihilation operators. 
When $n$ is even, 
\begin{align}
\label{exp: Wick condition}
\fpr{\frac{n}{2}} = \frac{n}{2},
\end{align}
and the last sum in Eq.~(\ref{def: Wick's theorem}) is over fully contracted terms. When $n$ is odd,
\begin{align}
\fpr{\frac{n}{2}} \neq \frac{n}{2},
\end{align}
and none of the terms in Eq.~(\ref{def: Wick's theorem}) are fully contracted.  

An important extension of Wick's theorem allow us to define contractions between normal-ordered strings of operators. This is the so-called generalized Wick's theorem,
\begin{align}
\label{def: Generalized Wick's theorem}
\kpr{\OP{A}\OP{B}\OP{C}\OP{D}..}\kpr{\OP{R}\OP{X}\OP{Y}\OP{Z}..} &= \kpr{\OP{A}\OP{B}\OP{C}\OP{D}..\OP{R}\OP{X}\OP{Y}\OP{Z}}\\
&+ \sum_{\pr{1}} \kpr{ 
\contraction[0.5ex]{}{\OP{A}}{\OP{B}\OP{C}\OP{D}..}{\OP{R}} \OP{A}\OP{B}\OP{C}\OP{D}..\OP{R}\OP{X}\OP{Y}\OP{Z}}\\
&+ \sum_{\pr{2}} \kpr{\contraction[0.5ex]{}{\OP{A}}{\OP{B}\OP{C}\OP{D}..}{\OP{R}}\contraction[1.0ex]{\OP{A}}{\OP{B}}{\OP{C}\OP{D}..\OP{R}}{\OP{X}}\OP{A}\OP{B}\OP{C}\OP{D}..\OP{R}\OP{X}\OP{Y}\OP{Z}}\\
&+ ...
\end{align}
 
Turning back to the many-body problem, the vacuum expectation value of 
products of creation and annihilation operators can be written, according to 
Wick's theoren in Eq.~(\ref{def: Wick's theorem}), as a sum over normal ordered 
products with all possible numbers and combinations of contractions,
\begin{align}
\for{0}{\OP{A}\OP{B}\OP{C}\OP{D}..\OP{R}\OP{X}\OP{Y}\OP{Z}}{0} &= \for{0}{\kpr{\OP{A}\OP{B}\OP{C}\OP{D}..\OP{R}\OP{X}\OP{Y}\OP{Z}}}{0}\\
&+ \sum_{\pr{1}} \for{0}{\kpr{\contraction[0.5ex]{}{\OP{A}}{}{\OP{B}} \OP{A}\OP{B}\OP{C}\OP{D}..\OP{R}\OP{X}\OP{Y}\OP{Z}}}{0}\\
&+ \sum_{\pr{2}}\for{0}{\kpr{\contraction[0.5ex]{}{\OP{A}}{\OP{B}}{\OP{C}}\contraction[1.0ex]{\OP{A}}{\OP{B}}{\OP{C}}{\OP{D}}\OP{A}\OP{B}\OP{C}\OP{D}..\OP{R}\OP{X}\OP{Y}\OP{Z}}}{0}\\
&+ ... \\
&+ \sum_{\fpr{\frac{n}{2}}} \for{0}{\kpr{\contraction[0.5ex]{}{\OP{A}}{\OP{B}}{\OP{C}}\contraction[1.0ex]{\OP{A}}{\OP{B}}{\OP{C}}{\OP{D}} \OP{A}\OP{B}\OP{C}\OP{D}..\contraction[0.5ex]{}{\OP{R}}{\OP{X}}{\OP{Y}}\contraction[1.0ex]{\OP{R}}{\OP{X}}{\OP{Y}}{\OP{Z}}\ \OP{R}\OP{X}\OP{Y}\OP{Z}}}{0}.
\end{align}
Due to Eq. (\ref{exp: Annihilation operator 1}), all vacuum expectation values of normal ordered products without fully contracted terms are zero. Hence, the only contributions to the expectation value are those terms that $\textit{is}$ fully contracted,
\begin{align}
\for{0}{\OP{A}\OP{B}\OP{C}\OP{D}..\OP{R}\OP{X}\OP{Y}\OP{Z}}{0} &= \sum_{\pr{all}} \for{0}{\kpr{\contraction[0.5ex]{}{\OP{A}}{\OP{B}}{\OP{C}}\contraction[1.0ex]{\OP{A}}{\OP{B}}{\OP{C}}{\OP{D}} \OP{A}\OP{B}\OP{C}\OP{D}..\contraction[0.5ex]{}{\OP{R}}{\OP{X}}{\OP{Y}}\contraction[1.0ex]{\OP{R}}{\OP{X}}{\OP{Y}}{\OP{Z}}\ \OP{R}\OP{X}\OP{Y}\OP{Z}}}{0}\\
&= \sum_{\pr{all}} \contraction[0.5ex]{}{\OP{A}}{\OP{B}}{\OP{C}}\contraction[1.0ex]{\OP{A}}{\OP{B}}{\OP{C}}{\OP{D}} \OP{A}\OP{B}\OP{C}\OP{D}..\contraction[0.5ex]{}{\OP{R}}{\OP{X}}{\OP{Y}}\contraction[1.0ex]{\OP{R}}{\OP{X}}{\OP{Y}}{\OP{Z}}\ \OP{R}\OP{X}\OP{Y}\OP{Z}.
\end{align}
To obtain fully contracted terms, Eq.~(\ref{exp: Wick condition}) must hold. When the number of creation and annihilation operators is odd, the vacuum expectation value can be set to zero at once. When the number is even, the expectation value is simply the sum of terms with all possible combinations of fully contracted terms. 

Let us now prove Wick's theorem. Wick's theorem is shown by induction. We assume it is valid for $n$ operators (it is to show this for two and three operators) and must show that the theorem  also applies
to $n+1$ operators.  In order to achieve this, we need the following lemma
\[
\kpr{\OP{A}\OP{B}\dots\OP{X}\OP{Y}\OP{Z}}\OP{W} = \kpr{\OP{A}\OP{B}\dots\OP{X}\OP{Y}\OP{Z}\OP{W}}+
\sum_{(1)W}{\kpr{{\OP{A}}{}{\OP{B}}\dots \OP{X}\OP{Y}\contraction[0.5ex]{\OP{Z}}{\OP{W}}\ \OP{Z}\OP{W}}}
\]

We see that the normal-ordered part of this equation gives an expectation value equal to zero.
We can thus define the normal product with contractions as follows: First we perform all permutations which are necessary to the bring the contracted operators side by side, thereafter we construct the normal-ordered product of the remaining operators. For both operators we need to include the respective phase factors. 
 
Wick's theorem provides us thus with an algebraic method that allows us to compute the expectation value
of a given operator. As ane example, consider again the  calculation of the expectation value of
\[
	\element{\alpha_1 \alpha_2}{\hat{H}_1}{\beta_1 \beta_2} =
		\frac{1}{2} \sum_{\alpha\beta\gamma, \delta}
			\element{\alpha\beta}{V}{\gamma\delta} \element{0}{a_{\alpha_2} a_{\alpha_1} 
			 a^\dagger_\alpha a^\dagger_\beta a_\delta a_\gamma 
			 a_{\beta_1}^\dagger a_{\beta_2}^\dagger}{0}. 
\]
We implicitely assumed that the two-particle Slater determinants are anti-symmetrized. Using Wick's theorem 
we need only to  compute terms where all pairs of operators are contracted with  each other, all other contributions yield results with at least one annihilation operator acting on the chosen vacuum. These contributions 
give zero expectation values.

Wick's theorem gives  then

\[
\contraction[1.5ex]{}{a}{{}^\dagger_{\alpha} a_{\beta}^\dagger a_{\alpha_2}}{a}
            \contraction{a^\dagger_{\alpha}}{a}{{}^\dagger_{\beta}}{a}
            a_{\alpha_2}  a_{\alpha_1} a^\dagger_{\alpha} a^\dagger_{\beta} 
\contraction{}{a}{{}^\dagger_{\beta_1}} a_{\beta_2}^\dagger}{a}
            \contraction[1.5ex]{a^\dagger_{\beta_1}}{a}{{}^\dagger_{\beta_2} a_{\delta}}{a}
            a_{\delta}  a_{\gamma} a^\dagger_{\beta_1} a^\dagger_{\beta_2} 
\]


\begin{eqnarray}
	\element{\alpha_1 \alpha_2}{\hat{H}_1}{\beta_1 \beta_2}& =
		\frac{1}{2} \sum_{\alpha\beta\gamma, \delta}
			\element{\alpha\beta}{V}{\gamma\delta}\left[ 
            \right]
\end{eqnarray}






In the next section, the particle-hole formalism is presented, which is appropriate formalism in many-body systems.








\section{Particle-hole formalism}\label{sec:basics_ph}

Second quantization is a useful and elegant formalism  for constructing many-body  states and 
quantum mechanical operators. As we will see later, one can express and translate many physical processes
into simple pictures such as Feynman diagrams. Expecation values of many-body states are also easily calculated.
However, although the equations are seemingly easy to set up, from  a practical point of view, that is
the solution of Schr\"odinger's equation, there is no particular gain.
The many-body equation is equally hard to solve, irrespective of representation. 
The cliche that 
there is no free lunch brings us down to earth again.  
Note however that a transformation to a particular
basis, for cases where the interaction obeys specific symmetries, can ease the solution of Schr\"odinger's equation. 
An example you will encounter here is the solution of the two-particle Schr\"odinger equantion in relative and
center-of-mass coordinates. Or the solution of the three-body problem in so-called  Jacobi coordinates. 
 
But there is at least one important case where second quantization comes to our rescue.
It is namely easy to introduce another reference state than the pure vacuum $\ket{0}$, where all single-particle
are active.
With many particles present it is often useful to introduce another reference state  than the vacuum state 
$\ket{0}$. We will label this state $\ket{c}$ ($c$ for core) and as we will see it can reduce 
considerably the complexity and thereby the dimensionality of the many-body problem. It allows us to sum up to infinite order
specific many-body correlations. (add more stuff in the description below)

The particle-hole representation is one of these handy representations. 

\begin{figure}[hbtp]
\caption{States with  $n$, $n+1$ and  $n-1$ particle in the particle representation $a,b,c,\dots$) 
and in the particle-hole representation $i,j,k\dots$ where the $n$-particle state  is the new vacuum statee.}
\label{fig:part-hole}
\end{figure}
The transition from the original particle representation with the true vacuum and the transition to the
particle transformation  is pictured in Fig.~\ref{fig:part-hole}. 
In this figure  a set of single-particle states $\alpha_i$  are filled up with $n-1$, $n$ and $n+1$ particles.
In the original particle representation these states are products of the creation operators  
$a_{\alpha_i}^\dagger$ acting on the true vacuum $\ket{0}$.
Following (\ref{eq:2-2}) we have 
\begin{eqnarray}
	\ket{\alpha_1\alpha_2\hdots\alpha_{n-1}\alpha_n} &=& a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \hdots
					a_{\alpha_{n-1}}^\dagger a_{\alpha_n}^\dagger \ket{0} \label{eq:2-47a} \\
	\ket{\alpha_1\alpha_2\hdots\alpha_{n-1}\alpha_n\alpha_{n+1}} &=&
		a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \hdots a_{\alpha_{n-1}}^\dagger a_{\alpha_n}^\dagger
		a_{\alpha_{n+1}}^\dagger \ket{0} \label{eq:2-47b} \\
	\ket{\alpha_1\alpha_2\hdots\alpha_{n-1}} &=& a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \hdots
		a_{\alpha_{n-1}}^\dagger \ket{0} \label{eq:2-47c}
\end{eqnarray}
If we use Eq.~(\ref{eq:2-47a}) as our new reference state, we can simplify considerably the representation of 
this state
\begin{equation}
	\ket{c} \equiv \ket{\alpha_1\alpha_2\hdots\alpha_{n-1}\alpha_n} =
		a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \hdots a_{\alpha_{n-1}}^\dagger a_{\alpha_n}^\dagger \ket{0} \label{eq:2-48a}
\end{equation}
The new reference states for the $n+1$ and $n-1$ states can then be written as
\begin{eqnarray}
	\ket{\alpha_1\alpha_2\hdots\alpha_{n-1}\alpha_n\alpha_{n+1}} &=& (-1)^n a_{\alpha_{n+1}}^\dagger \ket{c}
		\equiv (-1)^n \ket{\alpha_{n+1}}_c \label{eq:2-48b} \\
	\ket{\alpha_1\alpha_2\hdots\alpha_{n-1}} &=& (-1)^{n-1} a_{\alpha_n} \ket{c} 
		\equiv (-1)^{n-1} \ket{\alpha_{n-1}}_c \label{eq:2-48c} 
\end{eqnarray}
The first state has one additional particle with respect to the new vacuum state
$\ket{c}$  and is normally referred to as a one-particle state or one particle added to the 
many-body reference state. 
The second state has one particle less than the reference vacuum state  $\ket{c}$ and is referred to as
a one-hole state.  A schematic representation of the new states are shown in Fig.~\ref{fig:part-hole}. 

The selection of a given reference vacuum allows us to tailor the
solution of the many-body Schr\"odinger equation to specific nuclei which are
considered as good closed-shell nuclei.  Typical cases are $^4$He, $^{16}$O, $^{40}$Ca, $^{48}$Ca,
$^{56}$Ni, $^{90}$Zr, $^{100}$Sn, $^{132}$Sn and $^{208}$Pb, all characterized by so-called
magic numbers. There are many other candidates for so-called magic nuclei. The search for other magic nuclei
is the topic for large experimental campaigns worldwide.  To understand shell-closures, for both stable and
unstable nuclei is one the big intellectual issues in nuclear physics.  

If we were to choose  $^{16}$O as our new reference states, the single neutron and proton states 
$0s_{1/2}$, $0p_{1/2}$ and $0p_{3/2}$ would be considered as hole states. The hole states delineate the Fermi energy $E_F$ for 
$^{16}$O while all single-particle states above $E_F$ such  as $0d_{5/2}$, $0d_{3/2}$, $1s_{1/2}$ are particle states. 
The hole and particle states for  $^{16}$O  are shown in Fig.~\ref{fig:16ox}.
\begin{figure}[hbtp]
\caption{Proton and neutron single-particle states in $^{16}$O.}
\label{fig:16ox}
\end{figure}
{\bf add more about experimental guidance on ox16, why this is a good model and discuss some of the excited states}.

When dealing with a new reference state it is often convenient to introduce 
new creation and annihilation operators since we have 
from Eq.~(\ref{eq:2-48c})
\begin{equation}
	a_\alpha \ket{c} \neq 0 \label{eq:2-49}
\end{equation}
since  $\alpha$ is contained  in $\ket{c}$, while for the true vacuum we have 
$a_\alpha \ket{0} = 0$ for all $\alpha$.

The new reference state leads to the definition of new creation and annihilation operators
which satisfy the following relations
\begin{eqnarray}
	b_\alpha \ket{c} &=& 0 \label{eq:2-50a} \\
	\{b_\alpha^\dagger , b_\beta^\dagger \} = \{b_\alpha , b_\beta \} &=& 0 \nonumber  \\
	\{b_\alpha^\dagger , b_\beta \} &=& \delta_{\alpha \beta} \label{eq:2-50c}
\end{eqnarray}
We assume also that the new reference state is properly normalized
\begin{equation}
	\braket{c}{c} = 1 \label{eq:2-51}
\end{equation}
The physical interpretation of these new operators is that of so-called quasiparticle states.
This means that a state defined by the addition of one extra particle to a reference state 
$\ket{c}$ may not necesseraly be interpreted as one particle coupled to a core.
Consider the following example from $^{16}$O.  Adding one neutron gives us $^{17}$O.
From experiment (spectroscopic factors, add ref) we see that the ground state, with quantum numbers $J=5/2^+$ can interpreted 
as a neutron in a single-particle with quantum numbers $0d_{5/2}$ coupled to an $^{16}$O core.
Stated differently, the many-body wave function of the ground state of $^{17}$O can be  modelled
as a one-quasiparticle state. 
There are however excited states which cannot be interpreted as a so-called one-quasiparticle state. 
Rather, the many-body wave function contains then complicated excitations of the three-particle-two-hole type etc.
{\bf add more text here with expt data, discuss then also spectroscopic factor to motivate the  physical picture} 

We define now new creation operators that act on a state $\alpha$ creating a new quasiparticle state
\begin{equation}
	b_\alpha^\dagger\ket{c} = \Bigg\{ \begin{array}{ll}
		a_\alpha^\dagger \ket{c} = \ket{\alpha}, & \alpha > F \\
		\\
		a_\alpha \ket{c} = \ket{\alpha^{-1}}, & \alpha \leq F
	\end{array} \label{eq:2-52}
\end{equation}
where $F$ is the Fermi level representing the last  occupied single-particle orbit 
of the new reference state $\ket{c}$. 

The annihilation is the hermitian conjugate of the creation operator
\[
	b_\alpha = (b_\alpha^\dagger)^\dagger,
\]
resulting in
\begin{equation}
	b_\alpha^\dagger = \Bigg\{ \begin{array}{ll}
		a_\alpha^\dagger & \alpha > F \\
		\\
		a_\alpha & \alpha \leq F
	\end{array} \qquad 
	b_\alpha = \Bigg\{ \begin{array}{ll}
		a_\alpha & \alpha > F \\
		\\
		 a_\alpha^\dagger & \alpha \leq F
	\end{array} \label{eq:2-54}
\end{equation}
The action of the annihilation operator $b_\alpha$ 
is to annihilate a particle $\alpha > F$ o
and to create a hole for $\alpha \leq F$.

It is then straightforward to show that
\begin{equation}
	b_\alpha \ket{c} = a_\alpha \ket{c} = 0. \label{eq:2-55a}
\end{equation}
For $\alpha \leq F$ we obtain
\begin{equation}
	b_\alpha \ket{c} = a_\alpha^\dagger \ket{c} = 0. \label{eq:2-55b}
\end{equation}

With the new creation and annihilation operator  we can now construct 
many-body quasiparticle states, with one-particle-one-hole states, two-particle-two-hole
states etc in the same fashion as we previously constructed many-particle states. 
We can write a general particle-hole state as
\begin{equation}
	\ket{\beta_1\beta_2\hdots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \hdots \gamma_{n_h}^{-1}} \equiv
		\underbrace{b_{\beta_1}^\dagger b_{\beta_2}^\dagger \hdots b_{\beta_{n_p}}^\dagger}_{>F}
		\underbrace{b_{\gamma_1}^\dagger b_{\gamma_2}^\dagger \hdots b_{\gamma_{n_h}}^\dagger}_{\leq F} \ket{c}
		\label{eq:2-56}
\end{equation}
We can now rewrite our one-body and two-body operators in terms of the new creation and annihilation operators.
The number operator becomes
\begin{equation}
	\hat{N} = \sum_\alpha a_\alpha^\dagger a_\alpha= 
\sum_{\alpha > F} b_\alpha^\dagger b_\alpha + n_c - \sum_{\alpha \leq F} b_\alpha^\dagger b_\alpha \label{eq:2-57b}
\end{equation}
where $n_c$ is the number of particle in the new vacuum state $\ket{c}$.  
The action of $\hat{N}$ on a many-body state results in 
\begin{equation}
	N \ket{\beta_1\beta_2\hdots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \hdots \gamma_{n_h}^{-1}} = (n_p + n_c - n_h) 
		\ket{\beta_1\beta_2\hdots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \hdots \gamma_{n_h}^{-1}} \label{2-59}
\end{equation}
Here  $n=n_p +n_c - n_h$ is the total number of particles in the quasi-particle state of 
Eq.~(\ref{eq:2-56}). Note that  $\hat{N}$ counts the total number of particles  present 
\begin{equation}
	N_{qp} = \sum_\alpha b_\alpha^\dagger b_\alpha, \label{eq:2-60}
\end{equation}
gives us the number of quasi-particles as can be seen by computing
\begin{equation}
	N_{qp}= \ket{\beta_1\beta_2\hdots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \hdots \gamma_{n_h}^{-1}}
		= (n_p + n_h)\ket{\beta_1\beta_2\hdots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \hdots \gamma_{n_h}^{-1}} \label{eq:2-61}
\end{equation}
where $n_{qp} = n_p + n_h$ is the total number of quasi-particles.

We express the one-body operator $\hat{H}_0$ in terms of the quasi-particle creation and annihilation operators, resulting in
\begin{eqnarray}
	\hat{H}_0 &=& \sum_{\alpha\beta > F} \element{\alpha}{h}{\beta}  b_\alpha^\dagger b_\beta +
		\sum_{\begin{array}{c} \alpha > F \\ \beta \leq F \end{array}} \left[
		\element{\alpha}{h}{\beta} b_\alpha^\dagger b_\beta^\dagger + 
		\element{\beta}{h}{\alpha} b_\beta  b_\alpha \right] \nonumber \\
	&+& \sum_{\alpha \leq F} \element{\alpha}{h}{\alpha} - 
		\sum_{\alpha\beta \leq F} \element{\beta}{h}{\alpha}
		b_\alpha^\dagger b_\beta \label{eq:2-63b}
\end{eqnarray}

The first term  gives contribution only for particle states, while the last one
contributes only for holestates. The second term can create or destroy a set of
quasi-particles and 
the third term is the contribution  from the vacuum state $\ket{c}$.
The physical meaning
of these terms  will be discussed in the next section, where we attempt at a diagrammatic
representation. 

Before we continue with the expressions for the two-body operator, we introduce a nomenclature we will use for the rest of this
text. It is inspired by the notation used in coupled cluster theories.
We reserve the labels $i,j,k,\dots$ for hole states and $a,b,c,\dots$ for states above $F$, viz.~particle states.
This means also that we will skip the constraint $\leq F$ or $> F$ in the summation symbols. 
Our operator $\hat{H}_0$  reads now 
\begin{eqnarray}
	\hat{H}_0 &=& \sum_{ab} \element{a}{h}{b}  b_a^\dagger b_b +
		\sum_{ai} \left[
		\element{a}{h}{i} b_a^\dagger b_i^\dagger + 
		\element{i}{h}{a} b_i  b_a \right] \nonumber \\
	&+& \sum_{i} \element{i}{h}{i} - 
		\sum_{ij} \element{j}{h}{i}
		b_i^\dagger b_j \label{eq:2-63b}
\end{eqnarray} 

The two-particle operator in the particle-hole formalism  is more complicated since we have
to translate four indices $\alpha\beta\gamma\delta$ to the possible combinations of particle and hole
states.  When performing the commutator algebra we can regroup the operator in five different terms
\begin{equation}
	\hat{H}_1 = \hat{H}_1^{(a)} + \hat{H}_1^{(b)} + \hat{H}_1^{(c)} + \hat{H}_1^{(d)} + \hat{H}_1^{(e)} \label{eq:2-65}
\end{equation}
Using anti-symmetrized  matrix elements, 
the term  $\hat{H}_1^{(a)}$ is  
\begin{equation}
	\hat{H}_1^{(a)} = \frac{1}{4}
	\sum_{abcd} \element{ab}{V}{cd} 
		b_a^\dagger b_b^\dagger b_d b_c \label{eq:2-66}
\end{equation}
The next term $\hat{H}_1^{(b)}$  reads
\begin{equation}
	 \hat{H}_1^{(b)} = \frac{1}{4} \sum_{abci}\left(\element{ab}{V}{ci}b_a^\dagger b_b^\dagger b_i^\dagger b_c +\element{ai}{V}{cb}
		b_a^\dagger b_i b_b b_c\right) \label{eq:2-67b}
\end{equation}
This term conserves the number of quasiparticles but creates or removes a 
three-particle-one-hole  state. 
For $\hat{H}_1^{(c)}$  we have
\begin{eqnarray}
	\hat{H}_1^{(c)}& =& \frac{1}{4}
		\sum_{abij}\left(\element{ab}{V}{ij}b_a^\dagger b_b^\dagger b_j^\dagger b_i^\dagger +
		\element{ij}{V}{ab}b_a  b_b b_j b_i \right)+  \nonumber \\
	&&	\frac{1}{2}\sum_{abij}\element{ai}{V}{bj}b_a^\dagger b_j^\dagger b_b b_i + 
		\frac{1}{2}\sum_{abi}\element{ai}{V}{bi}b_a^\dagger b_b. \label{eq:2-68c}
\end{eqnarray}
The first line stands for the creation of a two-particle-two-hole state, while the second line represents
the creation to two one-particle-one-hole pairs
while the last term represents a contribution to the particle single-particle energy
from the hole states, that is an interaction between the particle states and the hole states
within the new vacuum  state.
The fourth term reads
\begin{eqnarray}
	 \hat{H}_1^{(d)}& = &\frac{1}{4} 
	 	\sum_{aijk}\left(\element{ai}{V}{jk}b_a^\dagger b_k^\dagger b_j^\dagger b_i+
\element{ji}{V}{ak}b_k^\dagger b_j b_i b_a\right)+\nonumber \\
&&\frac{1}{4}\sum_{aij}\left(\element{ai}{V}{ji}b_a^\dagger b_j^\dagger+
\element{ji}{V}{ai} - \element{ji}{V}{ia}b_j b_a \right). \label{eq:2-69d} 
\end{eqnarray}
The terms in the first line  stand for the creation of a particle-hole state 
interacting with hole states, we will label this as a two-hole-one-particle contribution. 
The remaining terms are a particle-hole state interacting with the holes in the vacuum state. 
Finally we have 
\begin{equation}
	\hat{H}_1^{(d)} = \frac{1}{4}
		 \sum_{ijkl}
		 \element{kl}{V}{ij}b_i^\dagger b_j^\dagger b_l b_k+
	        \frac{1}{2}\sum_{ijk}\element{ij}{V}{kj}b_k^\dagger b_i
	        +\frac{1}{2}\sum_{ij}\element{ij}{V}{ij}\label{eq:2-70d}
\end{equation}
The first terms represents the 
interaction between two holes while the second stands for the interaction between a hole and the remaining holes in the vacuum state.
It represents a contribution to single-hole energy  to first order.
The last term collects all contributions to the energy of the ground state of a closed-shell system arising
from hole-hole correlations.


When a new reference determinant is introduced, the standard creation
and annihilation operators for particles must be replaced with
corresponding operators for quasi-particles. We will denote those
single-particle states that are part of the occupied space with the
subscript $i$,$j$,$k$,.., and those within the unoccupied (virtual)
space with $a$,$b$,$c$,... 
    \[
        a_p^\dagger\ket{0} = \ket{p}, \quad a_p \ket{q} = \delta_{pq}\ket{0}
    \]
    \[
        \delta_{pq} &= \left\{a_p, a_q^\dagger \right\} \\
        0 = \left\{a_p^\dagger, a_q \right\}= \left\{a_p, a_q \right\} = \left\{a_p^\dagger, a_q^\dagger \right\}
    \]
        \[
            \ket{\Phi_0} = \ket{\alpha_1 \dots \alpha_A}, \quad \alpha_1, \dots, \alpha_A \leq \alpha_F
        \]
    \[
        \left\{a_p^\dagger, a_q \right\}= \delta_{pq}, p, q \leq \alpha_F
\]
\[ 
            \left\{a_p, a_q^\dagger \right\} = \delta_{pq}, p, q > \alpha_F
    \]
        $i,j,\ldots \leq \alpha_F, \quad a,b,\ldots > \alpha_F, \quad p,q, \ldots - \textrm{any}$
    \[
        a_i\ket{\Phi_0} = \ket{\Phi_i} & a_a^\dagger\ket{\Phi_0} &= \ket{\Phi^a} \]
\[
        a_i^\dagger\ket{\Phi_0} = 0 \hspace{0.5cm} a_a\ket{\Phi_0} = 0
    \]
The occupied states are said to be hole
states, while the virtual states are said to be particle states. The
quasi-particle creation operator thus reads
\begin{align}
\label{def: Quasi-particle creation operator}
\crequasi{\alpha} = \begin{cases}
                     \cre{\alpha} &\text{if } \alpha = a,b,c,..\\
		     \an{\alpha} &\text{if } \alpha = i,j,k,..
                    \end{cases},
\end{align}
and the annihilation operator 
\begin{align}
\label{def: Quasi-particle annihilation operator}
\anquasi{\alpha} = \begin{cases}
                    \cre{\alpha} &\text{if } \alpha = i,j,k,..\\
                    \an{\alpha} &\text{if } \alpha = a,b,c,..\\
                   \end{cases}.
\end{align}
For example, when the quasi-particle creation operator acts on the reference state, a particle or hole is created depending on which the subspace of $\alpha$. When $\alpha$ is in the hole subspace, a hole is creatied, and when $\alpha$ is in the particle subspace, a particle is created. The definition of the creation and annihilation operators in Eq. (\ref{def: Quasi-particle creation operator}) and (\ref{def: Quasi-particle annihilation operator}) yields the following anticommutation relations,
\begin{align}
\kpr{\anquasi{\alpha},\anquasi{\beta}} &= 0\\
\kpr{\crequasi{\alpha},\crequasi{\beta}} &= 0\\
\kpr{\crequasi{\alpha},\anquasi{\beta}} &= \delta_{\alpha\beta}.
\end{align}
These expressions are identical to Eq. (\ref{exp: Annihilation operator commutation relation}), (\ref{exp: Creation operator commutation relation}) and (\ref{exp: Creation and annihilation commutation relation}), as expected. 
\begin{figure}
\begin{center}
\scalebox{0.8}{
\begin{tikzpicture}
\draw (1,-1) node[anchor=north] {$\ket{a}$} -- (1,-1);
\draw (0,0) node[anchor=east] {$\alpha_1$} -- (2,0);
\draw (0,1) node[anchor=east] {$\alpha_2$} -- (2,1);
\draw (1,1.5) -- (1,1.6);
\draw (1,1.7) -- (1,1.8);
\draw (1,1.9) -- (1,2);
\draw (1,2.1) -- (1,2.2);
\draw (1,2.3) -- (1,2.4);
\draw (0,3) node[anchor=east] {$\alpha_{N-1}$} -- (2,3);
\draw (0,4) node[anchor=east] {$\alpha_N$}-- (2,4);
\draw (0,5) node[anchor=east] {$\alpha_{N+1}$}-- (2,5);
\draw (0,6) node[anchor=east] {$\alpha_{N+2}$} -- (2,6);
\filldraw [black] (1,0) circle (3pt);
\filldraw [black] (1,1) circle (3pt);
\filldraw [black] (1,3) circle (3pt);
\filldraw [black] (1,4) circle (3pt);

\draw (4,-1) node[anchor=north] {$\ket{b}$} -- (4,-1);
\draw (3,0) -- (5,0);
\draw (3,1) -- (5,1);
\draw (4,1.5) -- (4,1.6);
\draw (4,1.7) -- (4,1.8);
\draw (4,1.9) -- (4,2);
\draw (4,2.1) -- (4,2.2);
\draw (4,2.3) -- (4,2.4);
\draw (3,3) -- (5,3);
\draw (3,4) -- (5,4);
\draw (3,5) -- (5,5);
\draw (3,6) -- (5,6);
\filldraw [black] (4,0) circle (3pt);
\filldraw [black] (4,1) circle (3pt);
\filldraw [black] (4,3) circle (3pt);
\filldraw [black] (4,4) circle (3pt);
\filldraw [black] (4,5) circle (3pt);

\draw (7,-1) node[anchor=north] {$\ket{c}$} -- (7,-1);
\draw (6,0) -- (8,0);
\draw (6,1) -- (8,1);
\draw (7,1.5) -- (7,1.6);
\draw (7,1.7) -- (7,1.8);
\draw (7,1.9) -- (7,2);
\draw (7,2.1) -- (7,2.2);
\draw (7,2.3) -- (7,2.4);
\draw (6,3) -- (8,3);
\draw (6,4) -- (8,4);
\draw (6,5) -- (8,5);
\draw (6,6) -- (8,6);
\filldraw [black] (7,0) circle (3pt);
\filldraw [black] (7,1) circle (3pt);
\filldraw [black] (7,3) circle (3pt);

\draw (10.5,-1) node[anchor=north] {$\ket{a}$} -- (10.5,-1);
\filldraw [gray] (9.5,0) rectangle (11.5,4);
\draw (9.5,0) -- (11.5,0);
\draw (9.5,1) -- (11.5,1);
\draw (10.5,1.5) -- (10.5,1.6);
\draw (10.5,1.7) -- (10.5,1.8);
\draw (10.5,1.9) node[anchor=east] {$\ket{c}\hspace{1cm}$} -- (10.5,2);
\draw (10.5,2.1) -- (10.5,2.2);
\draw (10.5,2.3) -- (10.5,2.4);
\draw (9.5,3)  -- (11.5,3);
\draw (9.5,4)  -- (11.5,4);
\draw (9.5,5) node[anchor=east] {$\alpha_{{N+1}}$} -- (11.5,5);
\draw (9.5,6) node[anchor=east] {$\alpha_{N+2}$} -- (11.5,6);

\draw (13.5,-1) node[anchor=north] {$\ket{b}$} -- (13.5,-1);
\filldraw [gray] (12.5,0) rectangle (14.5,4);
\draw (12.5,0) -- (14.5,0);
\draw (12.5,1) -- (14.5,1);
\draw (13.5,1.5) -- (13.5,1.6);
\draw (13.5,1.7) -- (13.5,1.8);
\draw (13.5,1.9) -- (13.5,2);
\draw (13.5,2.1) -- (13.5,2.2);
\draw (13.5,2.3) -- (13.5,2.4);
\draw (12.5,3) -- (14.5,3);
\draw (12.5,4) -- (14.5,4);
\draw (12.5,5) -- (14.5,5);
\draw (12.5,6) -- (14.5,6);
\filldraw [black] (13.5,5) circle (3pt);

\draw (16.5,-1) node[anchor=north] {$\ket{c}$} -- (16.5,-1);
\filldraw [gray] (15.5,0) rectangle (17.5,4);
\draw (15.5,0) -- (17.5,0);
\draw (15.5,1) -- (17.5,1);
\draw (16.5,1.5) -- (16.5,1.6);
\draw (16.5,1.7) -- (16.5,1.8);
\draw (16.5,1.9) -- (16.5,2);
\draw (16.5,2.1) -- (16.5,2.2);
\draw (16.5,2.3) -- (16.5,2.4);
\draw (15.5,3) -- (17.5,3);
\draw (15.5,4) -- (17.5,4);
\draw (15.5,5) -- (17.5,5);
\draw (15.5,6) -- (17.5,6);
\filldraw [blue] (16.4, 3.9) rectangle (16.6,4.1) ;
\end{tikzpicture}}
\end{center}
\label{fig: Particle-hole figure}
\caption{Particle-Hole.}
\end{figure}

In the same way as we can construct a general slater determinant by letting the ordinary creation operators act on the vacuum state, we are now in a position to construct many-quasiparticle states by letting quasi-particle creation operators act on the reference state $\ket{r}$.
\begin{align}
\ket{ijkl..abcd..}_r \equiv \crequasi{i}\crequasi{j}\crequasi{k}\crequasi{l}..\crequasi{a}\crequasi{b}\crequasi{c}\crequasi{d}..\ket{r}.
\end{align}



\subsection{Normal-ordered Hamiltonian}

        \[
            \hat{F} = \sum_{pq} \element{p}{\hat{f}}{q} a_p^\dagger a_q
        \]
        \[
            \hat{V} = \frac{1}{4} \sum_{pqrs} \element{pq}{\hat{v}}{rs}_{AS} a_p^\dagger a_q^\dagger a_s a_r
            \equiv \frac{1}{4} \sum_{pqrs} \element{pq}{\hat{v}}{rs} a_p^\dagger a_q^\dagger a_s a_r,
        \]
        where we have defined the antisymmetric matrix elements
        \[
            \element{pq}{\hat{v}}{rs}_{AS} = \element{pq}{\hat{v}}{rs} - \element{pq}{\hat{v}}{sr}.
        \]
        \[
            \hat{V_3} = \frac{1}{36} \sum_{pqrstu} \element{pqr}{\hat{v}_3}{stu}_{AS} 
                a_p^\dagger a_q^\dagger a_r^\dagger a_u a_t a_s
            \equiv \frac{1}{36} \sum_{pqrstu} \element{pqr}{\hat{v}_3}{stu}
                a_p^\dagger a_q^\dagger a_r^\dagger a_u a_t a_s
        \]
        where we have defined the antisymmetric matrix elements
        \[
            \element{pqr}{\hat{v}_3}{stu}_{AS} = \element{pqr}{\hat{v}_3}{stu} + \element{pqr}{\hat{v}_3}{tus} + \element{pqr}{\hat{v}_3}{ust}
             - \element{pqr}{\hat{v}_3}{sut} - \element{pqr}{\hat{v}_3}{tsu} - \element{pqr}{\hat{v}_3}{uts}.
        \]
        \[
            \left\{a_a a_b \ldots a_c^\dagger a_d^\dagger\right\} = 
                (-1)^P a_c^\dagger a_d^\dagger \ldots a_a a_b
        \]
    The normal ordered Hamiltonian is given by
    \[
        \hat{H}_N = 
            \frac{1}{36} \sum_{\substack{pqr \\stu}}
                 \element{pqr}{\hat{v}_3}{stu} 
                    \normord{a^\dagger_p a^\dagger_q a^\dagger_r a_u a_t a_s}+ 
            \frac{1}{4} \sum_{pqrs} \bra{pq}\ket{rs} \normord{a^\dagger_p a^\dagger_q a_s  a_r} 
            + \sum_{pq} f_q^p \normord{a^\dagger_p a_q}= \hat{H}_3^N + \hat{V}_N + \hat{F}_N
    \]
    where
\[
        \hat{F}_N = \sum_{pq} f_q^p \normord{a^\dagger_p a_q}
\]
\[
        \hat{V}_N = \frac{1}{4} \sum_{pqrs} \bra{pq}\ket{rs} \normord{a^\dagger_p a^\dagger_q a_s  a_r} 
\]
\[
       \hat{H}_3^N = \frac{1}{36} \sum_{\substack{ pqr \\ stu}}
                     \element{pqr}{\hat{v}_3}{stu} 
                        \normord{a^\dagger_p a^\dagger_q a^\dagger_r a_u a_t a_s}
\]
    The amplitudes are given by
\[
        f_q^p = \element{p}{\hat{h}_0}{q} + \sum_i \element{pi}{\hat{v}}{qi} + \frac{1}{2} \sum_{ij} \element{pij}{\hat{v}_3}{qij}
\]
\[
        \bra{pq}{\hat{v}}\ket{rs} = \element{pq}{\hat{v}}{rs} + \sum_i \element{pqi}{\hat{v}_3}{rsi},
\]
    In relation to the Hamiltonian, $\hat{H}_N$ is given by
    \[
        \hat{H}_N = \hat{H} - E_0,
\]
\[
        E_0 = \element{\Phi_0}{\hat{H}}{\Phi_0}= \sum_i \element{i}{\hat{h}_0}{i}
                + \frac{1}{2} \sum_{ij} \element{ij}{\hat{v}}{ij}
                + \frac{1}{6} \sum_{ijk} \element{ijk}{\hat{v}_3}{ijk},
\]
    where $E_0$ is the energy expectation value between reference states.
    We start with the Hamiltonian
    \[
        \hat{H} = \hat{H}_1 + \hat{H}_2 + \hat{H}_3
    \]
    where
    \begin{subequations}
        \begin{align*}
        \hat{H}_1 &= \sum_{pq} \element{p}{\hat{h}_0}{q} a^\dagger_p a_q \\
        \hat{H}_2 &= \frac{1}{4} \sum_{pqrs} \element{pq}{\hat{v}}{rs} a^\dagger_p a^\dagger_q a_s  a_r \\
        \hat{H}_3 &= \frac{1}{36} \sum_{\substack{
                            pqr \\
                            stu}}
                     \element{pqr}{\hat{v}_3}{stu} a^\dagger_p a^\dagger_q a^\dagger_r a_u a_t a_s
        \end{align*}
    \end{subequations}
    \begin{equation*}
        \hat{H}_1 = \sum_{pq} \element{p}{\hat{h}_0}{q} a^\dagger_p a_q
    \end{equation*}

    \begin{align*}
        a^\dagger_p a_q &= \left\{a^\dagger_p a_q\right\} + \left\{ 
    \contraction{}{a}{{}^{\dagger}_p}{a}
    a^\dagger_p a_q
    \right\} \nn
        &= \left\{a^\dagger_p a_q\right\} + \delta_{pq\in i}
    \end{align*}
    \begin{align*}
        \hat{H}_1 &= \sum_{pq} \element{p}{\hat{h}_0}{q} a^\dagger_p a_q \nn
            &= \sum_{pq} \element{p}{\hat{h}_0}{q} \left\{a^\dagger_p a_q\right\} + 
                \delta_{pq\in i} \sum_{pq} \element{p}{\hat{h}_0}{q} \nn
            &= \sum_{pq} \element{p}{\hat{h}_0}{q} \left\{a^\dagger_p a_q\right\} +
                \sum_i \element{i}{\hat{h}_0}{i}
    \end{align*}
    A onebody part
    \begin{equation*}
            \hat{F}_N \Leftarrow \sum_{pq} \element{p}{\hat{h}_0}{q} \left\{a^\dagger_p a_q\right\}
    \end{equation*}
    and a scalar part
    \begin{equation*}
                E_0 \Leftarrow \sum_i \element{i}{\hat{h}_0}{i}
    \end{equation*}
    \begin{equation*}
        \hat{H}_2 = \frac{1}{4} \sum_{pqrs} \element{pq}{\hat{v}}{rs} a^\dagger_p a^\dagger_q a_s  a_r
    \end{equation*}

\begin{align*}
    a^\dagger_p a^\dagger_q a_s  a_r &= \pause
        \normord{a^\dagger_p a^\dagger_q a_s  a_r} \nn
        & \quad + \normord{
            \contraction{a^\dagger_p}{a}{{}^\dagger_q}{a}
            a^\dagger_p a^\dagger_q a_s  a_r}
        + \normord{
            \contraction{a^\dagger_p}{a}{{}^\dagger_q a_s}{a}
            a^\dagger_p a^\dagger_q a_s  a_r}
        + \normord{
            \contraction{}{a}{{}^\dagger_p a^\dagger_q}{a}
            a^\dagger_p a^\dagger_q a_s  a_r} \nn
        & \quad + \normord{
            \contraction{}{a}{{}^\dagger_p a^\dagger_q a_s}{a}
            a^\dagger_p a^\dagger_q a_s  a_r}
        + \normord{
            \contraction[1.5ex]{}{a}{{}^\dagger_p a_q^\dagger a_s}{a}
            \contraction{a^\dagger_p}{a}{{}^\dagger_q}{a}
            a^\dagger_p a^\dagger_q a_s  a_r}
        + \normord{
            \contraction{}{a}{{}^\dagger_p a_q^\dagger}{a}
            \contraction[1.5ex]{a^\dagger_p}{a}{{}^\dagger_q a_s}{a}
            a^\dagger_p a^\dagger_q a_s  a_r} \nn
    &= \normord{a^\dagger_p a^\dagger_q a_s  a_r} \nn
        & \quad + \delta_{qs\in i} \normord{ a^\dagger_p a_r}
        - \delta_{qr \in i} \normord{a^\dagger_p a_s}
        - \delta_{ps \in i} \normord{a^\dagger_q a_r} \nn
        & \quad + \delta_{pr \in i} \normord{a^\dagger_q a_s} 
        + \delta_{pr \in i} \delta_{qs \in i} - \delta_{ps \in i} \delta_{qr \in i}
\end{align*}
    \begin{align*}
    \hat{H}_2 &= \frac{1}{4} \sum_{pqrs} \element{pq}{\hat{v}}{rs} a^\dagger_p a^\dagger_q a_s  a_r \nn
        &= \frac{1}{4} \sum_{pqrs} \element{pq}{\hat{v}}{rs} \normord{a^\dagger_p a^\dagger_q a_s  a_r} 
        + \quad \frac{1}{4} \sum_{pqrs} \Bigl( 
            \delta_{qs\in i} \element{pq}{\hat{v}}{rs} \normord{ a^\dagger_p a_r} \nn
        & \quad - \delta_{qr \in i} \element{pq}{\hat{v}}{rs} \normord{a^\dagger_p a_s}
            - \delta_{ps \in i}\element{pq}{\hat{v}}{rs} \normord{a^\dagger_q a_r} \nn
        & \quad + \delta_{pr \in i} \element{pq}{\hat{v}}{rs} \normord{a^\dagger_q a_s}
            + \delta_{pr \in i} \delta_{qs \in i}
            - \delta_{ps \in i} \delta_{qr \in i} \Bigr) \nn
    \end{align*}
    \begin{align*}
        &= \frac{1}{4} \sum_{pqrs} \element{pq}{\hat{v}}{rs} \normord{a^\dagger_p a^\dagger_q a_s  a_r} \nn
        & \quad + \frac{1}{4} \sum_{pqi} \Bigl(
            \element{pi}{\hat{v}}{qi} - \element{pi}{\hat{v}}{iq} - \element{ip}{\hat{v}}{qi} + \element{ip}{\hat{v}}{iq}
        \Bigr) \normord{a^\dagger_p a_q} \nn
        & \quad + \frac{1}{4} \sum_{ij} \Bigl( 
            \element{ij}{\hat{v}}{ij}
            - \element{ij}{\hat{v}}{ji}
        \Bigr) \nn
        &= \frac{1}{4} \sum_{pqrs} \element{pq}{\hat{v}}{rs} \normord{a^\dagger_p a^\dagger_q a_s  a_r}
            + \sum_{pqi} \element{pi}{\hat{v}}{qi} \normord{a^\dagger_p a_q} 
            + \frac{1}{2} \sum_{ij} \element{ij}{\hat{v}}{ij}
    \end{align*}

\section{Stability and interpretation of the Hartree-Fock equations}
HF theory is an algorithm for a finding an approximative expression for the ground state of a given
Hamiltonian. The basic ingredients are
\begin{itemize}
\item Define a single-particle basis $\{\psi_{\alpha}\}$ so that
\[ \hat{h}^{\mathrm{HF}}\psi_{\alpha} = \varepsilon_{\alpha}\psi_{\alpha}\]
with \[\hat{h}^{\mathrm{HF}}=\hat{t}+\hat{u}_{\matrhm{ext}}+\hat{u}^{\mathrm{HF}}\]
\item where $\hat{u}^{\mathrm{HF}}$ is a single-particle potential to be determined by the HF algorithm.
\item The HF algorithm means to choose $\hat{u}^{\mathrm{HF}}$ in order to have 
\[ \langle \hat{H} \rangle = E^{\mathrm{HF}}= \langle \Phi_0 | \hat{H}|\Phi_0 \rangle\]
a local minimum with $\Phi_0$ being the SD ansatz for the ground state. 
\item The variational principle ensures that $E^{\mathrm{HF}} \ge \tilde{E}_0$, $\tilde{E}_0$ the exact ground state energy.
\end{itemize}

\subsection{Understanding the Hartree-Fock equations}


\[
|\Phi_0\rangle = \left(\prod_{i=1}^n}\hat{a}_{i}^{\dagger}\right)|0\rangle,
\]
where the $i$ define different single-particle states up to the Fermi level. We have assumed that we have $n$ fermions. 
A given one-particle-one-hole ($1p1h$) state can be written as
\[
|\Phi_i^a\rangle = \hat{a}_{a}^{\dagger}\hat{a}_i|\Phi_0\rangle,
\]
while a $2p2h$ state can be written as
\[
|\Phi_{ij}^{ab}\rangle = \hat{a}_{a}^{\dagger}\hat{a}_{b}^{\dagger}\hat{a}_j\hat{a}_i|\Phi_0\rangle,
\]
and a general $npnh$ state as 
\[
|\Phi_{ijk\dots}^{abc\dots}\rangle = \hat{a}_{a}^{\dagger}\hat{a}_{b}^{\dagger}\hat{a}_{c}^{\dagger}\dots\hat{a}_k\hat{a}_j\hat{a}_i|\Phi_0\rangle.
\]


We can then expand our exact state function for the ground state 
as
\[
|\Psi_0\rangle=C_0|\Phi_0\rangle+\sum_{ai}C_i^a|\Phi_i^a\rangle+\sum_{abij}C_{ij}^{ab}|\Phi_{ij}^{ab}\rangle+\dots
=(C_0+\hat{C})|\Phi_0\rangle,
\]
where we have introduced the so-called correlation operator 
\[
\hat{C}=\sum_{ai}C_i^a\hat{a}_{a}^{\dagger}\hat{a}_i  +\sum_{abij}C_{ij}^{ab}\hat{a}_{a}^{\dagger}\hat{a}_{b}^{\dagger}\hat{a}_j\hat{a}_i+\dots
\]
Since the normalization of $\Psi_0$ is at our disposal and since $C_0$ is by hypothesis non-zero, we may arbitrarily set $C_0=1$ with 
corresponding proportional changes in all other coefficients. Using this so-called intermediate normalization we have
\[
\langle \Psi_0 | \Phi_0 \rangle = \langle \Phi_0 | \Phi_0 \rangle = 1, 
\]
resulting in 
\[
|\Psi_0\rangle=(1+\hat{C})|\Phi_0\rangle.

We rewrite 
\[
|\Psi_0\rangle=C_0|\Phi_0\rangle+\sum_{ai}C_i^a|\Phi_i^a\rangle+\sum_{abij}C_{ij}^{ab}|\Phi_{ij}^{ab}\rangle+\dots,
\]
in a more compact form as 
\[
|\Psi_0\rangle=\sum_{PH}C_H^P\Phi_H^P=\left(\sum_{PH}C_H^P\hat{A}_H^P\right)|\Phi_0\rangle,
\]
where $H$ stands for $0,1,\dots,n$ hole states and $P$ for $0,1,\dots,n$ particle states. 
Our requirement of unit normalization gives
\[
\langle \Psi_0 | \Phi_0 \rangle = \sum_{PH}|C_H^P|^2= 1,
\]
and the energy can be written as 
\[
E= \langle \Psi_0 | \hat{H} |\Phi_0 \rangle= \sum_{PP'HH'}C_H^{*P}\langle \Phi_H^P | \hat{H} |\Phi_{H'}^{P'} \rangle C_{H'}^{P'}.
\]

Normally 
\[
E= \langle \Psi_0 | \hat{H} |\Phi_0 \rangle= \sum_{PP'HH'}C_H^{*P}\langle \Phi_H^P | \hat{H} |\Phi_{H'}^{P'} \rangle C_{H'}^{P'},
\]
is solved by diagonalization setting up the Hamiltonian matrix defined by the basis of all possible Slater determinants. A diagonalization
is equivalent to finding the variational minimum  of 
\[
 \langle \Psi_0 | \hat{H} |\Phi_0 \rangle-\lambda \langle \Psi_0 |\Phi_0 \rangle,
\]
where $\lambda$ is a variational multiplier to be identified with the energy of the system.
The minimization process results in 
\[
\delta\left[ \langle \Psi_0 | \hat{H} |\Phi_0 \rangle-\lambda \langle \Psi_0 |\Phi_0 \rangle\right]=
\sum_{P'H'}\left\{\delta[C_H^{*P}]\langle \Phi_H^P | \hat{H} |\Phi_{H'}^{P'} \rangle C_{H'}^{P'}+
C_H^{*P}\langle \Phi_H^P | \hat{H} |\Phi_{H'}^{P'} \rangle \delta[C_{H'}^{P'}]  .\right
\]
\[
.\left -
\lambda( \delta[C_H^{*P}]C_{H'}^{P'}+C_H^{*P}\delta[C_{H'}^{P'}]\right\} = 0.
\]
Since the coefficients $\delta[C_H^{*P}]$ and $\delta[C_{H'}^{P'}]$ are complex conjugates it is necessary and sufficient to require the quantities that multiply with $\delta[C_H^{*P}]$ to vanish.  


An alternative way to derive the last equation is to start from 
\[
(\hat{H} -E)|\Psi_0\rangle = (\hat{H} -E)\sum_{P'H'}C_{H'}^{P'}|\Phi_{H'}^{P'} \rangle=0, 
\]
and if this equation is successively projected against all $\Phi_H^P$ in the expansion of $\Psi$, then the last equation on the previous slide
results.   As stated previously, one solves this equation normally by diagonalization. If we are able to solve this equation exactly (that is
numerically exactly) in a large Hilbert space (it will be truncated in terms of the number of single-particle states included in the definition
of Slater determinants), it can then serve as a benchmark for other many-body methods which approximate the correlation operator
$\hat{C}$.  

For reasons to come (link with Coupled-Cluster theory and Many-Body perturbation theory), 
we will rewrite Eq.~(\ref{eq:fullci}) as a set of coupled non-linear equations in terms of the unknown coefficients $C_H^P$. 


To see this, we look at $ \langle \Phi_H^P | = \langle \Phi_0 |$ in  Eq.~(\ref{eq:fullci}), that is we multiply with $\langle \Phi_0 |$
from the left in 
\[
(\hat{H} -E)\sum_{P'H'}C_{H'}^{P'}|\Phi_{H'}^{P'} \rangle=0, 
\]
and we assume that we have a two-body operator at most.  Using Slater's rule gives then and equation for the 
correlation energy in terms of $C_i^a$ and $C_{ij}^{ab}$.  We get then
\[
\langle \Phi_0 | \hat{H} -E| \Phi_0\rangle + \sum_{ai}\langle \Phi_0 | \hat{H} -E|\Phi_{i}^{a} \rangle C_{i}^{a}+
\sum_{abij}\langle \Phi_0 | \hat{H} -E|\Phi_{ij}^{ab} \rangle C_{ij}^{ab}=0,
\]
or 
\[
E-E_0 =\Delta E=\sum_{ai}\langle \Phi_0 | \hat{H}|\Phi_{i}^{a} \rangle C_{i}^{a}+
\sum_{abij}\langle \Phi_0 | \hat{H}|\Phi_{ij}^{ab} \rangle C_{ij}^{ab},
\]
where the $E_0$ is the reference energy and $\Delta E$ becomes the correlation energy.
We have already computed the expectation values $\langle \Phi_0 | \hat{H}|\Phi_{i}^{a} $ and $\langle \Phi_0 | \hat{H}|\Phi_{ij}^{ab}\rangle$.

We can rewrite
\[
E-E_0 =\Delta E=\sum_{ai}\langle \Phi_0 | \hat{H}|\Phi_{i}^{a} \rangle C_{i}^{a}+
\sum_{abij}\langle \Phi_0 | \hat{H}|\Phi_{ij}^{ab} \rangle C_{ij}^{ab},
\]
as
\[
\Delta E=\sum_{ai}\langle i| \hat{f}|a \rangle C_{i}^{a}+
\sum_{abij}\langle ij | \hat{v}| ab \rangle C_{ij}^{ab}.
\]
This equation determines the correlation energy but not the coefficients $C$. 
We need more equations. Our next step is to set up
\[
\langle \Phi_i^a | \hat{H} -E| \Phi_0\rangle + \sum_{bj}\langle \Phi_i^a | \hat{H} -E|\Phi_{j}^{b} \rangle C_{j}^{b}+
\sum_{bcjk}\langle \Phi_i^a | \hat{H} -E|\Phi_{jk}^{bc} \rangle C_{jk}^{bc}+
\sum_{bcdjkl}\langle \Phi_i^a | \hat{H} -E|\Phi_{jkl}^{bcd} \rangle C_{jkl}^{bcd}=0,
\]
as this equation will allow us to find an expression for the coefficents $C_i^a$ since we can rewrite this equation as 
\[
\langle i | \hat{f}| a\rangle +\langle \Phi_i^a | \hat{H}|\Phi_{i}^{a} \rangle C_{i}^{a}+ \sum_{bj\ne ai}\langle \Phi_i^a | \hat{H}|\Phi_{j}^{b} \rangle C_{j}^{b}+
\sum_{bcjk}\langle \Phi_i^a | \hat{H}|\Phi_{jk}^{bc} \rangle C_{jk}^{bc}+
\sum_{bcdjkl}\langle \Phi_i^a | \hat{H}|\Phi_{jkl}^{bcd} \rangle C_{jkl}^{bcd}=0.
\]


Let us now compute the Hamiltonian matrix for a system consisting of a
Slater determinant for the ground state $|\Phi_0 \rangle$ and two 1p1h
SDs $|\Phi_i^a \rangle$ and $|\Phi_j^b \rangle$. This can obviously be
generalized to many more 1p1h SDs.  We will show later that we get the
following expectation values
\[ \langle \Phi_0 | \hat{H}|\Phi_0 \rangle = E_0, \]
\[ \langle \Phi_i^a | \hat{H}|\Phi_0 \rangle = \langle a | \hat{f} | i \rangle,\]
\[ \langle \Phi_j^b | \hat{H}|\Phi_0 \rangle = \langle b | \hat{f} | j \rangle,\]
\[\langle \Phi_i^a | \hat{H}|\Phi_j^b \rangle = \langle aj | \hat{v} | ib \rangle,\]
and the diagonal elements
\[ \langle \Phi_i^a | \hat{H}|\Phi_i^a \rangle = E_0+\varepsilon_{a}-\varepsilon_{i}+\langle ai | \hat{v} | ia \rangle,\]
and
\[ \langle \Phi_j^b | \hat{H}|\Phi_j^b \rangle =E_0+\varepsilon_{b}-\varepsilon_{j}+\langle bj | \hat{v} | jb \rangle.\]

We can then set up a Hamiltonian matrix to be diagonalized
\[
 \left( \begin{array}{ccc} E_0 & \langle i | \hat{f} | a \rangle &
   \langle j | \hat{f} | b\rangle\\ \langle a | \hat{f} | i \rangle
   &E_0+\varepsilon_{a}-\varepsilon_{i}+\langle ai | \hat{v} | ia
   \rangle & \langle aj | \hat{v} | ib \rangle \\ \langle b | \hat{f}
   | j \rangle & \langle bi | \hat{v} | ja \rangle
   &E_0+\varepsilon_{b}-\varepsilon_{j}+\langle bj | \hat{v} | jb
   \rangle \\
             \end{array} \right) .
\]
The HF method corresponds to finding a similarity transformation where
the non-diagonal matrix elements
\[\langle i | \hat{f} | a \rangle=0\].   We will link this expectation value with the HF method, meaning that
we want to find
\[\langle i | \hat{h}^{\mathrm{HF}}| a \rangle=0\]


\subsection{Stability of Hartree-Fock equations}


Last week we computed the Hamiltonian matrix for a system consisting of a Slater determinant for the ground state 
$|\Phi_0 \rangle$ and two 1p1h SDs $|\Phi_i^a \rangle$ and $|\Phi_j^b \rangle$. This can obviously be generalized to many more 1p1h SDs.  Using diagrammatic as well as algebraic representations we found the following 
expectation values
\[ \langle \Phi_0 | \hat{H}|\Phi_0 \rangle = E_0, \]
\[ \langle \Phi_i^a | \hat{H}|\Phi_0 \rangle = \langle a | \hat{f} | i \rangle,\]
\[ \langle \Phi_j^b | \hat{H}|\Phi_0 \rangle = \langle b | \hat{f} | j \rangle,\]
\[\langle \Phi_i^a | \hat{H}|\Phi_j^b \rangle = \langle aj | \hat{v} | ib \rangle,\]
and the diagonal elements
\[ \langle \Phi_i^a | \hat{H}|\Phi_i^a \rangle = E_0+\varepsilon_{a}-\varepsilon_{i}+\langle ai | \hat{v} | ia \rangle,\]
and 
\[ \langle \Phi_j^b | \hat{H}|\Phi_j^b \rangle =E_0+\varepsilon_{b}-\varepsilon_{j}+\langle bj | \hat{v} | jb \rangle.\]
We can then set up a Hamiltonian matrix to be diagonalized
\[
 \left( \begin{array}{ccc} 
               E_0  & \langle i | \hat{f} | a \rangle &  \langle j | \hat{f} | b\rangle\\
               \langle a | \hat{f} | i \rangle  &E_0+\varepsilon_{a}-\varepsilon_{i}+\langle ai | \hat{v} | ia \rangle  & \langle aj | \hat{v} | ib \rangle      \\
               \langle b | \hat{f} | j \rangle  & \langle bi | \hat{v} | ja \rangle &E_0+\varepsilon_{b}-\varepsilon_{j}+\langle bj | \hat{v} | jb \rangle         \\
             \end{array} \right) .
\]
The HF method corresponds to finding a similarity transformation where the non-diagonal matrix elements
\[\langle i | \hat{f} | a \rangle=0\].   We will link this expectation value with the HF method, meaning that
we want to find
\[\langle i | \hat{h}^{\mathrm{HF}}| a \rangle=0\]
We wish now to derive the Hartree-Fock equations using our second-quantized formalism and study the stability of the equations. 
Our SD ansatz for the ground state of the system is approximated as
\[   |\Phi_0\rangle = |c\rangle = \cre{i} \cre{j}\dots\cre{l}|0\rangle.\]
We wish to determine $\hat{u}^{HF}$ so that 
$E_0^{HF}= \langle c|\hat{H}| c\rangle$ becomes a local minimum. 


An arbitrary Slater determinant $\ket{c'}$ which is not orthogonal to a determinant
$\ket{c}={\displaystyle\prod_{i=1}^{n}}
a_{\alpha_{i}}^{\dagger}\ket{0}$, can be written as
\[
\ket{c'}=exp\left\{\sum_{a>F}\sum_{i\le F}C_{ai}a_{a}^{\dagger}
a_{i}\right\}\ket{c}
\]

The variational condition for deriving the Hartree-Fock equations guarantees only that the expectation value
$\langle c | \hat{H} | c \rangle$ has an extreme value, not necessarily a minimum. To figure out whether the extreme value we have found  is a minimum, we can use second quantization to analyze our results and find a criterion 
for the above expectation value to a local minimum. We will use Thouless' theorem and show that
\[
\frac{\langle c' |\hat{H} | c'\rangle}{\langle c' |c'\rangle} \ge \langle c |\hat{H} | c\rangle= E_0,
\]
with 
\[
|c'\rangle = |c\rangle + |\delta c\rangle.
\]
Using Thouless' theorem we can write out $|c'\rangle$ as
\[
\ket{c'}=exp\left\{\sum_{a>F}
\sum_{i\le F}\delta C_{ai}a_{a}^{\dagger}
a_{i}\right\}\ket{c}=
\]
\[
\left\{1+\sum_{a>F}\sum_{i\le F}\delta C_{ai}a_{a}^{\dagger}
a_{i}+\frac{1}{2!}\sum_{ab>F}
\sum_{ij\le F}\delta C_{ai}\delta C_{bj}a_{a}^{\dagger}a_{i}a_{b}^{\dagger}a_{j}+\dots\right\}
\]
where the amplitudes $\delta C$ are small.

The norm of $|c'\rangle$ is given by (using the intermediate normalization condition $\langle c' |c\rangle=1$) 
\[
\langle c' | c'\rangle = 1+\sum_{a>F}
\sum_{i\le F}|\delta C_{ai}|^2+O(\delta C_{ai}^3).
\]
The expectation value for the energy is now given by (using the Hartree-Fock condition)
\[
\langle c' |\hat{H} | c'\rangle=\langle c |\hat{H} | c\rangle +
\sum_{ab>F}
\sum_{ij\le F}\delta C_{ai}^*\delta C_{bj}\langle c |a_{i}^{\dagger}a_{a}\hat{H}a_{b}^{\dagger}a_{j}|c\rangle+
\]
\[
\frac{1}{2!}\sum_{ab>F}
\sum_{ij\le F}\delta C_{ai}\delta C_{bj}\langle c |\hat{H}a_{a}^{\dagger}a_{i}a_{b}^{\dagger}a_{j}|c\rangle+\frac{1}{2!}\sum_{ab>F}
\sum_{ij\le F}\delta C_{ai}^*\delta C_{bj}^*\langle c|a_{j}^{\dagger}a_{b}a_{i}^{\dagger}a_{a}\hat{H}|c\rangle
+\dots
\] 
We will skip higher-order terms later.

We have already calculated the second term on the rhs of the previous equation
\[
\bra{c} \left(\normord{a^\dagger_i a_a} \op{H} \normord{a^\dagger_b a_j} \right) \ket{c} =
\]
\[
\sum_{pq} \sum_{ijab}\delta C_{ai}^*\delta C_{bj} \bra{p}\hat{h}_0\ket{q} 
            \bra{c} \left(\normord{a^\dagger_i a_a}\normord{a^\dagger_pa_q} 
             \normord{a^\dagger_b a_j} \right)\ket{c}+ 
\]
\[
\frac{1}{4} \sum_{pqrs} \sum_{ijab}\delta C_{ai}^*\delta C_{bj} \bra{pq}\hat{v}\ket{rs} 
            \bra{c} \left(\normord{a^\dagger_i a_a}\normord{a^\dagger_p a^\dagger_q a_s  a_r} \normord{a^\dagger_b a_j} \right)\ket{c},
\]
resulting in
\[
E_0\sum_{ai}|\delta C_{ai}|^2+\sum_{ai}|\delta C_{ai}|^2(\varepsilon_a-\varepsilon_i)-\sum_{ijab} \bra{aj}\hat{v}\ket{bi}\delta C_{ai}^*\delta C_{bj}.
\]

The third term in the rhs of the last equation can then be written out (where is the reference energy and why do we only consider the two-particle interaction $\hat{V}_N$?)
    \begin{align*}
        & \frac{1}{2!}\bra{c}  \left( \op{V}_N \normord{a^\dagger_a a_i} \normord{a^\dagger_b a_j} \right) \ket{c} = \\
            & \quad \frac{1}{8} \sum_{pqrs} \sum_{ijab}\delta C_{ai}\delta C_{bj} \bra{pq}\hat{v}\ket{rs} 
            \bra{c} \left(\normord{a^\dagger_p a^\dagger_q a_s  a_r} 
            \normord{a^\dagger_a a_i} \normord{a^\dagger_b a_j} \right)\ket{c} \\
        &= \frac{1}{8} \sum_{pqrs} \sum_{ijab} \bra{pq}\hat{v}\ket{rs} \delta C_{ai}\delta C_{bj} \bra{c} \\
        & \quad \Bigl( 
        \left\{
        \contraction{a^\dagger_p a^\dagger_q a_s}{a}{{}_r}{a}
        \contraction[1.25ex]{a^\dagger_p}{a}{{}^\dagger_q a_s a_r a^\dagger_a}{a}
        \contraction[1.5ex]{a^\dagger_p a^\dagger_q }{a}{{}_s a_r a^\dagger_a a_i}{a}
        \contraction[1.75ex]{}{a}{{}^\dagger_p a^\dagger_q a_s a_r a^\dagger_a a_i a^\dagger_b}{a}
        a^\dagger_p a^\dagger_q a_s  a_r a^\dagger_a a_i a^\dagger_b a_j \right\}
        +\left\{
        \contraction{a^\dagger_p a^\dagger_q}{a}{{}_s a_r}{a}
        \contraction[1.25ex]{a^\dagger_p}{a}{{}^\dagger_q a_s a_r a^\dagger_a}{a}
        \contraction[1.5ex]{a^\dagger_p a^\dagger_q a_s}{a}{{}_r a^\dagger_a a_i}{a}
        \contraction[1.75ex]{}{a}{{}^\dagger_p a^\dagger_q a_s a_r a^\dagger_a a_i a^\dagger_b}{a}
        a^\dagger_p a^\dagger_q a_s  a_r a^\dagger_a a_i a^\dagger_b a_j \right\}
        + \left\{
        \contraction{a^\dagger_p a^\dagger_q a_s}{a}{{}_r}{a}
        \contraction[1.25ex]{}{a}{{}^\dagger_p q^\dagger_q a_s a_r a^\dagger_a}{a}
        \contraction[1.5ex]{a^\dagger_p a^\dagger_q }{a}{{}_s a_r a^\dagger_a a_i}{a}
        \contraction[1.75ex]{a^\dagger_p}{a}{{}^\dagger_q a_s a_r a^\dagger_a a_i a^\dagger_b}{a}
        a^\dagger_p a^\dagger_q a_s  a_r a^\dagger_a a_i a^\dagger_b a_j \right\} \\
        & \quad +\left\{
        \contraction{a^\dagger_p a^\dagger_q}{a}{{}_s a_r}{a}
        \contraction[1.25ex]{}{a}{{}^\dagger_p q^\dagger_q a_s a_r a^\dagger_a}{a}
        \contraction[1.5ex]{a^\dagger_p a^\dagger_q a_s}{a}{{}_r a^\dagger_a a_i}{a}
        \contraction[1.75ex]{a^\dagger_p}{a}{{}^\dagger_q a_s a_r a^\dagger_a a_i a^\dagger_b}{a}
        a^\dagger_p a^\dagger_q a_s  a_r a^\dagger_a a_i a^\dagger_b a_j \right\}
        \Bigr) \ket{c} \\
        &= \frac{1}{2} \sum_{ijab} \bra{ij}\hat{v}\ket{ab}\delta C_{ai}\delta C_{bj}
    \end{align*}
The final term in the rhs of the last equation can then be written out as
    \[
\frac{1}{2!}\bra{c}\left(\normord{a^\dagger_j a_b} \normord{a^\dagger_i a_a} \op{V}_N  \right) \ket{c} = 
\frac{1}{2!}\bra{c}\left( \op{V}_N \normord{a^\dagger_a a_i} \normord{a^\dagger_b a_j} \right)^{\dagger} \ket{c}
\]
which is nothing but
\[
\frac{1}{2!}\bra{c}  \left( \op{V}_N \normord{a^\dagger_a a_i} \normord{a^\dagger_b a_j} \right) \ket{c}^*
=\frac{1}{2} \sum_{ijab} (\bra{ij}\hat{v}\ket{ab})^*\delta C_{ai}^*\delta C_{bj}^*
\]
or 
\[
\frac{1}{2} \sum_{ijab} (\bra{ab}\hat{v}\ket{ij})\delta C_{ai}^*\delta C_{bj}^*
\]
where we have used the relation
\[ \langle a |\hat{A} | b\rangle =  (\langle b |\hat{A}^{\dagger} | a\rangle)^*
\]
due to the hermiticity of $\hat{H}$ and $\hat{V}$.
We define two matrix elements
\[
A_{ai,bj}=-\bra{aj}\hat{v}\ket{bi}
\]
\[
B_{ai,bj}=\bra{ab}\hat{v}\ket{ij}
\]
both being anti-symmetrized.
We can then write out the energy
\[
\langle c'|H|c'\rangle = \left(1+\sum_{ai}|\delta C_{ai}|^2\right)\langle c |H|c\rangle+
\]
\[
\sum_{ai}|\delta C_{ai}|^2(\varepsilon_a^{HF}-\varepsilon_i^{HF})+\sum_{ijab}A_{ai,bj}\delta C_{ai}^*\delta C_{bj}+
\]
\[
\frac{1}{2} \sum_{ijab} B_{ai,bj}^*\delta C_{ai}\delta C_{bj}+\frac{1}{2} \sum_{ijab} B_{ai,bj}\delta C_{ai}^*\delta C_{bj}^*
+O(\delta C_{ai}^3),\]
which allows us to rewrite it as 
\[
\langle c'|H|c'\rangle = \left(1+\sum_{ai}|\delta C_{ai}|^2\right)\langle c |H|c\rangle+\Delta E+O(\delta C_{ai}^3),
\]
and skipping higher-order terms we have
\[
\frac{\langle c' |\hat{H} | c'\rangle}{\langle c' |c'\rangle} =E_0+\frac{\Delta E}{\left(1+\sum_{ai}|\delta C_{ai}|^2\right)}.
\]

We have defined 
\[
\Delta E = \frac{1}{2} \langle \chi | \hat{M}| \chi \rangle
\]
with the vectors 
\[ \chi = \left[ \delta C\hspace{0.2cm} \delta C^*\right]^T
\]
and the matrix 
\[
\hat{M}=\left(\begin{array}{cc} \Delta + A & B \\ B^* & \Delta + A^*\end{array}\right),
\]
with $\Delta_{ai,bj} = (\varepsilon_a-\varepsilon_i)\delta_{ab}\delta_{ij}$.
The condition
\[
\Delta E = \frac{1}{2} \langle \chi | \hat{M}| \chi \rangle \ge 0
\]
for an arbitrary  vector 
\[ \chi = \left[ \delta C\hspace{0.2cm} \delta C^*\right]^T\]
means that all eigenvalues of the matrix have to be larger than or equal zero. 
A necessary (but no sufficient) condition is that the matrix elements (for all $ai$ )
\[
(\varepsilon_a-\varepsilon_i)\delta_{ab}\delta_{ij}+A_{ai,bj} \ge 0.
\]
This equation can be used as a first test of the stability of the Hartree-Fock equation.




\section{Diagrams}
Although Wick's theorem adds considerable simplifications to the calculation of various expectation values, the human brain is, sadly, not well suited for finding complicated combinations of
contractions using Wick's theorem.
As an example, we present a string of operators
arising from the evaluation of the transition probability from a 1p-1h excitation
to another 1p-1h excitation for the two-body potential, 
\begin{equation}
\label{eq:manybody:example}
\langle \Phi_i^a | \hat{V} | \Phi_j^b \rangle
\rightarrow
\hat{i}^{\dagger} \hat{a} \hspace{2mm} \hat{p}^{\dagger} \hat{q}^{\dagger}
\hat{s} \hat{r} \hspace{2mm} \hat{b}^{\dagger} \hat{j} .
\end{equation}
Although this expression only contains eight operators, it leads to fourteen nonzero,
fully contracted, terms.
One needs to be focused and systematic in order to calculate all terms correctly.
However, the brain seems to be good at visualizing mental images, and therefore a
graphical presentation of the formulas could serve us well.


The graphical approach presented here originated in quantum field theory,
developed by Richard Feynman~\cite{RevModPhys.20.367,PhysRev.76.769}.
Although originally meant to be used on time dependent transitions from one
state to another, it is presented here without a time ordering (following~\cite{shavitt2009many}).
It does, however, restrict the order in which operators are applied.

Diagrams start out with the reference ket state, denoted by two horizontal lines at
the bottom, and end out with the reference bra state, as two horizontal lines
at the top. 
Particle operators are lines pointing upwards, whereas holes point downwards.
In this fashion, determinants with excitations from the reference state can be visualized as
\begin{eqnarray}
\langle \Phi_i^a | = \langle \Phi | \hat{i}^{\dagger}\hat{a} =& 
\parbox{30mm}{
    \textrm{
    \begin{fmffile}{fmf-oneponehbra}
        \begin{fmfgraph*}(50,50)
            \fmfbottom{i1,i2} \fmftop{o1,o2}
            \fmf{phantom}{i1,hb,pb,i2}
            \fmf{double}{o1,ht,pt,o2}
            \fmffreeze
            \fmf{electron,label=$i$}{ht,hb}
            \fmf{electron,label=$a$}{pb,pt}
        \end{fmfgraph*}
    \end{fmffile}
    }
} \\
|\Phi_{ij}^{ab} \rangle = \hat{a}^{\dagger}\hat{b}^{\dagger}\hat{j}\hat{i}|\Phi \rangle =& 
\parbox{40mm}{
    \textrm{
    \begin{fmffile}{fmf-twoptwohket}
        \begin{fmfgraph*}(100,50)
            \fmfbottom{i1,i2} \fmftop{o1,o2}
            \fmf{double}{i1,h1b,p1b,dummyb,h2b,p2b,i2}
            \fmf{phantom}{o1,h1t,p1t,dummyt,h2t,p2t,o2}
            \fmffreeze
            \fmf{electron,label=$i$}{h1t,h1b}
            \fmf{electron,label=$a$}{p1b,p1t}
            \fmf{electron,label=$j$}{h2t,h2b}
            \fmf{electron,label=$b$}{p2b,p2t}
        \end{fmfgraph*}
    \end{fmffile}
    }
} .
\end{eqnarray}


One-body operators are presented as two electron lines connected to a dashed line with a cross,
\begin{equation}
\hat{H^{(0)}} = \sum_{pq} \langle p | \hat{h^{(0)}} | \hat{q} \rangle \hat{p}^{\dagger}\hat{q} =
\parbox{30mm}{
	\textrm{
	\begin{fmffile}{fmf-onebodyoperator}
		\begin{fmfgraph*}(50,50)
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			\fmf{electron,label=$q$}{i1,f1}
			\fmf{electron,label=$p$}{f1,o1}
			\fmf{dashes}{f1,f2}
			\fmfv{decor.shape=cross}{f2}
			\fmf{phantom}{i2,f2}
			\fmf{phantom}{f2,o2}
		\end{fmfgraph*}
	\end{fmffile}
	}
}
\end{equation}
Two-body operators are represented similarly, but have two incoming and two outgoing lines due to the two-body nature,
\begin{equation}
\hat{H}^{(1)} = \frac{1}{4}\sum_{pqrs} \langle pq | | rs \rangle \hat{p}^{\dagger}\hat{q}^{\dagger} \hat{s} \hat{r} =
\parbox{30mm}{
	\textrm{
	\begin{fmffile}{fmf-twobodyoperator}
		\begin{fmfgraph*}(50,50)
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			\fmf{electron,label=$r$}{i1,f1}
			\fmf{electron,label=$p$}{f1,o1}
			\fmf{dashes}{f1,f2}
			\fmf{electron,label=$s$}{i2,f2}
			\fmf{electron,label=$q$}{f2,o2}
		\end{fmfgraph*}
	\end{fmffile}
	}
} .
\end{equation}


The idea now is to represent contractions by connecting lines, and because only fully contracted terms are nonzero within the reference state, all lines should be connected.
All \textit{free} indexes are meant to be summed over, and the matrix elements are found by replacing $q$ with the label of incoming line and $p$ with the outgoing label in the one-body case.
In the two-body case we replace $r/s$ with left/right incoming line and $p/q$ with left/right outgoing line.
To determine the correct phase factor, one needs to count the number of hole lines and the number of closed paths.
When counting the number of closed paths we will consider associated particle-hole pairs as if they were connected in the reference states.
The phase factor will in the end be $(-1)^{l + h}$, where $l$ is the number of closed paths (loops) and $h$ is the number of hole lines.


To illustrate the use of diagrams, we return to the example in the introduction, eq.~\eqref{eq:manybody:example}.
This expression is evaluated to four unique ways of connecting the diagrams;

\begin{equation}
\label{eq:manybody:iavbjDiag}
\begin{split}
\langle \Phi_i^a | \hat{V} | \Phi_j^b \rangle
&= 
\overbrace{
\parbox{35mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term1}
		\begin{fmfgraph*}(80,80) \fmfkeep{fmf-example-term1}
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,dummy1,b2,i2}
			\fmf{double}{o1,t1,dummy2,t2,o2}
			\fmffreeze
			%Operator line
			\fmf{dashes}{g1,g2}
			%Electrons		
			\fmf{electron,label=$j$}{g1,b1}
			\fmf{electron,label=$b$}{b2,g2}
			\fmf{electron,label=$i$}{t1,g1}
			\fmf{electron,label=$a$}{g2,t2}
		\end{fmfgraph*}
	\end{fmffile}
	}
}
}^{(a)}
+
\overbrace{
\parbox{35mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term2}
		\begin{fmfgraph*}(80,80) \fmfkeep{fmf-example-term2}
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,dummy1,b2,i2}
			\fmf{double}{o1,t1,dummy2,t2,o2}
			\fmffreeze
			%Operator line
			\fmf{dashes}{g1,g2}
			\fmf{phantom}{b1,loop}
			\fmf{phantom}{t1,loop}
			%Electrons		
			\fmf{electron,label=$b$}{b2,g2}
			\fmf{electron,label=$a$}{g2,t2}
			\fmf{electron,label=$i$}{t1,holeconnect}
			\fmf{electron,label=$j$}{holeconnect,b1}
			%Electron hole loop
			\fmf{electron,right,tension=0.3,label=$k$}{g1,loop}
			\fmf{electron,right,tension=0.3}{loop,g1}
		\end{fmfgraph*}
	\end{fmffile}
	}
}
}^{(b)} \\
&+
\underbrace{
\parbox{35mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term3}
		\begin{fmfgraph*}(80,80) \fmfkeep{fmf-example-term3}
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,dummy1,b2,i2}
			\fmf{double}{o1,t1,dummy2,t2,o2}
			\fmffreeze
			%Operator line
			\fmf{dashes}{g1,g2}
			\fmf{phantom}{b2,loop}
			\fmf{phantom}{t2,loop}
			%Electrons		
			\fmf{electron,label=$b$}{b2,partconnect}
			\fmf{electron,label=$a$}{partconnect,t2}
			\fmf{electron,label=$i$}{t1,g1}
			\fmf{electron,label=$j$}{g1,b1}
			%Electron hole loop
			\fmf{electron,left,tension=0.3}{g2,loop}
			\fmf{electron,left,tension=0.3,label=$k$}{loop,g2}
		\end{fmfgraph*}
	\end{fmffile}
	}
}
}_{(c)}
+
\underbrace{
\parbox{35mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term4}
		\begin{fmfgraph*}(80,80) \fmfkeep{fmf-example-term4}
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,b2,b3,b4,b5,i2}
			\fmf{double}{o1,t1,t2,t3,t4,t5,o2}
			\fmffreeze
			%Connecting points for hole loops
			\fmf{phantom}{b3,loop1,t3}
			\fmf{phantom}{i2,loop2,o2}
			\fmffreeze
			%Operator
			\fmf{dashes}{g1,g2}
			%Hole loops
			\fmf{electron,right,label=$k$,tension=0.3}{g1,loop1}
			\fmf{electron,right,tension=0.3}{loop1,g1}
			\fmf{electron,left,label=$l$,tension=0.3}{g2,loop2}
			\fmf{electron,left,tension=0.3}{loop2,g2}
			%Electronlines
			\fmf{electron,label=$i$}{t1,holeconnect}
			\fmf{electron,label=$j$}{holeconnect,b1}
			\fmf{electron,label=$b$}{b2,partconnect}
			\fmf{electron,label=$a$}{partconnect,t2}
		\end{fmfgraph*}
	\end{fmffile}
	}
} 
}_{(d)}
.
\end{split}
\end{equation}
\begin{enumerate}[{\bf Term (\ref{eq:manybody:iavbjDiag}a)}]
\item has no free indexes since all lines are connected to the particle and hole indices already defined in the reference states.
The corresponding matrix element is $\langle ja || ib \rangle$.
Having two hole lines, one closed loop, and in total four equal terms, 
\begin{equation}
\parbox{23mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term1-1}
		\begin{fmfgraph*}(50,50)
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,dummy1,b2,i2}
			\fmf{double}{o1,t1,dummy2,t2,o2}
			\fmffreeze
			%Operator line
			\fmf{dashes}{g1,g2}
			%Electrons		
			\fmf{electron}{g1,b1}
			\fmf{electron}{b2,g2}
			\fmf{electron}{t1,g1}
			\fmf{electron}{g2,t2}
		\end{fmfgraph*}
	\end{fmffile}
	}
}
=
\parbox{23mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term1-2}
		\begin{fmfgraph*}(50,50) \fmfkeep{fmf-example-term1-2}
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,dummy1,b2,i2}
			\fmf{double}{o1,t1,dummy2,t2,o2}
			\fmffreeze
			%Operator line
			\fmf{dashes}{g1,g2}
			\fmf{phantom}{g1,b1}
			\fmf{phantom}{b2,g2}
			\fmf{phantom}{t1,g1}
			\fmf{phantom}{g2,t2}			
			\fmffreeze
			%Electrons		
			\fmf{electron}{g2,b1}
			\fmf{electron}{b2,g1}
			\fmf{electron}{t1,g2}
			\fmf{electron}{g1,t2}
		\end{fmfgraph*}
	\end{fmffile}
	}
}
=
\parbox{23mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term1-3}
		\begin{fmfgraph*}(50,50) \fmfkeep{fmf-example-term1-3}
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,dummy1,b2,i2}
			\fmf{double}{o1,t1,dummy2,t2,o2}
			\fmffreeze
			%Operator line
			\fmf{dashes}{g1,g2}
			\fmf{phantom}{g1,b1}
			\fmf{phantom}{b2,g2}
			\fmf{phantom}{t1,g1}
			\fmf{phantom}{g2,t2}			
			\fmffreeze
			%Electrons		
			\fmf{electron}{g1,b1}
			\fmf{electron}{b2,g1}
			\fmf{electron}{t1,g2}
			\fmf{electron}{g2,t2}
		\end{fmfgraph*}
	\end{fmffile}
	}
}
=
\parbox{23mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term1-4}
		\begin{fmfgraph*}(50,50) \fmfkeep{fmf-example-term1-4}
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,dummy1,b2,i2}
			\fmf{double}{o1,t1,dummy2,t2,o2}
			\fmffreeze
			%Operator line
			\fmf{dashes}{g1,g2}
			\fmf{phantom}{g1,b1}
			\fmf{phantom}{b2,g2}
			\fmf{phantom}{t1,g1}
			\fmf{phantom}{g2,t2}			
			\fmffreeze
			%Electrons		
			\fmf{electron}{g2,b1}
			\fmf{electron}{b2,g2}
			\fmf{electron}{t1,g1}
			\fmf{electron}{g1,t2}
		\end{fmfgraph*}
	\end{fmffile}
	}
} ,
\end{equation}
the total factor in front should be $(-1)^{2+1} \cdot 4 \cdot \frac{1}{4} = -1$.
\item corresponds to the element $\delta_{ij} \langle ka || kb \rangle$, where the Kronecker delta function follows from the contracted hole lines between $i$ and $j$.
There are two hole lines, two loops, and in total four equal terms,
\begin{equation}
\parbox{23mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term2-1}
		\begin{fmfgraph*}(50,50)
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,dummy1,b2,i2}
			\fmf{double}{o1,t1,dummy2,t2,o2}
			\fmffreeze
			%Operator line
			\fmf{dashes}{g1,g2}
			\fmf{phantom}{b1,loop}
			\fmf{phantom}{t1,loop}
			%Electrons		
			\fmf{electron}{b2,g2}
			\fmf{electron}{g2,t2}
			\fmf{electron}{t1,holeconnect}
			\fmf{electron}{holeconnect,b1}
			%Electron hole loop
			\fmf{electron,right,tension=0.3}{g1,loop}
			\fmf{electron,right,tension=0.3}{loop,g1}
		\end{fmfgraph*}
	\end{fmffile}
	}
}
=
\parbox{23mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term2-2}
		\begin{fmfgraph*}(50,50)
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,dummy1,b2,i2}
			\fmf{double}{o1,t1,dummy2,t2,o2}
			\fmffreeze
			%Operator line
			\fmf{dashes}{g1,g2}
			\fmf{phantom}{b1,g1}
			\fmf{phantom}{t1,g1}
			\fmf{phantom}{g2,loop}
			\fmf{phantom}{i2,loop,o2}
			\fmffreeze
			%Electrons		
			\fmf{electron}{b2,g1}
			\fmf{electron}{g1,t2}
			\fmf{electron}{t1,holeconnect}
			\fmf{electron}{holeconnect,b1}
			%Electron hole loop
			\fmf{electron,right,tension=0.3}{g2,loop}
			\fmf{electron,right,tension=0.3}{loop,g2}
		\end{fmfgraph*}
	\end{fmffile}
	}
}
=
\parbox{23mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term2-3}
		\begin{fmfgraph*}(50,50)
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,dummy1,b2,i2}
			\fmf{double}{o1,t1,dummy2,t2,o2}
			\fmffreeze
			%Operator line
			\fmf{dashes}{g1,gmiddle,g2}
			\fmf{phantom}{b1,g1}
			\fmf{phantom}{t1,g1}
			\fmf{phantom}{i2,g2,o2}
			\fmffreeze
			%Electrons		
			\fmf{electron}{b2,g2}
			\fmf{electron}{g1,t2}
			\fmf{electron}{t1,holeconnect}
			\fmf{electron}{holeconnect,b1}
			%Electron hole loop
			\fmf{electron,right,tension=0.5}{g2,gmiddle}
			\fmf{electron,left,tension=0.5}{gmiddle,g1}
		\end{fmfgraph*}
	\end{fmffile}
	}
}
=
\parbox{23mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term2-4}
		\begin{fmfgraph*}(50,50)
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,dummy1,b2,i2}
			\fmf{double}{o1,t1,dummy2,t2,o2}
			\fmffreeze
			%Operator line
			\fmf{dashes}{g1,gmiddle,g2}
			\fmf{phantom}{b1,g1}
			\fmf{phantom}{t1,g1}
			\fmf{phantom}{i2,g2,o2}
			\fmffreeze
			%Electrons		
			\fmf{electron}{b2,g1}
			\fmf{electron}{g2,t2}
			\fmf{electron}{t1,holeconnect}
			\fmf{electron}{holeconnect,b1}
			%Electron hole loop
			\fmf{electron,left,tension=0.5}{g1,gmiddle}
			\fmf{electron,right,tension=0.5}{gmiddle,g2}
		\end{fmfgraph*}
	\end{fmffile}
	}
} .
\end{equation}
\item is similar to (\ref{eq:manybody:iavbjDiag}b), except how the Kronecker delta connects the particle lines $a$ and $b$ instead. There are now three hole lines, two loops and four  equal terms;
\begin{equation}
\parbox{23mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term3-1}
		\begin{fmfgraph*}(50,50)
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,dummy1,b2,i2}
			\fmf{double}{o1,t1,dummy2,t2,o2}
			\fmffreeze
			%Operator line
			\fmf{dashes}{g1,g2}
			\fmf{phantom}{b2,loop}
			\fmf{phantom}{t2,loop}
			%Electrons		
			\fmf{electron}{b2,partconnect}
			\fmf{electron}{partconnect,t2}
			\fmf{electron}{t1,g1}
			\fmf{electron}{g1,b1}
			%Electron hole loop
			\fmf{electron,left,tension=0.3}{g2,loop}
			\fmf{electron,left,tension=0.3}{loop,g2}
		\end{fmfgraph*}
	\end{fmffile}
	}
}
=
\parbox{23mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term3-2}
		\begin{fmfgraph*}(50,50)
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,dummy1,b2,i2}
			\fmf{double}{o1,t1,dummy2,t2,o2}
			\fmffreeze
			%Operator line
			\fmf{dashes}{g1,g2}
			\fmf{phantom}{b2,g2}
			\fmf{phantom}{t2,g2}
			\fmf{phantom}{g1,loop}
			\fmf{phantom}{i1,loop,o1}
			\fmffreeze
			%Electrons		
			\fmf{electron}{b2,partconnect}
			\fmf{electron}{partconnect,t2}
			\fmf{electron}{t1,g2}
			\fmf{electron}{g2,b1}
			%Electron hole loop
			\fmf{electron,left,tension=0.3}{g1,loop}
			\fmf{electron,left,tension=0.3}{loop,g1}			
		\end{fmfgraph*}
	\end{fmffile}
	}
}
=
\parbox{23mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term3-3}
		\begin{fmfgraph*}(50,50)
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,dummy1,b2,i2}
			\fmf{double}{o1,t1,dummy2,t2,o2}
			\fmffreeze
			%Operator line
			\fmf{dashes}{g1,gmiddle,g2}
			\fmf{phantom}{i1,g1,o1}
			\fmf{phantom}{b2,g2,t2}
			\fmffreeze
			%Electrons		
			\fmf{electron}{b2,partconnect}
			\fmf{electron}{partconnect,t2}
			\fmf{electron}{t1,g2}
			\fmf{electron}{g1,b1}
			%Electron hole loop
			\fmf{electron,left,tension=0.5}{g2,gmiddle}
			\fmf{electron,right,tension=0.5}{gmiddle,g1}			
		\end{fmfgraph*}
	\end{fmffile}
	}
}
=
\parbox{23mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term3-4}
		\begin{fmfgraph*}(50,50)
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,dummy1,b2,i2}
			\fmf{double}{o1,t1,dummy2,t2,o2}
			\fmffreeze
			%Operator line
			\fmf{dashes}{g1,gmiddle,g2}
			\fmf{phantom}{i1,g1,o1}
			\fmf{phantom}{b2,g2,t2}
			\fmffreeze
			%Electrons		
			\fmf{electron}{b2,partconnect}
			\fmf{electron}{partconnect,t2}
			\fmf{electron}{t1,g1}
			\fmf{electron}{g2,b1}
			%Electron hole loop
			\fmf{electron,right,tension=0.5}{g1,gmiddle}
			\fmf{electron,left,tension=0.5}{gmiddle,g2}			
		\end{fmfgraph*}
	\end{fmffile}
	}
} .
\end{equation}
\item has three hole lines, three loops, but only two equal diagrams can be created, namely
\begin{equation}
\parbox{23mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term4-1}
		\begin{fmfgraph*}(50,50) 
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,b2,b3,b4,b5,i2}
			\fmf{double}{o1,t1,t2,t3,t4,t5,o2}
			\fmffreeze
			%Connecting points for hole loops
			\fmf{phantom}{b3,loop1,t3}
			\fmf{phantom}{i2,loop2,o2}
			\fmffreeze
			%Operator
			\fmf{dashes}{g1,g2}
			%Hole loops
			\fmf{electron,right,tension=0.3}{g1,loop1}
			\fmf{electron,right,tension=0.3}{loop1,g1}
			\fmf{electron,left,tension=0.3}{g2,loop2}
			\fmf{electron,left,tension=0.3}{loop2,g2}
			%Electronlines
			\fmf{electron}{t1,holeconnect}
			\fmf{electron}{holeconnect,b1}
			\fmf{electron}{b2,partconnect}
			\fmf{electron}{partconnect,t2}
		\end{fmfgraph*}
	\end{fmffile}
	}
}
=
\parbox{23mm}{
	\textrm{
	\begin{fmffile}{fmf-example-term4-2}
		\begin{fmfgraph*}(50,50) 
			\fmfbottom{i1,i2} \fmftop{o1,o2}
			%Reference states
			\fmf{double}{i1,b1,b2,b3,b4,i2}
			\fmf{double}{o1,t1,t2,t3,t4,o2}
			\fmffreeze
			%Operator
			\fmf{phantom}{i2,g2,o2}
			\fmffreeze
			\fmf{dashes}{g1,gmiddle,g2}
			\fmf{phantom}{b2,g1,t2}
			\fmffreeze
			%Hole loops
			\fmf{electron,left,tension=0.5}{g1,gmiddle}
			\fmf{electron,right,tension=0.5}{gmiddle,g2}
			\fmf{electron,right,tension=0.5}{g2,gmiddle}
			\fmf{electron,left,tension=0.5}{gmiddle,g1}
			%Electronlines
			\fmf{electron}{t1,holeconnect}
			\fmf{electron}{holeconnect,b1}
			\fmf{electron}{b2,partconnect}
			\fmf{electron}{partconnect,t2}
		\end{fmfgraph*}
	\end{fmffile}
	}
} .
\end{equation}
\end{enumerate}

We then have in total
\begin{equation}
\begin{split}
\langle \Phi_i^a | \hat{V} | \Phi_j^b \rangle
&=
\overbrace{(-1)^{1+2}\cdot 4 \cdot \frac{1}{4} \langle ja || ib \rangle}^{(a)}
+
\overbrace{(-1)^{2+2} \cdot 4 \cdot \frac{1}{4} \sum_k \delta_{ij} \langle ka || kb \rangle}^{(b)} \\
&+
\underbrace{(-1)^{2+3} \cdot 4 \cdot \frac{1}{4} \sum_k \delta_{ab} \langle jk || ik \rangle}_{(c)}
+
\underbrace{(-1)^{3+3} \cdot 2 \frac{1}{4} \sum_{kl} \delta_{ab} \delta_{ij} \langle kl || kl \rangle }_{(d)}\\
&=  - \langle ja || ib \rangle
+  \sum_k \delta_{ij} \langle ka || kb \rangle 
- \sum_k \delta_{ab} \langle jk || ik \rangle
+ \frac{1}{2} \sum_{kl} \delta_{ab} \delta_{ij} \langle kl || kl \rangle  .
\end{split}
\end{equation}
We will return to diagrams later.


\section{Bit operations and creation and annihilation operators}

In this work we consider wave functions $\Psi$ expressed as linear combinations of
Slater determinants $D$ of orthonormal spin-orbitals $\phi({\bf r})$:
\begin{equation}
\Psi = \sum_i c_i D_i
\end{equation}
Using the Slater-Condon rules,\cite{slater,condon} the matrix elements of any one-body
(${\cal O}_1$) or two-body (${\cal O}_2$) operator expressed in the
determinant space have simple expressions involving one- and two-electron
integrals in the spin-orbital space.
The diagonal elements are given by:
\begin{eqnarray}
  \langle D | {\cal O}_1 | D \rangle & = & \sum_{i \in D} \langle \phi_i | {\cal O}_1 | \phi_i \rangle \\
  \langle D | {\cal O}_2 | D \rangle & = & \frac{1}{2} \sum_{(i,j) \in D}  
      \langle \phi_i \phi_j | {\cal O}_2 | \phi_i \phi_j \rangle - \nonumber \\
 & & 
      \langle \phi_i \phi_j | {\cal O}_2 | \phi_j \phi_i \rangle \nonumber 
\end{eqnarray}
For two determinants which differ only by the substitution of spin-orbital $i$ with
spin-orbital $j$:
\begin{eqnarray}
  \langle D | {\cal O}_1 | D_i^j \rangle & = & \langle \phi_i | {\cal O}_1 | \phi_j \rangle \\
  \langle D | {\cal O}_2 | D_i^j \rangle & = & \sum_{k \in D} 
      \langle \phi_i \phi_k | {\cal O}_2 | \phi_j \phi_k \rangle - 
      \langle \phi_i \phi_k | {\cal O}_2 | \phi_k \phi_j \rangle \nonumber
\end{eqnarray}
For two determinants which differ by two spin-orbitals:
\begin{eqnarray}
  \langle D | {\cal O}_1 | D_{ik}^{jl} \rangle & = & 0 \\
  \langle D | {\cal O}_2 | D_{ik}^{jl} \rangle & = & 
      \langle \phi_i \phi_k | {\cal O}_2 | \phi_j \phi_l \rangle -
      \langle \phi_i \phi_k | {\cal O}_2 | \phi_l \phi_j \rangle \nonumber 
\end{eqnarray}
All other matrix elements involving determinants with more than two
substitutions are zero. 

An efficient implementation of those rules requires:
\begin{enumerate}
 \item to find the number of spin-orbital substitutions between two determinants
 \item to find which spin-orbitals are involved in the substitution
 \item to compute the phase factor if a reordering of the spin-orbitals has occured
\end{enumerate}
This paper proposes an efficient implementation of those three points by using
some specific bit manipulation instructions at the CPU level.




In the build-up of a shell model code that is meant to tackle large dimensionalities
is the action of the Hamiltonian $\hat{H}$ on a 
Slater determinant represented in second quantization as
\[
\ket{\alpha_1\dots \alpha_n} = a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \dots a_{\alpha_n}^\dagger \ket{0}.
\]
The time consuming part stems from the action of the Hamiltonian
on the above determinant,
\[
\left(\sum_{\alpha\beta} \element{\alpha}{t+u}{\beta} a_\alpha^\dagger a_\beta + \frac{1}{4} \sum_{\alpha\beta\gamma\delta}
		\element{\alpha \beta}{V}{\gamma \delta} a_\alpha^\dagger a_\beta^\dagger a_\delta a_\gamma\right)a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \dots a_{\alpha_n}^\dagger \ket{0}.
\]
A practically useful way to implement this action is to encode a Slater determinant as a bit pattern. 

Assume that we have at our disposal $n$ different single-particle orbits
$\alpha_0,\alpha_2,\dots,\alpha_{n-1}$ and that we can distribute  among these orbits $N\le n$ particles.

A Slater  determinant can then be coded as an integer of $n$ bits. As an example, if we have $n=16$ single-particle states
$\alpha_0,\alpha_1,\dots,\alpha_{15}$ and $N=4$ fermions occupying the states $\alpha_3$, $\alpha_6$, $\alpha_{10}$ and $\alpha_{13}$
we could write this Slater determinant as  
\[
\Phi_{\Lambda} = a_{\alpha_3}^\dagger a_{\alpha_6}^\dagger a_{\alpha_{10}}^\dagger a_{\alpha_{13}}^\dagger \ket{0}.
\]
The unoccupied single-particle states have bit value $0$ while the occupied ones are represented by bit state $1$. 
In the binary notation we would write this   16 bits long integer as
\[
\begin{array}{cccccccccccccccc}
{\alpha_0}&{\alpha_1}&{\alpha_2}&{\alpha_3}&{\alpha_4}&{\alpha_5}&{\alpha_6}&{\alpha_7} & {\alpha_8} &{\alpha_9} & {\alpha_{10}} &{\alpha_{11}} &{\alpha_{12}} &{\alpha_{13}} &{\alpha_{14}} & {\alpha_{15}} \\
{0} & {0} &{0} &{1} &{0} &{0} &{1} &{0} &{0} &{0} &{1} &{0} &{0} &{1} &{0} & {0} \\
\end{array}
\]
which translates into the decimal number
\[
2^3+2^6+2^{10}+2^{13}=9288.
\]
We can thus encode a Slater determinant as a bit pattern.

With $N$ particles that can be distributed over $n$ single-particle states, the total number of Slater determinats (and defining thereby the dimensionality of the system) is
\[
\mathrm{dim}(\mathcal{H}) = \left(\begin{array}{c} n \\N\end{array}\right).
\]
The total number of bit patterns is $2^n$. 

We assume again that we have at our disposal $n$ different single-particle orbits
$\alpha_0,\alpha_2,\dots,\alpha_{n-1}$ and that we can distribute  among these orbits $N\le n$ particles.
The ordering among these states is important as it defines the order of the creation operators.
We will write the determinant 
\[
\Phi_{\Lambda} = a_{\alpha_3}^\dagger a_{\alpha_6}^\dagger a_{\alpha_{10}}^\dagger a_{\alpha_{13}}^\dagger \ket{0},
\]
in a more compact way as 
\[
\Phi_{3,6,10,13} = |0001001000100100\rangle.
\]
The action of a creation operator is thus
\[
a^\dagger_{\alpha_4}\Phi_{3,6,10,13} = a^\dagger_{\alpha_4}|0001001000100100\rangle=a^\dagger_{\alpha_4}a_{\alpha_3}^\dagger a_{\alpha_6}^\dagger a_{\alpha_{10}}^\dagger a_{\alpha_{13}}^\dagger \ket{0},
\]
which becomes
\[
-a_{\alpha_3}^\dagger a^\dagger_{\alpha_4} a_{\alpha_6}^\dagger a_{\alpha_{10}}^\dagger a_{\alpha_{13}}^\dagger \ket{0}=-|0001101000100100\rangle.
\]

Similarly
\[
a^\dagger_{\alpha_6}\Phi_{3,6,10,13} = a^\dagger_{\alpha_6}|0001001000100100\rangle=a^\dagger_{\alpha_6}a_{\alpha_3}^\dagger a_{\alpha_6}^\dagger a_{\alpha_{10}}^\dagger a_{\alpha_{13}}^\dagger \ket{0},
\]
which becomes
\[
-a^\dagger_{\alpha_4} (a_{\alpha_6}^\dagger)^ 2 a_{\alpha_{10}}^\dagger a_{\alpha_{13}}^\dagger \ket{0}=0!
\]
This gives a simple recipe:  
\begin{itemize}
\item If one of the bits $b_j$ is $1$ and we act with a creation operator on this bit, we return a null vector
\item  If $b_j=0$, we set it to $1$ and return a sign factor $(-1)^l$, where $l$ is the number of bits set before bit $j$.
\end{itemize}

Consider the action of $a^\dagger_{\alpha_2}$ on various slater determinants:
\[
\begin{array}{ccc}
a^\dagger_{\alpha_2}\Phi_{00111}& = a^\dagger_{\alpha_2}|00111\rangle&=0\times |00111\rangle\\
a^\dagger_{\alpha_2}\Phi_{01011}& = a^\dagger_{\alpha_2}|01011\rangle&=(-1)\times |01111\rangle\\
a^\dagger_{\alpha_2}\Phi_{01101}& = a^\dagger_{\alpha_2}|01101\rangle&=0\times |01101\rangle\\
a^\dagger_{\alpha_2}\Phi_{01110}& = a^\dagger_{\alpha_2}|01110\rangle&=0\times |01110\rangle\\
a^\dagger_{\alpha_2}\Phi_{10011}& = a^\dagger_{\alpha_2}|10011\rangle&=(-1)\times |10111\rangle\\
a^\dagger_{\alpha_2}\Phi_{10101}& = a^\dagger_{\alpha_2}|10101\rangle&=0\times |10101\rangle\\
a^\dagger_{\alpha_2}\Phi_{10110}& = a^\dagger_{\alpha_2}|10110\rangle&=0\times |10110\rangle\\
a^\dagger_{\alpha_2}\Phi_{11001}& = a^\dagger_{\alpha_2}|11001\rangle&=(+1)\times |11101\rangle\\
a^\dagger_{\alpha_2}\Phi_{11010}& = a^\dagger_{\alpha_2}|11010\rangle&=(+1)\times |11110\rangle\\
\end{array}
\]

We have an SD representation
\[
\Phi_{\Lambda} = a_{\alpha_0}^\dagger a_{\alpha_3}^\dagger a_{\alpha_6}^\dagger a_{\alpha_{10}}^\dagger a_{\alpha_{13}}^\dagger \ket{0},
\]
in a more compact way as 
\[
\Phi_{0,3,6,10,13} = |1001001000100100\rangle.
\]
The action of 
\[
a^\dagger_{\alpha_4}a_{\alpha_0}\Phi_{0,3,6,10,13} = a^\dagger_{\alpha_4}|0001001000100100\rangle=a^\dagger_{\alpha_4}a_{\alpha_3}^\dagger a_{\alpha_6}^\dagger a_{\alpha_{10}}^\dagger a_{\alpha_{13}}^\dagger \ket{0},
\]
which becomes
\[
-a_{\alpha_3}^\dagger a^\dagger_{\alpha_4} a_{\alpha_6}^\dagger a_{\alpha_{10}}^\dagger a_{\alpha_{13}}^\dagger \ket{0}=-|0001101000100100\rangle.
\]

The action
\[
a_{\alpha_0}\Phi_{0,3,6,10,13} = |0001001000100100\rangle,
\]
can be obtained by subtracting the logical sum (AND operation) of $\Phi_{0,3,6,10,13}$ and 
a word which represents only $\alpha_0$, that is
\[
|1000000000000000\rangle,
\]  
from $\Phi_{0,3,6,10,13}= |1001001000100100\rangle$.

This operation gives $|0001001000100100\rangle$. 

Similarly, we can form $a^\dagger_{\alpha_4}a_{\alpha_0}\Phi_{0,3,6,10,13}$, say, by adding 
$|0000100000000000\rangle$ to $a_{\alpha_0}\Phi_{0,3,6,10,13}$, first checking that their logical sum
is zero in order to make sure that orbital $\alpha_4$ is not already occupied. 

It is trickier however to get the phase $(-1)^l$. 
One possibility is as follows
\begin{itemize}
\item Let $S_1$ be a word that represents the $1-$bit to be removed and all others set to zero.
In the previous example $S_1=|1000000000000000\rangle$
\item Define $S_2$ as the similar word that represents the bit to be added, that is in our case
$S_2=|0000100000000000\rangle$.
\item Compute then $S=S_1-S_2$, which here becomes
\[
S=|0111000000000000\rangle
\]
\item Perform then the logical AND operation of $S$ with the word containing 
\[
\Phi_{0,3,6,10,13} = |1001001000100100\rangle,
\]
which results in $|0001000000000000\rangle$. Counting the number of $1-$bits gives the phase.  Here you need however an algorithm for bitcounting. Several efficient ones available. 
\end{itemize}


{\bf add material about setting up program for storing and accessing slater determinants}



\section{Exercises}






%\subsection*{Exercise 3}
\begin{Exercise}
Calculate the matrix elements
\[
\bra{\alpha_{1}\alpha_{2}}\hat{F}\ket{\alpha_{1}\alpha_{2}}
\]
and
\[
\bra{\alpha_{1}\alpha_{2}}\hat{G}\ket{\alpha_{1}\alpha_{2}}
\]
with
\[
\ket{\alpha_{1}\alpha_{2}}=a_{\alpha_{1}}^{\dagger}
a_{\alpha_{2}}^{\dagger}\ket{0} ,
\]
\[
\hat{F}=\sum_{\alpha\beta}\bra{\alpha}f\ket{\beta}
a_{\alpha}^{\dagger}a_{\beta}  ,
\]
\[
\bra{\alpha}f\ket{\beta}=\int \psi_{\alpha}^{*}(x)f(x)\psi_{\beta}(x)dx ,
\]
\[
\hat{G} = \frac{1}{2}\sum_{\alpha\beta\gamma\delta}
\bra{\alpha\beta}g\ket{\gamma\delta}
a_{\alpha}^{\dagger}a_{\beta}^{\dagger}a_{\delta}a_{\gamma} ,
\]
and

\[
\bra{\alpha\beta}g\ket{\gamma\delta}=
\int\int \psi_{\alpha}^{*}(x_{1})\psi_{\beta}^{*}(x_{2})g(x_{1},
x_{2})\psi_{\gamma}(x_{1})\psi_{\delta}(x_{2})dx_{1}dx_{2}
\]

Compare these results with those from exercise 1c).
\end{Exercise}
\begin{Exercise}
%\subsection*{Exercise 4}
We define the one-particle operator
\[
\hat{T}={\displaystyle
\sum_{\alpha\beta}}\bra{\alpha}t\ket{\beta}a_{\alpha}^
{\dagger}a_{\beta},
\]
and the two-particle operator
\[
\hat{V}=
\frac{1}{2}{\displaystyle
\sum_{\alpha\beta\gamma\delta}}\bra{\alpha\beta}
v\ket{\gamma\delta}a_{\alpha}^{\dagger}a_{\beta}^{\dagger}
a_{\delta}a_{\gamma}.
\]
We have defined a single-particle basis with quantum numbers given by the set of greek letters $\alpha,\beta,\gamma,\dots$
Show that the form of these operators remain unchanged under 
a transformation  of the single-particle basis given by 
\[
\ket{i}=\sum_{\lambda}\ket{\lambda}\left\langle \lambda | i \right\rangle,
\]
with $\lambda\in \left\{\alpha,\beta,\gamma,\dots\right\}$. 
Show also that
$a_{i}^{\dagger}a_{i}$ is the number operator
for  the orbital $\ket{i}$. 

Find also the expressions for the operators
$T$ and $V$ when $T$ is diagonal in the representation
$i$. 

Show also that the operator
\[
\hat{N}_p=
\frac{1}{2}{\displaystyle
\sum_{\alpha\neq \beta}}
a_{\alpha}^{\dagger}a_{\beta}^{\dagger}
a_{\beta}a_{\alpha},
\]
is an operator that represents the number of pairs. Can you rewrite the 
operators 
for $\hat{T}$ and $\hat{V}$ in terms of the above number operator?
\end{Exercise}
\begin{Exercise}%\subsection*{Exercise 5}
Consider the Hamilton operator for a harmonic oscillator
($c=\hbar =1$)
\[
\hat{H}=\frac{1}{2m}p^{2}+\frac{1}{2}kx^{2},
\hspace{1cm}k=m\omega^{2}
\]
\begin{enumerate}
\item[a)] Define the operators
\[
a^{\dagger}=\frac{1}{\sqrt{2m\omega}}
(p+im\omega x),\hspace{1cm}a=\frac{1}{\sqrt{2m\omega}}
(p-im\omega x)
\]
and find the commutation relations for these operators by using the
corresponding relations for $p$ and $x$.
\item[b)] Show that
\[
H=\omega (a^{\dagger}a+\frac{1}{2})
\]
\item[c)] Show that if for a state $\ket{0}$ which satisfies
$\hat{H}\ket{0}=\frac{1}{2}\omega\ket{0}$, then we have
\[
\hat{H}\ket{n}=\hat{H}(a^{\dagger})^{n}\ket{0}=(n+\frac{1}{2})\omega\ket{n}
\]
\item[d)] Show that the state $\ket{0}$ from c), with the property
$a\ket{0}=0$, must exist.
\item[e)] Find the coordinate-space representation of 
$\ket{0}$ and explain how you would construct the wave functions for excited states based on this state.
\end{enumerate}
\end{Exercise}
\begin{Exercise}%\subsection*{Exercise 6}
Starting with the Slater determinant 
\[
\Phi_{0}=\prod_{i=1}^{n}a_{\alpha_{i}}^{\dagger}\ket{0},
\]
use Wick's theorem to compute the normalization integral
$<\Phi_{0}|\Phi_{0}>$.

\end{Exercise}
\begin{Exercise}%\subsection*{Exercise 7}
Compute the matrix element
\[
\bra{\alpha_{1}\alpha_{2}\alpha_{3}}G\ket{\alpha_{1}'
\alpha_{2}'\alpha_{3}'}
\]
using Wick's theorem and express the two-body operator
$G$ (from exercise 1) in the occupation number (second quantization) 
representation.
\end{Exercise}
\begin{Exercise}%\subsection*{Exercise 8}
Write the two-particle operator
\[
G=\frac{1}{2}\sum_{\alpha\beta\gamma\delta}\bra{\alpha\beta}
g\ket{\gamma\delta}a_{\alpha}^{\dagger}a_{\beta}^{\dagger}
a_{\delta}a_{\gamma}
\]
in the quasi-particle representation for particles and holes
\[
b_{\alpha}^{\dagger}=\left\{\begin{array}{c}
a_{\alpha}^{\dagger}\\a_{\alpha}\end{array}\right.
\hspace{1cm}
b_{\alpha}=\left\{\begin{array}{cc}a_{\alpha}&\alpha>
\alpha_{F}\\
a_{\alpha}^{\dagger}&\alpha \leq \alpha_{F}
\end{array}\right.
\]


\end{Exercise}
\begin{Exercise}%\subsection*{Exercise 9}
Use the results from exercise 8 and Wick's theorem to calculate 
\[
\bra{\beta_{1}\gamma_{1}^{-1}}G\ket{\beta_{2}\gamma_{2}^{-1}}
\]
You need to consider that case that
$\beta_{1}$ be equal
$\beta_{2}$ and that $\gamma_{1}$ be equal $\gamma_{2}$.

\end{Exercise}
\begin{Exercise}%\subsection*{Exercise 10}
Show that the onebody part of the Hamiltonian
    \begin{equation*}
        \hat{H}_0 = \sum_{pq} \element{p}{\hat{h}_0}{q} a^\dagger_p a_q
    \end{equation*}
can be written, using standard annihilation and creation operators, in normal-ordered form as 
    \begin{align*}
        \hat{H}_0 &= \sum_{pq} \element{p}{\hat{h}_0}{q} a^\dagger_p a_q \nonumber \\
            &= \sum_{pq} \element{p}{\hat{h}_0}{q} \left\{a^\dagger_p a_q\right\} + 
                \delta_{pq\in i} \sum_{pq} \element{p}{\hat{h}_0}{q} \nonumber \\
            &= \sum_{pq} \element{p}{\hat{h}_0}{q} \left\{a^\dagger_p a_q\right\} +
                \sum_i \element{i}{\hat{h}_0}{i}
    \end{align*}
Explain the meaning of the various symbols. Which reference 
vacuum has been used?
\end{Exercise}
\begin{Exercise}%\subsection*{Exercise 11}
Show that the twobody part of the Hamiltonian
    \begin{equation*}
        \hat{H}_I = \frac{1}{4} \sum_{pqrs} \element{pq}{\hat{v}}{rs} a^\dagger_p a^\dagger_q a_s  a_r
    \end{equation*}
can be written, using standard annihilation and creation operators, in normal-ordered form as 
    \begin{align*}
    \hat{H}_I &= \frac{1}{4} \sum_{pqrs} \element{pq}{\hat{v}}{rs} a^\dagger_p a^\dagger_q a_s  a_r \nonumber \\
        &= \frac{1}{4} \sum_{pqrs} \element{pq}{\hat{v}}{rs} \normord{a^\dagger_p a^\dagger_q a_s  a_r}
            + \sum_{pqi} \element{pi}{\hat{v}}{qi} \normord{a^\dagger_p a_q} 
            + \frac{1}{2} \sum_{ij} \element{ij}{\hat{v}}{ij}
    \end{align*}
Explain again the meaning of the various symbols.

     Derive the normal-ordered form of the threebody part of the Hamiltonian.
    \begin{align*}
    \hat{H}_3 &= \frac{1}{36} \sum_{\substack{
                        pqr \\
                        stu}}
                 \element{pqr}{\hat{v}_3}{stu} a^\dagger_p a^\dagger_q a^\dagger_r a_u a_t a_s\\
    \end{align*}
and specify the contributions to the twobody, onebody and the scalar part.
\end{Exercise}

\begin{Exercise}
The two-body densities is a simple extension of the one-body density and is defined as 
\[
\rho({\bf r}_1, {\bf r}_2) = \sum_{ij=1}^N \delta({\bf r}_1-{\bf r}_i)\delta({\bf r}_2-{\bf r}_j).
\]
Show that this operator can be written as 
\[
\hat{\rho}({\bf r}_1, {\bf r}_2) = \sum_{\alpha\beta\gamma\delta}^{\infty}\rho_{\alpha,\gamma}({\bf r}_1)\rho_{\beta,\delta}({\bf r}_2)a^{\dagger}_{\alpha}a^{\dagger}_{\beta}a_{\delta}a_{\gamma},
\]
in Fock space, 
meaning that the ground-state two-body density is 
\[
\langle\hat{\rho}({\bf r}_1, {\bf r}_2) \rangle = \sum_{ij=1}^DC^*_{0i}C_{0j}\langle \Phi_i|\sum_{\alpha\beta\gamma\delta}^{\infty}\rho_{\alpha,\gamma}({\bf r}_1)\rho_{\beta,\delta}({\bf r}_2)a^{\dagger}_{\alpha}a^{\dagger}_{\beta}a_{\delta}a_{\gamma}  |\Phi_j\rangle.
\]

\end{Exercise}




Using these properties we cna then define the one-body density in Fock space.
The one-body density in coordinate space is defined as 
\[
\rho({\bf r}) = \sum_{i=1}^N \delta({\bf r}-{\bf r}_i).
\]
In second quantization this becomes
\[
\hat{\rho}({\bf r}) = \sum_{\alpha\beta}^{\infty}\rho_{\alpha,\beta}({\bf r}) a^{\dagger}_{\alpha}a_{\beta}.
\]
where 
\[
\rho_{\alpha,\beta}({\bf r})= \psi^*_{\alpha}({\bf r})\psi_{\beta}({\bf r}).
\]
The number of particles is $N$ and the integral of the expectation value of the one-body density operator should give you $N$ particles. 
With an appropriate similarity transformation we can make this operator diagonal in the single-particle basis $\psi_{\alpha}$. This is your case anyway with a 
harmonic oscillator basis.
That is
\[
\hat{\rho}({\bf r}) = \sum_{\alpha=1}^{\infty} |\psi_{\alpha}({\bf r})|^2a^{\dagger}_{\alpha}a_{\alpha}=
\hat{\rho}({\bf r}) = \sum_{\alpha=1}^{\infty}\rho_{\alpha\alpha}({\bf r}) a^{\dagger}_{\alpha}a_{\alpha}.
\]

Your ground state wave function from the shell model $|\Psi_0\rangle$ calculation is a linear combination of all $D$ possible Slater determinants 
$|\Phi_i\rangle$
\[
|\Psi_0\rangle=\sum_{i=1}^DC_{0i}|\Phi_i\rangle,
\]
where your coefficients $C_{0i}$ arise from the FCI calculation and your Slater determinant basis 
\[
|\Phi_i\rangle = a^{\dagger}_1a^{\dagger}_2\dots a^{\dagger}_N |0\rangle. 
\]

The ground state expectation value of the one-body density operator is
thus
\[
\langle\hat{\rho}({\bf r})\rangle = \langle \Psi_0|\sum_{\alpha=1}^{\infty} \rho_{\alpha,\alpha}({\bf r})a^{\dagger}_{\alpha}a_{\alpha}|\Psi_0\rangle,
\]
which translates into
\[
\langle\hat{\rho}({\bf r})\rangle = \sum_{ij=1}^DC^*_{0i}C_{0j}\langle \Phi_i|\sum_{\alpha=1}^{\infty} \rho_{\alpha,\alpha}({\bf r})a^{\dagger}_{\alpha}a_{\alpha}|\Phi_j\rangle.
\]
Your single-particle wave functions  are the harmonic oscillator wave functions in two dimensions. Integrating
\[
\int \langle\hat{\rho}({\bf r})\rangle d {\bf r},
\]
you have to get $N$, the number of particles!





\begin{Exercise}
In this exercise  we will develop two simple models for studying the 
helium atom (with two electrons) and the beryllium atom with four electrons.

After having introduced the  Born-Oppenheimer approximation which effectively freezes out the nucleonic degrees
of freedom, the Hamiltonian for $N$ electrons takes the following form 
\[
  \hat{H} = \sum_{i=1}^{N} t(x_i) 
  - \sum_{i=1}^{N} k\frac{Ze^2}{r_i} + \sum_{i<j}^{N} \frac{ke^2}{r_{ij}},
\]
with $k=1.44$ eVnm. We will use atomic units, this means
that $\hbar=c=e=m_e=1$. The constant $k$ becomes also equal 1. 
The resulting energies have to be multiplied by $2\times 13.6$ eV
in order to obtain energies in eletronvolts.

 We can rewrite our Hamiltonians as
\begin{equation}
    \hat{H} = \hat{H_0} + \hat{H_I} 
    = \sum_{i=1}^{N}\hat{h}_0(x_i) + \sum_{i<j}^{N}\frac{1}{r_{ij}},
\label{H1H2}
\end{equation}
where  we have defined $r_{ij}=| {\bf r}_i-{\bf r}_j|$ and
$\hat{h}_0(x_i) =  \hat{t}(x_i) - \frac{Z}{r_i}$
The variable $x$ contains both the spatial coordinates and the spin values.
The first term of Eq.~(\ref{H1H2}), $H_0$, is the sum of the $N$
\emph{one-body} Hamiltonians $\hat{h}_0$. Each individual
Hamiltonian $\hat{h}_0$ contains the kinetic energy operator of an
electron and its potential energy due to the attraction of the
nucleus. The second term, $H_I$, is the sum of the $N(N-1)/2$
two-body interactions between each pair of electrons. Note that the double sum carries a restriction $i<j$.

As basis functions for our calculations we will use hydrogen-like single-particle functions.  This means the onebody operator is diagonal in this basis for states $i,j$ with quantum numbers $nlm_lsm_s$ with  
energies 
\[\langle i|\hat{h}_0| j\rangle =  -Z^2/2n^2\delta_{i,j}.\]  
The quantum number $n$ refers to the number of nodes 
of the wave function.  Observe that this expectation value is independent of spin.

We will in all calculations here restrict ourselves to only so-called $s$ -waves,
that is the orbital momentum $l$ is zero. We will also limit the quantum number $n$ to $n\le 3$.  It means that every $ns$ state can accomodate two electrons due to the spin degeneracy. This is illustrated in Fig.~\ref{fig:fighelium} here.
\begin{figure}[hbtp]
\vspace{1.0cm}
 \setlength{\unitlength}{1cm}
 \begin{picture}(15,4)
 \thicklines
\put(-0.6,1){\makebox(0,0){$1s$}}
\put(-0.6,2){\makebox(0,0){$2s$}}
\put(-0.6,3){\makebox(0,0){$3s$}}
% first 2-particle state
\put(0.8,1){\circle*{0.3}}
\put(1.7,1){\circle*{0.3}}
% second 2-particle state
\put(5.0,2){\circle*{0.3}}
\put(5.9,2){\circle*{0.3}}
% third 2-particle state
\put(9.2,1){\circle*{0.3}}
\put(10.1,3){\circle*{0.3}}
% fourth 2-particle state
\put(13.4,1){\circle*{0.3}}
\put(14.3,2){\circle*{0.3}}
\dashline[+1]{2.5}(0,1)(15,1)
\dashline[+1]{2.5}(0,2)(15,2)
\dashline[+1]{2.5}(0,3)(15,3)
 \end{picture}
\caption{Schematic plot of the possible single-particle levels with double degeneracy.
The filled circles indicate occupied particle states.
We show some possible two-particle states which can describe states in the helium atom. \label{fig:fighelium}}
\end{figure}

In the calculations you 
will need the Coulomb interaction with matrix elements
involving single-particle wave functions with $l=0$ only, the so-called $s$-waves.
We need only the radial part since the 
spherical harmonics for the $s$-waves are rather simple. We omit single-particle states with $l> 0$.
Our radial wave functions are
\[
R_{n0}(r)=\left(\frac{2Z}{n}\right)^{3/2}\sqrt{\frac{(n-1)!}{2n\times n!}}L_{n-1}^1(\frac{2Zr}{n})\exp{(-\frac{Zr}{n})},
\]
where $L_{n-1}^1(r)$ are the so-called Laguerre polynomials.
These wave functions can then be used to compute the direct part of the
Coulomb interaction
\[
\langle \alpha\beta| V| \gamma\delta\rangle = \int r_1^2dr_1 \int r_2^2dr_2R_{n_{\alpha}0}^*(r_1) R_{n_{\beta}0}^*(r_2) 
  \frac{1}{| {\bf r}_1-{\bf r}_2|}R_{n_{\gamma}0}(r_1)R_{n_{\delta}0}(r_2)
\]
Observe that this is only the radial integral and that the labels $\alpha\beta\gamma\delta$ refer only to the quantum numbers $nlm_l$, with $m_l$ the projection of the orbital momentum $l$. 
A similar expression can be found for the exchange part. Since we have restricted ourselves to only $s$-waves, these integrals are straightforward but tedious to calculate. As an addendum to this exercise we list all closed-form expressions for the relevant matrix elements. Note well that these matrix elements do not include spin. When setting up the final antisymmetrized matrix elements you need to consider the spin degrees of freedom as well. Please pay in particular special attention to the exchange part and the pertinent spin values of the single-particle states.  


We will also, for both helium and beryllium assume that the many-particle states we construct have always the same total spin projection $M_S=0$. This means that if we excite one or two particles from the ground state, the spins of the various single-particle states should always sum up to zero. 

\begin{enumerate}
\item[a)] We start with the helium atom and define our single-particle Hilbert space to consist of the single-particle orbits $1s$, $2s$ and $3s$, with their corresponding spin degeneracies, see Fig.~\ref{fig:fighelium}. 

Set up the ansatz for the ground state $|c\rangle = |\Phi_0\rangle$ in second 
quantization and define a table of single-particle states. Construct thereafter
all possible one-particle-one-hole excitations  $|\Phi_i^a\rangle$ where $i$ refer to levels below the Fermi level (define this level) and $a$ refers to particle states. Define particles and holes. The Slater determinants have to be written in terms of the respective creation and annihilation operators.
The states you construct should all have total spin projection $M_S=0$. 
Construct also all possible two-particle-two-hole states $|\Phi_{ij}^{ab}\rangle$  in a second quantization representation. 


\item[b)]  Define the Hamiltonian in a second-quantized form and use this to
compute the expectation value of the ground state (defining the so-called reference energy of the helium atom. 
Show that it is given by
\[
  E[\Phi_0] = \langle c | \hat{H}| c \rangle 
  = \sum_{i} \langle i | \hat{h}_0 | i\rangle+ \frac{1}{2}\sum_{ij}\left[\langle ij |\frac{1}{r}|ij\rangle-\langle ij |\frac{1}{r}|ji\rangle\right].
\]
Define properly the sums keeping in mind that the states $ij$ refer to all
quantum numbers $nlm_lsm_s$.
Use the values for the various matrix elements listed at the end of the exercise to find the value of $E$
as function of $Z=2$.
Be careful when you set up the matrix elements. Pay in particular attention to the spin values.
\item[c)]
Hereafter we will limit ourselves to a system which now contains only one-particle-one-hole
excitations beyond the chosen state $|c\rangle$.
Using the possible Slater determinants from exercise a) for the helium atom,   
compute also the expectation values (without inserting the explicit values for the matrix elements first) of 
\[
\langle c | \hat{H}| \Phi_i^a \rangle,
\] 
and 
\[
\langle \Phi_i^a | \hat{H}| \Phi_j^b \rangle.
\]
Represent these expectation values in a diagrammatic form, both for the onebody part and the two-body part of the Hamiltonian. 
 
Insert then the explicit values for the various matrix elements and 
set up the final Hamiltonian matrix and diagonalize it using for example
Octave, Matlab, Python, C++ or Fortran as programming tools.

Compare your results from those of exercise b) and comment your results. 
The exact energy with our Hamiltonian is $-2.9037$ atomic units for helium. This value is also close to the experimental energy.
\item[d)] We repeat exercises b) and c) but now for the beryllium atom.
Define the ansatz for $|c\rangle$ and limit yourself again to one-particle-one-hole excitations.   Compute the reference energy 
$\langle c | \hat{H}| c \rangle $ for $Z=4$.  
Thereafter you will need to set up the appropriate Hamiltonian matrix
which involves also one-particle-one-hole excitations. Diagonalize this matrix
and compare your eigenvalues with $\langle c | \hat{H}| c \rangle$ for $Z=4$ and comment your results. 
The exact energy with our Hamiltonian is $-14.6674$ atomic units for beryllium. This value is again close to the experimental energy.
\end{enumerate}

We conclude by listing in Table \ref{tab:mtxlisting} the matrix elements for the radial integrals to be used for the direct part and the exchange part. Note again that these integrals do not include spin. 
\begin{table}[htbp]
\caption{Closed form expressions for the Coulomb matrix elements. The nomenclature is $1=1s$, $2=2s$ and $3=3s$, with no
spin degrees of freedom. \label{tab:mtxlisting}}
\begin{tabular} {|cr|cr|} \hline 
$\langle 11|V|11\rangle  =$& $ (5Z)/8 $ &$\langle 11|V|12\rangle  =$& $ (4096\sqrt{2}Z)/64827$ \\
$\langle 11|V|13\rangle  =$& $ (1269\sqrt{3}Z)/50000$ &$\langle 11|V|21\rangle  =$& $ (4096\sqrt{2}Z)/64827$ \\
$\langle 11|V|22\rangle  =$& $ (16Z)/729$ & $\langle 11|V|23\rangle  =$& $ (110592\sqrt{6}Z)/24137569$ \\
$\langle 11|V|31\rangle  =$& $ (1269\sqrt{3}Z)/50000$ &$\langle 11|V|32\rangle  =$& $ (110592\sqrt{6}Z)/24137569$ \\
$\langle 11|V|33\rangle  =$& $ (189Z)/32768$ & $\langle 12|V|11\rangle  =$& $ (4096\sqrt{2}Z)/64827$ \\
$\langle 12|V|12\rangle  =$& $ (17Z)/81$ &$\langle 12|V|13\rangle  =$& $ (1555918848\sqrt{6}Z)/75429903125$ \\
$\langle 12|V|21\rangle  =$& $ (16Z)/729$ &$\langle 12|V|22\rangle  =$& $ (512\sqrt{2}Z)/84375$ \\
$\langle 12|V|23\rangle  =$& $ (2160\sqrt{3}Z)/823543$ &$\langle 12|V|31\rangle  =$& $ (110592\sqrt{6}Z)/24137569$ \\
$\langle 12|V|32\rangle  =$& $ (29943\sqrt{3}Z)/13176688$ &$\langle 12|V|33\rangle  =$& $ (1216512\sqrt{2}Z)/815730721$ \\
$\langle 13|V|11\rangle  =$& $ (1269\sqrt{3}Z)/50000$ &$\langle 13|V|12\rangle  =$& $ (1555918848\sqrt{6}Z)/75429903125$ \\
$\langle 13|V|13\rangle  =$& $ (815Z)/8192$ & $\langle 13|V|21\rangle  =$& $ (110592\sqrt{6}Z)/24137569$ \\
$\langle 13|V|22\rangle  =$& $ (2160\sqrt{3}Z)/823543$ & $\langle 13|V|23\rangle  =$& $ (37826560\sqrt{2}Z)/22024729467$ \\
$\langle 13|V|31\rangle  =$& $ (189Z)/32768$ & $\langle 13|V|32\rangle  =$& $ (1216512\sqrt{2}Z)/815730721$ \\
$\langle 13|V|33\rangle  =$& $ (617Z)/(314928\sqrt{3})$ &$\langle 21|V|11\rangle  =$& $ (4096\sqrt{2}Z)/64827$ \\
$\langle 21|V|12\rangle  =$& $ (16Z)/729$ & $\langle 21|V|13\rangle  =$& $ (110592\sqrt{6}Z)/24137569$ \\
$\langle 21|V|21\rangle  =$& $ (17Z)/81$ & $\langle 21|V|22\rangle  =$& $ (512\sqrt{2}Z)/84375$ \\
$\langle 21|V|23\rangle  =$& $ (29943\sqrt{3}Z)/13176688$ & $\langle 21|V|31\rangle  =$& $ (1555918848\sqrt{6}Z)/75429903125$ \\
$\langle 21|V|32\rangle  =$& $ (2160\sqrt{3}Z)/823543$ & $\langle 21|V|33\rangle  =$& $ (1216512\sqrt{2}Z)/815730721$ \\
$\langle 22|V|11\rangle  =$& $ (16Z)/729$ & $\langle 22|V|12\rangle  =$& $ (512\sqrt{2}Z)/84375$ \\
$\langle 22|V|13\rangle  =$& $ (2160\sqrt{3}Z)/823543$ & $\langle 22|V|21\rangle  =$& $ (512\sqrt{2}Z)/84375$ \\
$\langle 22|V|22\rangle  =$& $ (77Z)/512$ & $\langle 22|V|23\rangle  =$& $ (5870679552\sqrt{6}Z)/669871503125$ \\
$\langle 22|V|31\rangle  =$& $ (2160\sqrt{3}Z)/823543$ & $\langle 22|V|32\rangle  =$& $ (5870679552\sqrt{6}Z)/669871503125$ \\
$\langle 22|V|33\rangle  =$& $ (73008Z)/9765625$ & $\langle 23|V|11\rangle  =$& $ (110592\sqrt{6}Z)/24137569$ \\
$\langle 23|V|12\rangle  =$& $ (2160\sqrt{3}Z)/823543$ & $\langle 23|V|13\rangle  =$& $ (37826560\sqrt{2}Z)/22024729467$ \\
$\langle 23|V|21\rangle  =$& $ (29943\sqrt{3}Z)/13176688$ & $\langle 23|V|22\rangle  =$& $ (5870679552\sqrt{6}Z)/669871503125$ \\
$\langle 23|V|23\rangle  =$& $ (32857Z)/390625$ & $\langle 23|V|31\rangle  =$& $ (1216512\sqrt{2}Z)/815730721$ \\
$\langle 23|V|32\rangle  =$& $ (73008Z)/9765625$ & $\langle 23|V|33\rangle  =$& $ (6890942464\sqrt{2/3}Z)/1210689028125$ \\
$\langle 31|V|11\rangle  =$& $ (1269\sqrt{3}Z)/50000$ & $\langle 31|V|12\rangle  =$& $ (110592\sqrt{6}Z)/24137569$ \\
$\langle 31|V|13\rangle  =$& $ (189Z)/32768$ & $\langle 31|V|21\rangle  =$& $ (1555918848\sqrt{6}Z)/75429903125$ \\
$\langle 31|V|22\rangle  =$& $ (2160\sqrt{3}Z)/823543$ & $\langle 31|V|23\rangle  =$& $ (1216512\sqrt{2}Z)/815730721$ \\
$\langle 31|V|31\rangle  =$& $ (815Z)/8192$ & $\langle 31|V|32\rangle  =$& $ (37826560\sqrt{2}Z)/22024729467$ \\
$\langle 31|V|33\rangle  =$& $ (617Z)/(314928\sqrt{3})$ & $\langle 32|V|11\rangle  =$& $ (110592\sqrt{6}Z)/24137569$ \\
$\langle 32|V|12\rangle  =$& $ (29943\sqrt{3}Z)/13176688$ & $\langle 32|V|13\rangle  =$& $ (1216512\sqrt{2}Z)/815730721$ \\
$\langle 32|V|21\rangle  =$& $ (2160\sqrt{3}Z)/823543$ & $\langle 32|V|22\rangle  =$& $ (5870679552\sqrt{6}Z)/669871503125$ \\
$\langle 32|V|23\rangle  =$& $ (73008Z)/9765625$ & $\langle 32|V|31\rangle  =$& $ (37826560\sqrt{2}Z)/22024729467$ \\
$\langle 32|V|32\rangle  =$& $ (32857Z)/390625$ & $\langle 32|V|33\rangle  =$& $ (6890942464\sqrt{2/3}Z)/1210689028125$ \\
$\langle 33|V|11\rangle  =$& $ (189Z)/32768$ & $\langle 33|V|12\rangle  =$& $ (1216512\sqrt{2}Z)/815730721$ \\
$\langle 33|V|13\rangle  =$& $ (617Z)/(314928\sqrt{3})$ & $\langle 33|V|21\rangle  =$& $ (1216512\sqrt{2}Z)/815730721$ \\
$\langle 33|V|22\rangle  =$& $ (73008Z)/9765625$ & $\langle 33|V|23\rangle  =$& $ (6890942464\sqrt{2/3}Z)/1210689028125$ \\
$\langle 33|V|31\rangle  =$& $ (617Z)/(314928\sqrt{3})$ &$\langle 33|V|32\rangle  =$& $ (6890942464\sqrt{2/3}Z)/1210689028125$ \\
$\langle 33|V|33\rangle  =$& $ (17Z)/256$ & & \\ \hline
\end{tabular}
\end{table}




\end{Exercise}

\begin{Exercise}
Consider a Slater determinant built up of single-particle orbitals $\psi_{\lambda}$, 
with $\lambda = 1,2,\dots,N$.

The unitary transformation
\[
\psi_a  = \sum_{\lambda} C_{a\lambda}\phi_{\lambda},
\]
brings us into the new basis.  
The new basis has quantum numbers $a=1,2,\dots,N$.
Show that the new basis is orthonormal.
Show that the new Slater determinant constructed from the new single-particle wave functions can be
written as the determinant based on the previous basis and the determinant of the matrix $C$.
Show that the old and the new Slater determinants are equal up to a complex constant with absolute value unity.
(Hint, $C$ is a unitary matrix). 

\end{Exercise}

\begin{Exercise}
Consider the  Slater  determinant
\[
\Phi_{0}=\frac{1}{\sqrt{n!}}\sum_{p}(-)^{p}P
\prod_{i=1}^{n}\psi_{\alpha_{i}}(x_{i}).
\]
A small variation in this function is given by
\[
\delta\Phi_{0}=\frac{1}{\sqrt{n!}}\sum_{p}(-)^{p}P
\psi_{\alpha_{1}}(x_{1})\psi_{\alpha_{2}}(x_{2})\dots
\psi_{\alpha_{i-1}}(x_{i-1})(\delta\psi_{\alpha_{i}}(x_{i}))
\psi_{\alpha_{i+1}}(x_{i+1})\dots\psi_{\alpha_{n}}(x_{n}).
\]
Show that
\[
\bra{\delta\Phi_{0}}\sum_{i=1}^{n}\left\{t(x_{i})+u(x_{i})
\right\}+\frac{1}{2}
\sum_{i\neq j=1}^{n}v(x_{i},x_{j})\ket{\Phi_{0}}=
\]
\[
\sum_{i=1}^{n}\bra{\delta\psi_{\alpha_{i}}}t+u
\ket{\phi_{\alpha_{i}}}
+\sum_{i\neq j=1}^{n}\left\{\bra{\delta\psi_{\alpha_{i}}
\psi_{\alpha_{j}}}v\ket{\psi_{\alpha_{i}}\psi_{\alpha_{j}}}-
\bra{\delta\psi_{\alpha_{i}}\psi_{\alpha_{j}}}v
\ket{\psi_{\alpha_{j}}\psi_{\alpha_{i}}}\right\}
\]
\end{Exercise}

\begin{Exercise}
What is the diagrammatic representation of the HF equation?
\[
-\bra{\alpha_{k}}u^{HF}\ket{\alpha_{i}}+\sum_{j=1}^{n}
\left[\bra{\alpha_{k}\alpha_{j}}v\ket{\alpha_{i}\alpha_{j}}-
\bra{\alpha_{k}\alpha_{j}}v\ket{\alpha_{j}\alpha_{i}}\right]=0
\hspace{0.5cm}?
\]
(Represent $(-u^{HF})$ by the symbol $---$X .)
\end{Exercise}
\begin{Exercise}
\subsection*{Exercise 17}

Consider the ground state $\ket{\Phi}$ 
of a bound many-particle system of fermions. Assume that we remove one particle
from the single-particle state $\lambda$ and that our system ends in a new state
$\ket{\Phi_{n}}$. 
Define the energy needed to remove this particle as
\[
{\cal E}_{\lambda}=\sum_{n}\vert
\bra{\Phi_{n}}a_{\lambda}\ket{\Phi}\vert^{2}(E_{0}-E_{n}),
\]
where $E_{0}$ and $E_{n}$  are the ground state energies of the states
$\ket{\Phi}$  and  $\ket{\Phi_{n}}$, respectively.
\newline
a) Show that
\[
{\cal E}_{\lambda}=\bra{\Phi}a_{\lambda}^{\dagger}\left[
a_{\lambda},H \right]\ket{\Phi},
\]
where $H$ is the Hamiltonian of this system.
\newline
b) If we assume that $\Phi$ is the  Hartree-Fock result, find the 
relation
between $\cal{E}_{\lambda}$ and the single-particle energy
$\varepsilon_{\lambda}$
for states $\lambda \leq F$ and $\lambda >F$, with
\[
\varepsilon_{\lambda}=\bra{\lambda}(t+u)\ket{\lambda}
\]
and
\[
\bra{\lambda}u\ket{\lambda}={\displaystyle \sum_{\beta \leq F}}
\bra{\lambda\beta}v\ket{\lambda\beta}.
\]
We have assumed an antisymmetrized matrix element here.
Discuss the result.

The Hamiltonian operator is defined as
\[
H={\displaystyle
\sum_{\alpha\beta}}\bra{\alpha}t\ket{\beta}a_{\alpha}^
{\dagger}a_{\beta}+
\frac{1}{2}{\displaystyle
\sum_{\alpha\beta\gamma\delta}}\bra{\alpha\beta}
v\ket{\gamma\delta}a_{\alpha}^{\dagger}a_{\beta}^{\dagger}
a_{\delta}a_{\gamma}.
\]
\end{Exercise}
\begin{Exercise}

The electron gas model allows closed form solutions for quantities like the 
single-particle Hartree-Fock energy.  The latter quantity is given by the following expression
\[
\varepsilon_{k}^{HF}=\frac{\hbar^{2}k^{2}}{2m}-\frac{e^{2}}
{V^{2}}\sum_{k'\leq
k_{F}}\int d\vec{r}e^{i(\vec{k'}-\vec{k})\vec{r}}\int
d\vec{r'}\frac{e^{i(\vec{k}-\vec{k'})\vec{r'}}}
{\vert\vec{r}-\vec{r'}\vert}
\]
a) Show that
\[
\varepsilon_{k}^{HF}=\frac{\hbar^{2}k^{2}}{2m}-\frac{e^{2}
k_{F}}{2\pi}
\left[
2+\frac{k_{F}^{2}-k^{2}}{kk_{F}}ln\left\vert\frac{k+k_{F}}
{k-k_{F}}\right\vert
\right]
\]
(Hint: Introduce the convergence factor 
$e^{-\mu\vert\vec{r}-\vec{r'}\vert}$
in the potential and use  $\sum_{\vec{k}}\rightarrow
\frac{V}{(2\pi)^{3}}\int d\vec{k}$ )
\newline
b) Rewrite the above result as a function of the density
\[
n= \frac{k_F^3}{3\pi^2}=\frac{3}{4\pi r_s^3},
\]
where $n=N/V$, $N$ being the number of particles, and $r_s$ is the radius of a sphere which represents the volum per conducting electron.  
It can be convenient to use the Bohr radius $a_0=\hbar^2/e^2m$.

For most metals we have a relation $r_s/a_0\sim 2-6$.

Make a plot of the free electron energy and the Hartree-Fock energy
and discuss the behavior around the Fermi surface. Extract also  
the Hartree-Fock band width $\Delta\varepsilon^{HF}$ defined as
\[ \Delta\varepsilon^{HF}=\varepsilon_{k_{F}}^{HF}-
\varepsilon_{0}^{HF}.\]
Compare this results with the corresponding one for a free electron and comment
your results. How large is the contribution due to the exchange term in the Hartree-Fock equation?\newline
c) We will now define a quantity called the effective mass.
For $\vert\vec{k}\vert$ near $k_{F}$, we can Taylor expand the Hartree-Fock energy as  
\[
\varepsilon_{k}^{HF}=\varepsilon_{k_{F}}^{HF}+
\left(\frac{\partial
\varepsilon_{k}^{HF}}{\partial k}\right)_{k_{F}}(k-k_{F})+\dots
\]
If we compare the latter with the corresponding expressiyon for the non-interacting system
\[
\varepsilon_{k}^{(0)}=\frac{\hbar^{2}k^{2}_{F}}{2m}+
\frac{\hbar^{2}k_{F}}{m}\left(k-k_{F}\right)+\dots ,
\]
we can define the so-called effective Hartree-Fock mass as
\[
m_{HF}^{*}\equiv\hbar^{2}k_{F}\left(
\frac{\partial\varepsilon_{k}^{HF}}
{\partial k}\right)_{k_{F}}^{-1}
\]
Compute $m_{HF}^{*}$ and comment your results after you have done 
point d). \newline
d) Show that the level density (the number of single-electron states
per unit energy) can be written as
\[
n(\varepsilon)=\frac{Vk^{2}}{2\pi^{2}}\left(
\frac{\partial\varepsilon}{\partial k}\right)^{-1}
\]
Calculate $n(\varepsilon_{F}^{HF})$ and comment the results from c) and d).
\end{Exercise}
\begin{Exercise}
We consider a system of electrons in infinite matter, the so-called electron gas. This is a homogeneous system and the one-particle states are given by plane wave function normalized to a volume $\Omega$ 
for a box with length $L$ (the limit $L\rightarrow \infty$ is to be taken after we have computed various expectation values)
\[
\psi_{{\bf k}\sigma}({\bf r})= \frac{1}{\sqrt{\Omega}}\exp{(i{\bf kr})}\xi_{\sigma}
\]
where ${\bf k}$ is the wave number and  $\xi_{\sigma}$ is a spin function for either spin up or down
\[ 
\xi_{\sigma=+1/2}=\left(\begin{array}{c} 1 \\ 0 \end{array}\right) \hspace{0.5cm}
\xi_{\sigma=-1/2}=\left(\begin{array}{c} 0 \\ 1 \end{array}\right).\]

We assume that we have periodic boundary conditions which limit the allowed wave numbers to
\[
k_i=\frac{2\pi n_i}{L}\hspace{0.5cm} i=x,y,z \hspace{0.5cm} n_i=0,\pm 1,\pm 2, \dots
\]
We assume first that the particles interact via a central, symmetric and translationally invariant
interaction  $V(r_{12})$ with
$r_{12}=|{\bf r}_1-{\bf r}_2|$.  The interaction is spin independent.

The total Hamiltonian consists then of kinetic and potential energy
\[
\hat{H} = \hat{T}+\hat{V}.
\]
\begin{enumerate}
\item[a)] Show that the operator for the kinetic energy can be written as
\[
\hat{T}=\sum_{{\bf k}\sigma}\frac{\hbar^2k^2}{2m}a_{{\bf k}\sigma}^{\dagger}a_{{\bf k}\sigma}.
\]
Find also the number operator $\hat{N}$ and find a corresponding expression for the interaction
$\hat{V}$ expressed with creation and annihilation operators.   The expression for the interaction
has to be written in  $k$ space, even though $V$ depends only on the relative distance. It means that you ned to set up the Fourier transform $\langle {\bf k}_i{\bf k}_j| V | {\bf k}_m{\bf k}_n\rangle$.
\item[b)] We assume that  $V(r_{12}) < 0$ kand that the integral 
$\int |V(x)| d^3x < \infty$.

Use the operator form for $\hat{H}$ from the previous exercise and calculate
$E_0=\bra{\Phi_{0}}H\ket{\Phi_{0}}$ for this system to first order in perturbation theory
and express the result as a function of the density $\rho=N/\Omega$. 
The state $\ket{\Phi_{0}}$  is a Slater determinant determined by filling all states up to Fermi level.
Show that the system will collapse (you wil not be able to find an energy minimum). Comment your results.
\item[c)] We will now study the electron gas. The Hamilton operator is given by
\[
\hat{H}=\hat{H}_{el}+\hat{H}_{b}+\hat{H}_{el-b},
\]
with the electronic part
\[
\hat{H}_{el}=\sum_{i=1}^N\frac{p_i^2}{2m}+\frac{e^2}{2}\sum_{i\ne j}\frac{e^{-\mu |{\bf r}_i-{\bf r}_j|}}{|{\bf r}_i-{\bf r}_j|},
\]
where we have introduced an explicit convergence factor
(the limit $\mu\rightarrow 0$ is performed after having calculated the various integrals).
Correspondingly, we have
\[
\hat{H}_{b}=\frac{e^2}{2}\int\int d{\bf r}d{\bf r}'\frac{n({\bf r})n({\bf r}')e^{-\mu |{\bf r}-{\bf r}'|}}{|{\bf r}-{\bf r}'|},
\]
which is the energy contribution from the positive background charge with density
$n({\bf r})=N/\Omega$. Finally,
\[
\hat{H}_{el-b}=-\frac{e^2}{2}\sum_{i=1}^N\int d{\bf r}\frac{n({\bf r})e^{-\mu |{\bf r}-{\bf x}_i|}}{|{\bf r}-{\bf x}_i|},
\]
is the interaction between the electrons and the positive background.

Show that
\[
\hat{H}_{b}=\frac{e^2}{2}\frac{N^2}{\Omega}\frac{4\pi}{\mu^2},
\]
and
\[
\hat{H}_{el-b}=-e^2\frac{N^2}{\Omega}\frac{4\pi}{\mu^2}.
\]
Show thereafter that the final Hamiltonian can be written as 
\[
H=H_{0}+H_{I},
\]
with
\[
H_{0}={\displaystyle\sum_{{\bf k}\sigma}}
\frac{\hbar^{2}k^{2}}{2m}a_{{\bf k}\sigma}^{\dagger}
a_{{\bf k}\sigma},
\]
and
\[
H_{I}=\frac{e^{2}}{2\Omega}{\displaystyle\sum_{\sigma_{1}
\sigma_{2}}}{\displaystyle
\sum_{{\bf q}\neq 0,{\bf k},{\bf p}}}\frac{4\pi}{q^{2}}
a_{{\bf k}+{\bf q},\sigma_{1}}^{\dagger}
a_{{\bf p}-{\bf q},\sigma_{2}}^{\dagger}
a_{{\bf p}\sigma_{2}}a_{{\bf k}\sigma_{1}}.
\] 
\item[d)] Calculate
$E_0/N=\bra{\Phi_{0}}H\ket{\Phi_{0}}/N$ for
for this system to first order in the interaction.
Show that, by using
\[
\rho= \frac{k_F^3}{3\pi^2}=\frac{3}{4\pi r_0^3},
\]
with $\rho=N/\Omega$, $r_0$
being the radius of a sphere representing the volume an electron occupies 
and the Bohr radius $a_0=\hbar^2/e^2m$, 
that the energy per electron can be written as 
\[
E_0/N=\frac{e^2}{2a_0}\left[\frac{2.21}{r_s^2}-\frac{0.916}{r_s}\right].
\]
Here we have defined
$r_s=r_0/a_0$ to be a dimensionless quantity.

Plot your results and link your discussion to the result in exercise b). Why is this system stable?
\item[e)] 
Calculate thermodynamical quantities like the pressure, given by
\[
P=-\left(\frac{\partial E}{\partial \Omega}\right)_N,\]
and the bulk modulus
\[
B=-\Omega\left(\frac{\partial P}{\partial \Omega}\right)_N,\]
and comment your results.
\item[f)] 
The single-particle Hartree-Fock energies are given by the expression 
\[
\varepsilon_{k}^{HF}=\frac{\hbar^{2}k^{2}}{2m}-\frac{e^{2}
k_{F}}{2\pi}
\left[
2+\frac{k_{F}^{2}-k^{2}}{kk_{F}}ln\left\vert\frac{k+k_{F}}
{k-k_{F}}\right\vert
\right].
\]
(You don't need to calculate this quantity).  How can you use the Hartree-Fock energy to 
find the ground state energy? Are there differences between the Hartree-Fock results and those you 
found in exercise d)?  Comment your results.
\end{enumerate}
\end{Exercise}
\begin{Exercise}
\subsection*{Exercise 20}
Show Thouless' theorem: An arbitrary Slater determinant $\ket{c'}$ which is not orthogonal to a determinant
$\ket{c}={\displaystyle\prod_{i=1}^{n}}
a_{\alpha_{i}}^{\dagger}\ket{0}$, can be written as
\[
\ket{c'}=exp\left\{\sum_{p=\alpha_{n+1}}^{\infty}
\sum_{h=\alpha_{1}}^{\alpha_{n}}C_{ph}a_{p}^{\dagger}
a_{h}\right\}\ket{c}
\]
\end{Exercise}
\begin{Exercise}
We have
\[
\ket{c}=\prod_{k>0}(u_{k}+v_{k}a_{k}^{\dagger}a_{-
k}^{\dagger})\ket{0}
\]
with $u_{k}^{2}+v_{k}^{2}=1$,
$\hat{N}={\displaystyle \sum_{\nu}}a_{\nu}^{\dagger}a_{\nu}$ and
$\hat{H}=-|G|{\displaystyle
\sum_{\nu,\nu'>0}}a_{\nu}^{\dagger}a_{-
\nu}^{\dagger}a_{-\nu'}a_{\nu'}$.
Show that
\begin{enumerate}
\item[a)]
\[
\left \langle c|c\right \rangle=\prod_{k>0}(u_{k}^{2}+v_{k}^{2})
\]
\item[b)]
\[
\bra{c}\hat{N}\ket{c}=2\sum_{\nu >0}v_{\nu}^{2}
\]
\item[c)]
\[
\bra{c}\hat{N}^{2}\ket{c}=4\sum_{\nu>0}
v_{\nu}^{2}+4\sum_{\nu\neq\nu '>0}v_{\nu}^{2}v_{\nu '}^{2}
\]
\item[d)]
\[
(\Delta
N)^{2}=\bra{c}\hat{N}^{2}\ket{c}-(\bra{c}\hat{N}\ket{c})^{2}
	   =4{\displaystyle \sum_{\nu >0}}u_{\nu}^{2}v_{\nu}^{2}
\]
\item[e)]
\[
\bra{c}\hat{H}\ket{c}=-|G|\left[\sum_{\nu
>0}u_{\nu}v_{\nu}\right]^{2}
		-|G|\sum_{\nu >0}v_{\nu}^{4}
\]
\end{enumerate}
\end{Exercise}
