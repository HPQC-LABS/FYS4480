TITLE: Project 1, deadline  October 19
AUTHOR: "Many-body Physics FYS4480":"http://www.uio.no/studier/emner/matnat/fys/FYS4480/index-eng.html" {copyright, 1999-present|CC BY-NC} at Department of Physics, University of Oslo, Norway
DATE: today

===== Introduction =====

The system we will study using the Hartree-Fock method is that of electrons confined in two dimensions by a harmonic oscillator potential, normally called quantum dots.
Strongly confined electrons offer a wide variety of complex and subtle phenomena which pose severe  challenges to existing many-body methods.
Quantum dots in particular, that is, electrons confined in semiconducting heterostructures, exhibit, due to their small size, discrete quantum levels. 
Small confined systems, such as quantum dots, have become very popular for experimental  study. 
Beyond their possible relevance for nanotechnology, they are highly tunable in experiments and introduce level quantization and quantum interference in a controlled way. 
The possibility to manufacture systems with a tailored electronic structure, may improve electrical or optical properties of materials, a reason why quantum dots are good candidates as components in quantum computers, optimized solar cells, laser technology and medical imaging, to name a few.

We will consider a system of two and six electrons. These represent both so-called closed shell systems. The numbers two and six, together with $N=12$, $N=20$, $N=30$, $N=42$, etc define 
magic numbers for quantum dots in much the same way as we have for atoms and nuclei. 

Our Hilbert space will be defined by the three lowest harmonic oscillator single-particle states.
In total, when we add spin, we have 12 single-particle states. Without spin, the spatial coordinates
are represented  by six single-particle states (see below). 

Ou  Hamiltonian for $N$ electrons takes the following form

!bt
\begin{equation*}
  \hat{H} = \sum_{i=1}^{N} t(x_i) 
  + \sum_{i=1}^{N} \frac{1}{2}m_e\omega^2r^2_i + \sum_{i<j}^{N} \frac{ke^2}{r_{ij}},
\end{equation*}
!et
with $k=1.44$ eVnm. Throughout this midterm exam we will use atomic units, this means
that $\hbar=c=e=m_e=1$. The constant $k$ becomes also equal 1.   We will also set the oscillator  frequency 
$\omega$ to one.  

 We can rewrite our Hamiltonians as

!bt
\begin{equation}
    \hat{H} = \hat{H_0} + \hat{H_I} 
    = \sum_{i=1}^{N}\hat{h}_0(x_i) + \sum_{i<j}^{N}\frac{1}{r_{ij}},
label{H1H2}
\end{equation}
!et
where  we have defined $r_{ij}=| _r__i-_r__j|$ and
$\hat{h}_0(x_i) =  \hat{t}(x_i) +\frac{r^2_i}{2}$
The variable $x$ contains both the spatial coordinates and the spin values.
The first term of Eq. (ref{H1H2}), $H_0$, is the sum of the $N$
*one-body* Hamiltonians $\hat{h}_0$. Each individual
Hamiltonian $\hat{h}_0$ contains the kinetic energy operator of an
electron and its harmonic oscillator potential.
The second term, $H_I$, is the sum of the $N(N-1)/2$
two-body interactions between each pair of electrons. Note that the double sum carries a restriction $i<j$.

As basis functions for our calculations we will use harmonic oscillator functions for the 
 single-particle functions.  This means the onebody operator is diagonal in this basis for states $i,j$ with quantum numbers $nm_lm_s$. The expectation value is

!bt
\begin{equation*}\langle i|\hat{h}_0| j\rangle =  e_i\delta_{i,j}=e_{n_im_{l_i}}=\hbar\omega(2n_i+|m_{l_i}|+1).\end{equation*}
!et
 
The quantum numbers $n_i$ refers to the number of nodes 
of the wave function, while the quantum numbers $m_{l_i}$ represent the projection of the orbital momentum.  Observe that this expectation value is independent of spin.  Throughout this midterm exam we employ $\hbar\omega=1$ a.u.



In the calculations you 
will need the Coulomb interaction with matrix elements involving the orbits we discussed above. 
The single-particle functions are given by the so-called generalized Laguerre polynomials
(with $\alpha = \sqrt{m\omega/\hbar}$)

!bt
\begin{equation}
\psi_{nm_l}(r,\theta)=\alpha\exp{(\imath m\theta)}\sqrt{\frac{n!}{\pi(n+|m|)!}}(\alpha r)^{|m|}L_{n}^{|m|}(\alpha^2 r^2))\exp{(-\alpha^2 r^2/2)},
\end{equation}
!et
with eigenenergy $\hbar\omega(2n+|m|+1)$.
Here $L_{n}^{|m|}$ are the so-called Laguerre polynomials. For the system we will study, we need only 
$L_{0}^{|m|}(x)=1$ and
$L_{1}^{0}(x)=-x+1$. 
These functions can then be used to compute the integral that define the two-body matrix elements stemming
from the repulsive
Coulomb interaction (with no spin degrees of freedom)

!bt
\begin{equation*}
\langle \alpha\beta| V| \gamma\delta\rangle = \int r_1dr_1 d\theta_1 \int r_2dr_2 d\theta_2\psi_{n_{\alpha}m_{l_{\alpha}}}^*(r_1,\theta_1)\psi_{n_{\beta}m_{l_{\beta}}}^*(r_2,\theta_2)
  \frac{1}{| _r__1-_r__2|}\psi_{n_{\gamma}m_{l_{\gamma}}}(r_1,\theta_1)\psi_{n_{\delta}m_{l_{\delta}}}(r_2,\theta_2).
\end{equation*}
!et

The explicit values for these matrix elements are found in the appendix of this midterm exam.
Note well that these matrix elements do not include spin. When setting up the final antisymmetrized matrix elements you need to consider the spin degrees of freedom as well. 

We will also, for both two and six electrons 
assume that the many-particle states we construct have always a total projection of the orbital momentum $M=0$ and the same total spin projection $M_S=0$. 
This means that if we excite one or two particles from the ground state, the spins and projections of the orbital momenta of the various single-particle states should always sum up to zero. 


  * [1a)] We start with the two-electron system and define our single-particle Hilbert space to consist of the single-particle orbits $(n=0, m_l=0)$, $(n=1, m_l=0)$, $(n=0, m_l=\pm 1)$ and $(n=0,m_l=\pm 2)$, with their corresponding spin degeneracies. Without spin we have thus six single-particle states.
Adding the two spin degeneracies, we end up with 12 states.  

Set up the ansatz for the ground state $|\Phi_0\rangle$ in second 
quantization and define a table of single-particle states. Construct thereafter
all possible one-particle-one-hole excitations  $|\Phi_i^a\rangle$ where $i$ refers to levels below the Fermi level (define this level) and $a$ refers to particle states. Define particles and holes. The Slater determinants have to be written in terms of the respective creation and annihilation operators.
The two-particle states you construct should all have total spin projection $m_{s_1}+m_{s_2}=M_S=0$ and orbital momentum projection $m_{l_1}+m_{l_2}=M=0$.  The sub-indices refer to electron one and two, respectively. 
Construct also all possible two-particle-two-hole states $|\Phi_{ij}^{ab}\rangle$  in a second quantization representation for the same total quantum numbers (for the two-particle system having the same values of $M$ and $M_S$). 


  * [1b)]  Define the Hamiltonian in a second-quantized form and use this to
compute the expectation value of the ground state (defining the so-called reference energy and later our Hartree-Fock functional) of the two-electron quantum dot.
Show that it is given by

!bt
\begin{equation*}
  E[\Phi_0] = \langle \Phi_0 | \hat{H}| \Phi_0 \rangle 
  = \sum_{i} \langle i | \hat{h}_0 | i\rangle+ \frac{1}{2}\sum_{ij}\left[\langle ij |\frac{1}{r}|ij\rangle-\langle ij |\frac{1}{r}|ji\rangle\right].
\end{equation*}
!et
Define properly the sums keeping in mind that the states $ij$ refer to all
quantum numbers $nm_lm_s$.
Use the values for the various matrix elements listed at the end of this exam.

  * [1c)]
Hereafter we will limit ourselves to a system which now contains only one-particle-one-hole
excitations beyond the chosen state $|\Phi_0\rangle$.
Using the possible Slater determinants from exercise a) for the two-electron quantum dot,   
compute also the expectation values (without inserting the explicit values for the matrix elements first) of

!bt
\begin{equation*}
\langle \Phi_0 | \hat{H}| \Phi_i^a \rangle,
\end{equation*}
!et 
and

!bt
\begin{equation*}
\langle \Phi_i^a | \hat{H}| \Phi_j^b \rangle.
\end{equation*}
!et
Represent these expectation values in a diagrammatic form, both 
for the onebody part and the two-body part of the Hamiltonian. 
 
Insert then the explicit values for the various matrix elements and 
set up the final Hamiltonian matrix and diagonalize it using for example
Octave, Matlab, Python, C++ or Fortran as programming tools.

Compare your results from those of exercise b) and comment your results. 
The exact energy with our Hamiltonian is $3$ atomic units for the two-electron quantum dot. This means 
that an infinite single-particle (in terms of the harmonic oscillator basis) basis is used. 


  * [1d)] We repeat exercises b) and c) but now for the six electron quantum dot.
Define the ansatz for $|\Phi_0\rangle$ and limit yourself again to one-particle-one-hole excitations.   
Compute the reference energy 
$\langle \Phi_0 | \hat{H}| \Phi_0 \rangle $. Thereafter you will need to set up the appropriate Hamiltonian matrix
which involves also one-particle-one-hole excitations. Diagonalize this matrix
and compare your eigenvalues with $\langle \Phi_0 | \hat{H}| \Phi_0 \rangle$ and comment the result. 
The best numerical result for our  Hamiltonian is obtained with Diffusion Monte Carlo calculations, and for 
$\hbar\omega=1$ the energy for the ground state is  20.1597 atomic units for the six electron quantum dot,
see for example Lohne Pedersen *et al*, Physical Review B _84_, 115302 (2011). \newline\newline\newline
With a given energy functional, we can perform at least two types of variational strategies.

  * Vary the Slater determinant by changing the spatial part of the single-particle wave functions themselves.

  * Expand the single-particle functions in a known basis  and vary the coefficients,  that is, the new function single-particle wave function $|p\rangle$ is written as a linear expansion in terms of a fixed basis $\phi$ (harmonic oscillator, Laguerre polynomials etc)  
!bt 
\begin{equation*} 
\psi_p  = \sum_{\lambda} C_{p\lambda}\phi_{\lambda},
\end{equation*}
!et

Both cases lead to a new Slater determinant which is related to the previous via  a unitary transformation.
Below we will set up the Hartree-Fock equations using the second option.  
We assume that our basis is still formed by the hydrogen-like wave functions. 


  * [1e)] Consider a Slater determinant built up of single-particle orbitals $\phi_{\lambda}$ where the indices $\lambda$ refer to specific single-particle states.

The unitary transformation

!bt
\begin{equation*}
\psi_p  = \sum_{\lambda} C_{p\lambda}\phi_{\lambda},
\end{equation*}
!et
brings us into the new basis $\psi$.  Show that the new basis is orthonormal.
Show that the new Slater determinant constructed from the new single-particle wave functions can be
written as the determinant based on the previous basis and the determinant of the matrix $C$.
Show that the old and the new Slater determinants are equal up to a complex constant with absolute value unity.
(Hint, $C$ is a unitary matrix).   Which assumptions are you making in order to obtain this result? 


  * [1f)]
Minimizing with respect to $C^*_{p\alpha}$, remembering that $C^*_{p\alpha}$ and $C_{p\alpha}$ (and that the indices contain all single-particle quantum numbers including spin)
are independent and defining

!bt
\begin{equation*}
h_{\alpha\gamma}^{HF}=\langle \alpha | h | \gamma \rangle+
\sum_{p}\sum_{\beta\delta} C^*_{p\beta}C_{p\delta}\langle \alpha\beta|V|\gamma\delta\rangle_{AS},
\end{equation*}
!et
show that you can write the Hartree-Fock  equations as

!bt
\begin{equation*}
\sum_{\gamma}h_{\alpha\gamma}^{HF}C_{p\gamma}=\epsilon_p^{\mathrm{HF}}C_{p\alpha}.
label{eq:newhf}
\end{equation*}
!et
Explain the meaning of the different terms and define the Hartree-Fock 
operator in second quantization. Write down its diagrammatic representation as well.  The greek letters refer to the wave functions in the original basis (in our case the harmonic oscillator functions) while roman letters refer to the new basis. 

Discuss the stability of the Hartree-Fock equations and find out whether the matrix elements listed at the end
of the midterm exam result in a stable procedure (consider the two- and six-electron cases).


  * [1g)]
The Hartree-Fock equations with a variation of the coefficients $C_{p\alpha}$
lead to an eigenvalue problem whose eigenvectors are the coefficients
$C_{p\alpha}$ and eigenvalues are the new single-particle energies. 
Use the single-particle states for the relevant shells
and set up the Hartree-Fock matrix for both the two-electron and the six electron systems. 
Find after the first diagonalization the new single-particle energies and the new ground state energy.
Compare these results with  those you obtained by diagonalizing the Hamiltonian matrices in c) for the two-electron systems and e) for the six electron system.  Comment yur results.

When setting up the Hartree-Fock matrix 
in the first iteration, our guess for the coefficients $C_{p\beta}$ etc. is $C_{p\beta}=1$ for $p=\beta$ and zero else. 
  * [1h)]
The final stage is to 
set up an iterative scheme  where you use the new wave functions
determined via the coefficients $C_{p\alpha}$ to solve iteratively the Hartree-Fock equations till a given self-consistency is reached. A typical way of doing this is to compare the single-particle energies from the previous iteration with those obtained from the new diagonalization. If the total difference is smaller than a prefixed value, the iterative process is stopped. 

Compare these results with those you obtained with the full diagonalization. Discuss your results. 

  * [1i)] This exercise is optional but gives an additional score of 40\% if performed. The aim here is
to repeat first exercises 1g) and 1h) by writing a program for doing Hartree-Fock calculations.
The choice of programming language is optional. 

The first check is to write a program that reproduces the results obtained in 1g) and 1h) 
for two particles with only three oscillator shells using the matrix elements in the table below
(see also the file matrixlements.dat).   The next steps are:

  * Extend the single-particle basis from three shells to eight-ten major shells. Set up the basis and the expectation values of $\langle i |h_o| j\rangle$.

  * Compute thereafter the Coulomb matrix elements  using the expressions in the appendix and the code example (coulomb.cpp included together with the latex file is  an example of a program in c++)  and set up a table of anti-symmetric matrix elements.  Store these in a table.

  * Perform thereafter the Hartree-Fock calculations (focus on one spin value only, the Hartree-Fock energies are independent of spin)) for this enlarged basis for two and six electrons and  compare your results with those from 1h) and 1i).

  * Study the convergence of the Hartree-Fock energies as functions of the number of shells involved.  Comment your results.









======= Additional material, table of matrix elements and expressions for the expectation value of the two-body matrix elements =======

===== Expressions for the Coulomb matrix elements =====

The expression for the Coulomb matrix elements can be found 
 in the article of  E. Anisimovas and A. Matulis, J. Phys.: Condens. Matter _10_,  601
(1998). We provide here however explicit values for the matrix elements of interest.


===== Explicit values for the two-body matrix elements for $\hbar\omega=1$ a.u. ===== 

The expectation values for the two-body matrix elements are computed using the closed-form expression tabulated 
 in the article of  E. Anisimovas and A. Matulis, J. Phys.: Condens. Matter _10_,  601
(1998).

Note that the integrals below do not include spin. The nomenclature is $1=(n=0,m_l=0)$, $2=(n=0, m_l=-1)$, $3=(n=0, m_l=+1)$, $4=(n=0,m_l=-2)$, $5=(n=1,m_l=0)$, and $6=(n=0,m_l=+2)$ with no spin degrees of freedom. Only the integrals are listed, you need to add the spin values and compute  the final 
antisymmetric matrix element. This table can also be found at the webpage of the course, see the file matrixelements.dat listed under the midterm link.  Only the non-zero matrix elements are listed.

!bc
1 1 1 1     1.253314137
1 1 1 5    0.3133285343
1 1 2 3    0.3133285343
1 1 3 2    0.3133285343
1 1 4 6    0.1174982004
1 1 5 1    0.3133285343
1 1 5 5    0.2349964007
1 1 6 4    0.1174982004
1 2 1 2     0.939985603
1 2 2 1    0.3133285343
1 2 2 5    -0.07833213358
1 2 3 4    0.2769459142
1 2 4 3    0.1661675485
1 2 5 2    0.07833213358
1 3 1 3     0.939985603
1 3 2 6    0.2769459142
1 3 3 1    0.3133285343
1 3 3 5    -0.07833213358
1 3 5 3    0.07833213358
1 3 6 2    0.1661675485
1 4 1 4     0.744155269
1 4 2 2    0.2769459142
1 4 4 1    0.1174982004
1 4 4 5    -0.08812365028
1 4 5 4    -0.009791516698
1 5 1 1    0.3133285343
1 5 1 5    0.8616534694
1 5 2 3    -0.07833213358
1 5 3 2    -0.07833213358
1 5 4 6    -0.08812365028
1 5 5 1    0.2349964007
1 5 5 5    0.1370812338
1 5 6 4    -0.08812365028
1 6 1 6     0.744155269
1 6 3 3    0.2769459142
1 6 5 6    -0.009791516698
1 6 6 1    0.1174982004
1 6 6 5    -0.08812365028
2 1 1 2    0.3133285343
2 1 2 1     0.939985603
2 1 2 5    0.07833213358
2 1 3 4    0.1661675485
2 1 4 3    0.2769459142
2 1 5 2    -0.07833213358
2 2 1 4    0.2769459142
2 2 2 2    0.8616534694
2 2 4 1    0.2769459142
2 2 4 5    -0.1523202528
2 2 5 4    -0.1523202528
2 3 1 1    0.3133285343
2 3 1 5    -0.07833213358
2 3 2 3    0.8616534694
2 3 3 2    0.2349964007
2 3 4 6    0.3035370176
2 3 5 1    -0.07833213358
2 3 5 5    0.1370812338
2 3 6 4    0.1468727505
2 4 2 4    0.7539467857
2 4 4 2    0.3035370176
2 5 1 2    -0.07833213358
2 5 2 1    0.07833213358
2 5 2 5    0.7245722356
2 5 3 4    -0.1246256614
2 5 4 3    -0.1523202528
2 5 5 2    0.1370812338
2 6 1 3    0.2769459142
2 6 2 6    0.7539467857
2 6 3 1    0.1661675485
2 6 3 5    -0.1246256614
2 6 5 3    -0.1523202528
2 6 6 2    0.1468727505
3 1 1 3    0.3133285343
3 1 2 6    0.1661675485
3 1 3 1     0.939985603
3 1 3 5    0.07833213358
3 1 5 3    -0.07833213358
3 1 6 2    0.2769459142
3 2 1 1    0.3133285343
3 2 1 5    -0.07833213358
3 2 2 3    0.2349964007
3 2 3 2    0.8616534694
3 2 4 6    0.1468727505
3 2 5 1    -0.07833213358
3 2 5 5    0.1370812338
3 2 6 4    0.3035370176
3 3 1 6    0.2769459142
3 3 3 3    0.8616534694
3 3 5 6    -0.1523202528
3 3 6 1    0.2769459142
3 3 6 5    -0.1523202528
3 4 1 2    0.2769459142
3 4 2 1    0.1661675485
3 4 2 5    -0.1246256614
3 4 3 4    0.7539467857
3 4 4 3    0.1468727505
3 4 5 2    -0.1523202528
3 5 1 3    -0.07833213358
3 5 2 6    -0.1246256614
3 5 3 1    0.07833213358
3 5 3 5    0.7245722356
3 5 5 3    0.1370812338
3 5 6 2    -0.1523202528
3 6 3 6    0.7539467857
3 6 6 3    0.3035370176
4 1 1 4    0.1174982004
4 1 2 2    0.2769459142
4 1 4 1     0.744155269
4 1 4 5    -0.009791516698
4 1 5 4    -0.08812365028
4 2 2 4    0.3035370176
4 2 4 2    0.7539467857
4 3 1 2    0.1661675485
4 3 2 1    0.2769459142
4 3 2 5    -0.1523202528
4 3 3 4    0.1468727505
4 3 4 3    0.7539467857
4 3 5 2    -0.1246256614
4 4 4 4    0.7160046585
4 5 1 4    -0.08812365028
4 5 2 2    -0.1523202528
4 5 4 1    -0.009791516698
4 5 4 5    0.6682710146
4 5 5 4    0.1395291129
4 6 1 1    0.1174982004
4 6 1 5    -0.08812365028
4 6 2 3    0.3035370176
4 6 3 2    0.1468727505
4 6 4 6    0.7160046585
4 6 5 1    -0.08812365028
4 6 5 5    0.1395291129
4 6 6 4    0.1285136567
5 1 1 1    0.3133285343
5 1 1 5    0.2349964007
5 1 2 3    -0.07833213358
5 1 3 2    -0.07833213358
5 1 4 6    -0.08812365028
5 1 5 1    0.8616534694
5 1 5 5    0.1370812338
5 1 6 4    -0.08812365028
5 2 1 2    0.07833213358
5 2 2 1    -0.07833213358
5 2 2 5    0.1370812338
5 2 3 4    -0.1523202528
5 2 4 3    -0.1246256614
5 2 5 2    0.7245722356
5 3 1 3    0.07833213358
5 3 2 6    -0.1523202528
5 3 3 1    -0.07833213358
5 3 3 5    0.1370812338
5 3 5 3    0.7245722356
5 3 6 2    -0.1246256614
5 4 1 4    -0.009791516698
5 4 2 2    -0.1523202528
5 4 4 1    -0.08812365028
5 4 4 5    0.1395291129
5 4 5 4    0.6682710146
5 5 1 1    0.2349964007
5 5 1 5    0.1370812338
5 5 2 3    0.1370812338
5 5 3 2    0.1370812338
5 5 4 6    0.1395291129
5 5 5 1    0.1370812338
5 5 5 5    0.7490510274
5 5 6 4    0.1395291129
5 6 1 6    -0.009791516698
5 6 3 3    -0.1523202528
5 6 5 6    0.6682710146
5 6 6 1    -0.08812365028
5 6 6 5    0.1395291129
6 1 1 6    0.1174982004
6 1 3 3    0.2769459142
6 1 5 6    -0.08812365028
6 1 6 1     0.744155269
6 1 6 5    -0.009791516698
6 2 1 3    0.1661675485
6 2 2 6    0.1468727505
6 2 3 1    0.2769459142
6 2 3 5    -0.1523202528
6 2 5 3    -0.1246256614
6 2 6 2    0.7539467857
6 3 3 6    0.3035370176
6 3 6 3    0.7539467857
6 4 1 1    0.1174982004
6 4 1 5    -0.08812365028
6 4 2 3    0.1468727505
6 4 3 2    0.3035370176
6 4 4 6    0.1285136567
6 4 5 1    -0.08812365028
6 4 5 5    0.1395291129
6 4 6 4    0.7160046585
6 5 1 6    -0.08812365028
6 5 3 3    -0.1523202528
6 5 5 6    0.1395291129
6 5 6 1    -0.009791516698
6 5 6 5    0.6682710146
6 6 6 6    0.7160046585
!ec







===== Format for electronic delivery of report and programs =====

The preferred format for the report is a PDF file. You can also use DOC or postscript formats or as an ipython notebook file.  As programming language we prefer that you choose between C/C++, Fortran2008 or Python. The following prescription should be followed when preparing the report:

  * Use Devilry to hand in your projects, log in  at  URL:"http://devilry.ifi.uio.no" with your normal UiO username and password and choose either 'fys4480'. There you can load up the files within the deadline.

  * Upload _only_ the report file!  For the source code file(s) you have developed please provide us with your link to your github domain.  The report file should include all of your discussions and a list of the codes you have developed.  Do not include library files which are available at the course homepage, unless you have made specific changes to them.

  * In your git repository, please include a folder which contains selected results. These can be in the form of output from your code for a selected set of runs and input parameters.

  * In this and all later projects, you should include tests (for example unit tests) of your code(s).

  * Comments  from us on your projects, approval or not, corrections to be made  etc can be found under your Devilry domain and are only visible to you and the teachers of the course.



Finally, 
we encourage you to work two and two together. Optimal working groups consist of 
2-3 students. You can then hand in a common report. 











